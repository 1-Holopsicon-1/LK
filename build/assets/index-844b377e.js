var M=Object.defineProperty,U=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var j=(t,e,o)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,m=(t,e)=>{for(var o in e||(e={}))B.call(e,o)&&j(t,o,e[o]);if(R)for(var o of R(e))H.call(e,o)&&j(t,o,e[o]);return t},h=(t,e)=>U(t,W(e));var k=(t,e,o)=>new Promise((l,n)=>{var a=s=>{try{i(o.next(s))}catch(c){n(c)}},u=s=>{try{i(o.throw(s))}catch(c){n(c)}},i=s=>s.done?l(s.value):Promise.resolve(s.value).then(a,u);i((o=o.apply(t,e)).next())});import{p as L,e as A,bF as P,h as Q,l as F,j as r,s as Y,r as v,F as G,ay as J}from"./vendor-60fdf703.js";import{ak as T,al as E,o as K,dQ as V,dR as X,d0 as Z,aQ as ee,s as te,Y as $,ch as oe,W as ie,b1 as ae,bA as re,f as le,dS as se,h as ne,bB as de}from"./index-154347a0.js";const ue=()=>T.get(`?getRequestHighComfort&token=${E()}`),ce=t=>{const e=new FormData;e.set("token",E()),e.set("postRequestHighComfort","1");for(const[o,l]of Object.entries(t))e.set(o,l);return T.post("?postRequestHighComfort=1",e,{headers:{"Content-Type":"multipart/form-data"}})},w={superiorRoom:null,error:null},pe=()=>({data:F(D).superiorRoom,loading:F(x.pending),error:F(D).error}),me=L({name:"postSuperiorRoom",sid:"8fhu4k"}),ve=A(t=>k(void 0,null,function*(){}),{name:"postSuperiorRoomFx",sid:"-fra7ot"});P({from:me,to:ve});const x=A(()=>k(void 0,null,function*(){try{return(yield ue()).data}catch(t){throw new Error("Не удалось загрузить раздел")}}),{name:"getSuperiorRoomFx",sid:"drkyz"}),D=Q(w,{name:"$superiorRoomStore",sid:"-qtf9jq"}).on(x,t=>h(m({},t),{error:null})).on(x.doneData,(t,e)=>h(m({},t),{superiorRoom:e})).on(x.failData,(t,e)=>h(m({},t),{error:e.message})).on(K.userGuid,()=>m({},w)),fe={useSuperiorRoom:pe},he={getSuperiorRoomFx:x},I="Подача заявок открыта с 12:00 4 марта до 12:00 9 марта!",xe=t=>{const e=new Date;return e<new Date(V)?I:e>new Date(X)?"Подача заявок закрыта":""},q=[{id:0,title:"Один в комнате"},{id:1,title:"Двое в комнате"}],_=[{id:1,title:"Двое в комнате"},{id:2,title:"Трое в комнате"}],C=[{id:0,title:"Один в комнате"},{id:1,title:"Двое в комнате"},{id:2,title:"Трое в комнате"}],N=[{id:2,title:"Трое в комнате"}],ge=[{id:"bg",title:"ул. Бориса Галушкина, д. 9"},{id:"m",title:"ул. Михалковская, д. 7, корп. 3"},{id:"ms",title:"ул. Малая Семеновская, д. 12"},{id:"pk",title:"ул. Павла Корчагина, д. 22, к.2"}],be=[{value:!1,title:"Общественная",files:[],maxFiles:10,required:!1,fieldName:"society",checkboxCondition:"straight"},{value:!1,title:"Научная",files:[],maxFiles:10,required:!1,fieldName:"science",checkboxCondition:"straight"},{value:!1,title:"Спортивная",files:[],maxFiles:10,required:!1,fieldName:"sport",checkboxCondition:"straight"},{value:!1,title:"Творческая",files:[],maxFiles:10,required:!1,fieldName:"creativity",checkboxCondition:"straight"}],ye=(t,e)=>{var o,l,n,a,u,i,s;const{fio:c,phone:b,email:g}=t,d=e==null||(o=e.data[3])===null||o===void 0||(o=o.value)===null||o===void 0?void 0:o.id;return{title:"Заявка на комнату повышенной комфортности",data:[{title:"ФИО",value:c,fieldName:"fio",width:"100%",editable:!1},{title:"Телефон",value:(l=e==null||(n=e.data[1])===null||n===void 0?void 0:n.value)!==null&&l!==void 0?l:b,fieldName:"phone",type:"tel",width:"100%",editable:!0,required:!0,mask:!0},{title:"Email",value:(a=e==null||(u=e.data[2])===null||u===void 0?void 0:u.value)!==null&&a!==void 0?a:g,fieldName:"email",type:"email",width:"100%",editable:!0,required:!0},{title:"Адрес общежития",value:(i=e==null||(s=e.data[3])===null||s===void 0?void 0:s.value)!==null&&i!==void 0?i:null,fieldName:"address",type:"select",items:ge,width:"100%",editable:!0,required:!0},{title:"Приоритетный тип размещения",value:null,fieldName:"allocation",type:"select",items:d==="bg"?_:d==="pk"?N:d==="ms"?C:q,width:"100%",editable:!!d,required:!0},{title:"Альтернативный тип размещения",value:null,fieldName:"alternative-allocation",type:"select",items:d==="bg"?_:d==="pk"?N:d==="ms"?C:q,width:"100%",editable:!!d,required:!0},{title:"Участие во внеучебной деятельности",value:null,fieldName:"extracurricular",type:"checkbox-docs",items:be,width:"100%",editable:!0}],alert:r.jsx(r.Fragment,{children:I}),hint:"Перед отправкой заявки обязательно проверьте указанную в форме контактную информацию (мобильный телефон и адрес электронной почты) и при необходимости внесите изменения.",optionalCheckbox:{title:r.jsxs(r.Fragment,{children:["С"," ",r.jsx("a",{href:"https://mospolytech.ru/upload/medialibrary/dcd/aj5km0q67pkjw737j8g5hynmz2dfhlxb/Prikaz-_1564_OD-ot-28.12.2024-Ob-utverzhdenii-razmerov-platy-za-dopolnitelnuyu-uslugu.pdf",target:"_blank",rel:"noreferrer",children:"приказом"})," ","об утверждении размеров платы за дополнительную услугу в студенческом городке от 28.12.2024 N1564-ОД ознакомлен(а)"]}),value:!1,fieldName:"",editable:!0}}},ke=(t,e,o)=>{e(!0);const l=Z(t);try{ce(l),e(!1),o(!0)}catch(n){e(!1),ee.evokePopUpMessage({message:`Не удалось отправить форму. Ошибка: ${n}`,type:"failure",time:3e4})}},Fe=Y.div.withConfig({componentId:"sc-15p7xv6-0"})(["display:flex;justify-content:center;width:100%;height:",";padding:10px;color:var(--text);@media (max-width:1000px){padding:0;}"],({isDone:t})=>t&&"100%"),$e=()=>{var t,e,o,l,n;const[a,u]=v.useState(null),{data:i,error:s}=fe.useSuperiorRoom(),[c,b]=v.useState(0),[g,d]=v.useState(!1),[z,O]=v.useState(!1),f=(t=g||!(i!=null&&i.is_avaliable))!==null&&t!==void 0?t:!1,{data:{user:y}}=te.useUser();if((y==null?void 0:y.educationForm)!=="Очная")return r.jsx($,{text:"Данный раздел недоступен для вашей формы обучения"});const S=xe();return oe&&S?r.jsx($,{text:S}):(v.useEffect(()=>{i&&u(ye(i,a))},[i,c]),v.useEffect(()=>{if(a){var p;b(a==null||(p=a.data[3])===null||p===void 0||(p=p.value)===null||p===void 0?void 0:p.id)}},[a==null||(e=a.data[3])===null||e===void 0?void 0:e.value]),r.jsx(ie,{load:()=>he.getSuperiorRoomFx(),loading:!i,error:s,data:i,children:r.jsx(Fe,{isDone:f,children:!!a&&!!u&&r.jsxs(ae,{children:[r.jsx(re,h(m({},a),{collapsed:f,setData:u})),r.jsx(le,{title:"Информация по заявке",type:"info",icon:r.jsx(G,{}),visible:f,children:r.jsxs("p",{children:["Ваша заявка направлена на рассмотрение жилищной комиссии. С результатами распределения мест и датой заселения можно будет ознакомиться 14 марта в Личном кабинете в разделе"," ",r.jsx(J,{to:se,children:"«Список нуждающихся в общежитии»"}),"."]})}),r.jsx(ne,{text:i!=null&&i.is_avaliable?"Отправить":"Отправлено",action:()=>ke(a,O,d),isLoading:z,completed:g,setCompleted:d,repeatable:!1,buttonSuccessText:"Отправлено",isDone:f,isActive:de(a)&&((o=(l=a.optionalCheckbox)===null||l===void 0?void 0:l.value)!==null&&o!==void 0?o:!0),popUpFailureMessage:f?(n=i==null?void 0:i.error_text)!==null&&n!==void 0?n:"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})})}))};export{$e as default};
