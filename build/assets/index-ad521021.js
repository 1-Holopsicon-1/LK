var T=Object.defineProperty,_=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var C=(e,s,t)=>s in e?T(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,E=(e,s)=>{for(var t in s||(s={}))I.call(s,t)&&C(e,t,s[t]);if(S)for(var t of S(s))L.call(s,t)&&C(e,t,s[t]);return e},k=(e,s)=>_(e,B(s));import{r as c,j as o,F as N}from"./vendor-91dd51cf.js";import{V as W,I as z,M as P,h as U,l as G,S as O,c as R,a2 as V,W as $,_ as q,F as w,ak as H}from"./index-2caaee2c.js";import{s as J}from"./send-form-f3a555de.js";import{g as K}from"./get-method-obstaing-bad4fac3.js";const Q=({model:e,getForm:s,successMessage:t,outerForm:i,isAvailableToSend:n=!0,repeatable:d=!0,formId:F,isSpecialField:j})=>{var g,v;var f;const{data:r,completed:l}=e.selectors.useForm(),[h,p]=c.useState(!1),[a,u]=c.useState(null),[m,D]=c.useState({}),x=(g=l||!n)!=null?g:!1;return c.useEffect(()=>{r&&u(i!=null?i:s(r))},[r]),c.useEffect(()=>{j&&a&&r&&D(K(a.data))},[a]),!a||!u?o.jsx(W,{}):o.jsxs(o.Fragment,{children:[o.jsx(z,k(E({},a),{collapsed:x&&!d,setData:u,specialFieldsNameConfig:m})),o.jsx(P,{title:"Информация по заявке",type:"info",icon:o.jsx(N,{}),visible:x&&!!t,children:t}),(r==null?void 0:r.last_update)&&o.jsxs(U,{size:5,children:["Дата последней отправки: ",G(r.last_update)]}),o.jsx(O,{text:n?"Отправить":"Отправлено",action:()=>J(a,e.effects.postFormFx,p,e.events.changeCompleted,F),isLoading:h,completed:l,setCompleted:M=>e.events.changeCompleted({completed:M}),buttonSuccessText:"Отправлено",repeatable:d,isDone:x&&!d,isActive:R(a,m)&&((v=(f=a.optionalCheckbox)===null||f===void 0?void 0:f.value)!=null?v:!0),popUpFailureMessage:x?"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})},y=({model:e,getForm:s,successMessage:t,goBack:i,pageAvailability:n,isAvailableToSend:d=!0,repeatable:F=!0,formId:j,isSpecialField:f=!1,title:r})=>{var u,m;const{data:l,error:h}=e.selectors.useForm(),[p,a]=c.useState(null);return(u=!!n&&!(n!=null&&n.isAvailable))!=null&&u?o.jsx(V,{text:(m=n==null?void 0:n.text)!=null?m:"Вам не доступен этот раздел"}):(c.useEffect(()=>{l&&a(s(l))},[l]),o.jsx($,{load:()=>e.effects.getFormFx(),error:h,data:p,children:o.jsx(q,{children:!!p&&!!a&&o.jsxs(w,{children:[o.jsx(H,{text:i,visible:!!i}),r&&o.jsx("h2",{children:r}),o.jsx(Q,{model:e,successMessage:t,isAvailableToSend:d,repeatable:F,getForm:s,outerForm:p,formId:j,isSpecialField:f})]})})}))};export{y as T};
