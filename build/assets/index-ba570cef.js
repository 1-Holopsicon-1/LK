import{s as x,r as c,q as b,j as e,E as I,cR as _,cP as M}from"./vendor-93473b96.js";import{l as W,m as Z,n as K,o as Q,p as X,P as A,q as Y,r as w,A as tt,s as et,e as it,t as O,u as nt,v as L,w as st,x as V,h as lt,g as ot}from"./ui-5b290fa7.js";import{J as F,x as D,q as g,H as h,Z as C,r as E,p as G,a1 as dt,l as H,u as J,M as R,h as U,z as at,a2 as rt,_ as ut,P as ct,a3 as pt,a0 as mt,a4 as vt,b as ht}from"./index-7eec75d1.js";const xt=x.div.withConfig({componentId:"sc-1i85cbe-0"})(["margin-top:auto;width:100%;"]),j=[{id:"None",title:"-"},{id:"Basic",title:"Основная"},{id:"Preparatory",title:"Подготовительная"},{id:"SpecialA",title:"Специальная А"},{id:"SpecialB",title:"Специальная Б"},{id:"HealthLimitations",title:"ОВЗ"},{id:"Disabled",title:"Инвалид"}],gt={None:j[0],Basic:j[1],Preparatory:j[2],SpecialA:j[3],SpecialB:j[4],HealthLimitations:j[5],Disabled:j[6]},ft=({studentGuid:t,healthGroup:l})=>{const[o,n]=c.useState(gt[l]),a=b(W.pendingSetHealthGroup),i=()=>{Z.setHealthGroup({studentGuid:t,healthGroup:o.id})};return e.jsxs(F,{gap:"4px",ai:"flex-start",children:[e.jsx(D,{isActive:!a,size:"big",width:"100%",title:"Группа здоровья",items:j,selected:o,setSelected:n}),e.jsx(xt,{children:e.jsx(g,{isActive:!a,text:"Сменить группу здоровья",width:"100%",onClick:i,background:h.blue.main,textColor:h.white.main})})]})},St=x.div.withConfig({componentId:"sc-jh5rb1-0"})(["margin-top:auto;width:100%;"]),p=[{id:"None",title:"-"},{id:"Basketball",title:"Баскетбол"},{id:"Volleyball",title:"Волейбол"},{id:"Aerobics",title:"Аэробика"},{id:"PowerLiftingAndCrossfit",title:"Пауэрлифтинг и кроссфит"},{id:"StreetLiftingAndArmLifting",title:"Стритлифтинг и армлифтинг"},{id:"GeneralPhysicalTraining",title:"ОФП"},{id:"GeneralPhysicalTrainingGym",title:"ОФП (тренажерный зал)"},{id:"FootRoom",title:"Футзал"},{id:"SMG",title:"СМГ"},{id:"TableTennis",title:"СМГ настольный теннис"},{id:"NordicWalking",title:"СМГ скандинавская ходьба"},{id:"InternalTeam",title:"Сборная"}],jt={None:p[0],Basketball:p[1],Volleyball:p[2],Aerobics:p[3],PowerLiftingAndCrossfit:p[4],StreetLiftingAndArmLifting:p[5],GeneralPhysicalTraining:p[6],GeneralPhysicalTrainingGym:p[7],FootRoom:p[8],SMG:p[9],TableTennis:p[10],NordicWalking:p[11],InternalTeam:p[12]},Ct=({studentGuid:t,specialization:l})=>{const[o,n]=c.useState(jt[l]),[a]=b([K.pendingSetSpecialization]),i=()=>{Q.setSpecialization({studentGuid:t,specialization:o.id})};return e.jsxs(F,{gap:"4px",ai:"flex-start",children:[e.jsx(D,{isActive:!a,size:"big",width:"100%",title:"Специализация",items:p,selected:o,setSelected:n}),e.jsx(St,{children:e.jsx(g,{isActive:!a,text:"Сменить специализацию",width:"100%",onClick:i,background:h.blue.main,textColor:h.white.main})})]})},bt=I({and:[C.peTeacher,X.pendingRemoveVisit,(t,l)=>{var o;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Преподаватель",field:"teacherFullName"},...t!=null&&(o=t.permissions)!==null&&o!==void 0&&o.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(n,a)=>{const i=a,s=_(new Date(i.date),new Date)<-7,d=[A.AdminAccess,A.SuperUser].some(r=>{var u;return t==null||(u=t.permissions)===null||u===void 0?void 0:u.includes(r)});return i.teacherGuid===(t==null?void 0:t.id)&&!s||d?e.jsx(g,{width:"100%",text:"Удалить",isActive:!l,onClick:()=>{Y.removeVisit({id:i.id.toString()})}}):null}}]:[]]}],or:{name:"$peStudentVisitsColumns",sid:"bwdu0h"}}),$t=x(E).withConfig({componentId:"sc-1qi5h46-0"})(["flex:1;"]),wt=x.div.withConfig({componentId:"sc-1qi5h46-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),Pt=()=>{var t;const[l,o,n]=b([w.$selectedStudent,bt,C.peTeacher]);return l?e.jsxs(wt,{children:[!!(n!=null&&(t=n.permissions)!==null&&t!==void 0&&t.length)&&e.jsx(tt,{studentGuid:l.studentGuid}),e.jsx($t,{columns:o,data:l.visitsHistory})]}):null};var m=(t=>(t.Activist="Activist",t.Competition="Competition",t.ExternalFitness="ExternalFitness",t.GTO="GTO",t.InternalTeam="InternalTeam",t.OnlineWork="OnlineWork",t.Science="Science",t))(m||{});const z=[{id:m.Activist,title:"Активист"},{id:m.Competition,title:"Соревнование"},{id:m.GTO,title:"ГТО"},{id:m.InternalTeam,title:"Сборная"},{id:m.OnlineWork,title:"Работа в LMS"},{id:m.Science,title:"Научная работа"}],At=x.div.withConfig({componentId:"sc-xw90or-0"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),Tt=()=>{const[t,l]=b([w.$selectedStudent,et.$competitions]),[o,n]=c.useState(null),[a,i]=c.useState(new Date().toISOString()),[s,d]=c.useState(null),[r,u]=c.useState("0"),[$,f]=c.useState(""),T=()=>{var P;O.addAdditionPoints({comment:(s==null?void 0:s.id)===m.Competition?(P=o==null?void 0:o.title)!==null&&P!==void 0?P:"":$,date:H(a,"numeric"),points:Number(r),studentGuid:t==null?void 0:t.studentGuid,type:s==null?void 0:s.id})};c.useEffect(()=>{it.load()},[]),c.useEffect(()=>{(s==null?void 0:s.id)===m.Competition&&r==="0"&&u("5"),(s==null?void 0:s.id)===m.InternalTeam&&r==="0"&&u("50")},[s==null?void 0:s.id]);const y=new Date(a),k=y.getDay()!==0&&y.getDay()!==1,q=l.map(P=>({id:P,title:P}));return e.jsxs(At,{children:[e.jsx(D,{width:"100%",size:"big",title:"Тип работ",items:z,selected:s,setSelected:d}),(s==null?void 0:s.id)===m.Competition&&e.jsx(D,{width:"100%",size:"big",title:"Соревнование",items:q,selected:o,setSelected:n}),e.jsx(G,{alertMessage:k?"":"Не допустимая дата",size:"big",title:"Дата",setValue:i,value:a,type:"date"}),e.jsx(G,{width:"100%",size:"big",title:"Количество баллов",setValue:u,value:r,type:"number",stepSize:1,minValue:1}),(s==null?void 0:s.id)!==m.Competition&&e.jsx(dt,{width:"100%",setValue:f,value:$,title:"Комментарий"}),e.jsx(g,{isActive:k,text:"Добавить",onClick:T,background:h.blue.main,textColor:h.white.main,width:"100%"})]})},yt=I({and:[C.peTeacher,nt.pendingRemoveAdditionPoints,(t,l)=>{var o;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Тип работ",field:"type",render:(n,a)=>{const i=z.find(({id:s})=>s===n);return(i==null?void 0:i.id)===m.Competition?a.comment:i==null?void 0:i.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five",render:(n,a)=>{const i=z.find(({id:s})=>s===a.workType);return(i==null?void 0:i.id)!==m.Competition?a.comment:null}},...t!=null&&(o=t.permissions)!==null&&o!==void 0&&o.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(n,a)=>{const i=a,s=_(new Date(i.date),new Date)<-7,d=[A.AdminAccess,A.SuperUser].some(r=>{var u;return t==null||(u=t.permissions)===null||u===void 0?void 0:u.includes(r)});return i.teacherGuid===(t==null?void 0:t.id)&&!s||d?e.jsx(g,{width:"100%",text:"Удалить",isActive:!l,onClick:()=>O.removeAdditionPoints({id:i.id.toString()})}):null}}]:[]]}],or:{name:"$additionalPointsColumns",sid:"cv7zhj"}}),Gt=x.div.withConfig({componentId:"sc-19i0iom-0"})(["display:flex;flex-direction:column;height:100%;gap:10px;"]),Dt=x(E).withConfig({componentId:"sc-19i0iom-1"})(["flex:1;"]),kt=()=>{var t;const[l,o,n]=b([w.$selectedStudent,yt,C.peTeacher]),{open:a}=J(),i=()=>{a(e.jsx(Tt,{}),"Дополнительные баллы")};return l?e.jsxs(Gt,{children:[!!(n!=null&&(t=n.permissions)!==null&&t!==void 0&&t.length)&&e.jsx(g,{text:"Добавить дополнительные баллы",onClick:i,background:h.blue.main,textColor:h.white.main}),e.jsx(Dt,{columns:o,data:l.pointsHistory})]}):null};var v=(t=>(t.FlexionAndExtensionOfArms="FlexionAndExtensionOfArms",t.JumpingRopeJumps="JumpingRopeJumps",t.Jumps="Jumps",t.PullUps="PullUps",t.ShuttleRun="ShuttleRun",t.Squats="Squats",t.Tilts="Tilts",t.TorsoLifts="TorsoLifts",t.Other="Other",t))(v||{});const B=[{id:v.FlexionAndExtensionOfArms,title:"Сгибание и разгибание рук"},{id:v.JumpingRopeJumps,title:"Прыжки со скакалкой"},{id:v.Jumps,title:"Прыжок в длину"},{id:v.PullUps,title:"Подтягивания(Вис)"},{id:v.ShuttleRun,title:"Челночный бег"},{id:v.Squats,title:"Приседания"},{id:v.Tilts,title:"Наклон"},{id:v.TorsoLifts,title:"Подъемы туловища"},{id:v.Other,title:"Другое"}],zt=x.div.withConfig({componentId:"sc-uipy8z-0"})(["display:flex;flex-direction:column;align-items:center;gap:10px;height:100%;"]),It=()=>{const t=b(w.$selectedStudent),[l,o]=c.useState(new Date().toISOString()),[n,a]=c.useState(null),[i,s]=c.useState("0"),[d,r]=c.useState(""),u=()=>{L.addRegulationPoints({date:H(l,"numeric"),points:Number(i),studentGuid:t==null?void 0:t.studentGuid,type:n==null?void 0:n.id,comment:(n==null?void 0:n.id)===v.Other&&d!=null?d:""})},$=new Date(l),f=$.getDay()!==0&&$.getDay()!==1;return e.jsxs(zt,{children:[e.jsx(D,{width:"100%",size:"big",title:"Тип работ",items:B,selected:n,setSelected:a}),(n==null?void 0:n.id)===v.Other&&e.jsx(G,{width:"100%",size:"big",title:"Комментарий",setValue:r,value:d}),e.jsx(G,{alertMessage:f?"":"Не допустимая дата",size:"big",title:"Дата",setValue:o,value:l,type:"date",width:"100%"}),e.jsx(G,{width:"100%",size:"big",title:"Количество баллов",setValue:s,value:i,type:"number",stepSize:1,minValue:1}),e.jsx(g,{text:"Добавить",isActive:f,onClick:u,background:h.blue.main,textColor:h.white.main,width:"100%"})]})},_t=I({and:[C.peTeacher,st.pendingRemoveRegulationPoints,(t,l)=>{var o;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Норматив",field:"type",render:(n,a)=>{var i;return n===v.Other?a.comment:(i=B.find(({id:s})=>s===n))===null||i===void 0?void 0:i.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five"},...t!=null&&(o=t.permissions)!==null&&o!==void 0&&o.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(n,a)=>{const i=a,s=_(new Date(i.date),new Date)<-30,d=[A.AdminAccess,A.SuperUser].some(r=>{var u;return t==null||(u=t.permissions)===null||u===void 0?void 0:u.includes(r)});return i.teacherGuid===(t==null?void 0:t.id)&&!s||d?e.jsx(g,{width:"100%",text:"Удалить",isActive:!l,onClick:()=>L.removeRegulationPoints({id:i.id.toString()})}):null}}]:[]]}],or:{name:"$regularPointsColumns",sid:"levsbz"}}),Et=x(E).withConfig({componentId:"sc-4mpo2k-0"})(["flex:1;"]),Vt=x.div.withConfig({componentId:"sc-4mpo2k-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),Nt=()=>{var t;const[l,o,n]=b([w.$selectedStudent,_t,C.peTeacher]),{open:a}=J(),i=l==null?void 0:l.totalPoints,s=()=>{a(e.jsx(It,{}),"Добавить норматив")},d=Number(i)<20;return l?e.jsxs(Vt,{children:[!l&&d&&e.jsx(R,{type:"alert",children:"Чтобы добавить норматив, у студента должно быть хотя бы 20 баллов"}),!!(n!=null&&(t=n.permissions)!==null&&t!==void 0&&t.length)&&e.jsx(g,{text:"Добавить норматив",onClick:s,background:h.blue.main,textColor:h.white.main,isActive:!d}),e.jsx(Et,{data:l.standardsHistory,columns:o})]}):null},N=[{title:"Посещения",content:e.jsx(Pt,{})},{title:"Нормативы ",content:e.jsx(Nt,{})},{title:"Дополнительные баллы ",content:e.jsx(kt,{})}],S=({label:t,value:l})=>e.jsxs(Ot,{children:[e.jsx(U,{size:3,children:t}),e.jsx(Lt,{children:l})]}),Ot=x.div.withConfig({componentId:"sc-bzc523-0"})(["display:flex;flex-direction:column;align-items:center;row-gap:4px;border-radius:4px;padding:12px;background-color:var(--theme-2);flex:1;"]),Lt=x.span.withConfig({componentId:"sc-bzc523-1"})([""]),Rt=()=>{var t,l,o,n,a,i;const{studentId:s}=M(),[d,{currentUser:r},u,$,f]=b([w.$selectedStudent,ht.user,C.isLoading,w.$loading,C.peTeacher]),T=(r==null?void 0:r.user_status)==="staff"?s:(t=r==null?void 0:r.guid)!==null&&t!==void 0?t:"",[y,k]=c.useState(0);return c.useEffect(()=>(V.setCurrentStudentId(T),at.load(),()=>V.resetStudentId()),[T]),!d&&T&&!u&&!$?e.jsx(rt,{text:"Нет данных"}):d?e.jsx(ut,{padding:"10px",children:e.jsxs(ct,{children:[(r==null?void 0:r.user_status)==="stud"&&e.jsxs(R,{type:"info",children:[e.jsx("p",{children:"Баллы, выставленные за посещаемость занятий по физической культуре в течение семестра, находятся у преподавателей кафедры «Физическое воспитание»."}),e.jsx("p",{children:"В случае возникновения вопросов можно обратиться к ведущему преподавателю."})]}),e.jsx(U,{size:3,align:"left",children:d.fullName}),e.jsxs(pt,{children:[e.jsx(S,{label:"Группа",value:d.groupNumber}),e.jsx(S,{label:"Баллы",value:d.totalPoints.toString()}),e.jsx(S,{label:"Курс",value:d.course.toString()}),e.jsx(S,{label:"ЛМС",value:d.lmsPoints.toString()}),e.jsx(S,{label:"Куратор",value:(l=(o=d.curator)===null||o===void 0?void 0:o.fullName)!==null&&l!==void 0?l:"-"}),e.jsx(S,{label:"Группа здоровья",value:d.healthGroup==="None"?"-":`${lt[d.healthGroup]} (${(n=(a=d.healthGroupTeacher)===null||a===void 0?void 0:a.fullName)!==null&&n!==void 0?n:""})`}),e.jsx(S,{label:"Специализация",value:ot[d.specialization]}),e.jsx(S,{label:"Долг",value:d.hasDebt?"Есть":"Нет"})]}),!!(f!=null&&(i=f.permissions)!==null&&i!==void 0&&i.length)&&e.jsxs(e.Fragment,{children:[e.jsx(Ct,{studentGuid:d.studentGuid,specialization:d.specialization}),e.jsx(ft,{studentGuid:d.studentGuid,healthGroup:d.healthGroup})]}),e.jsx(mt,{appearance:!1,pages:N,currentPage:y,setCurrentPage:k}),e.jsx(vt,{children:N[y].content})]})}):null};export{Rt as default};
