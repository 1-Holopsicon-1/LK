import{r as n,j as s,F as k}from"./vendor-8312535b.js";import{V as D,I as M,M as T,h as B,l as I,S as L,c as N,a2 as W,W as _,_ as z,F as P,ak as U}from"./index-3ed27df5.js";import{s as G}from"./send-form-67a97344.js";import{g as O}from"./get-method-obstaing-c0726de9.js";const R=({model:r,getForm:d,successMessage:p,outerForm:c,isAvailableToSend:t=!0,repeatable:f=!0,formId:F,isSpecialField:j})=>{var S,C,E;const{data:o,completed:u}=r.selectors.useForm(),[x,h]=n.useState(!1),[e,a]=n.useState(null),[m,i]=n.useState({}),l=(S=u||!t)!=null?S:!1;return n.useEffect(()=>{o&&a(c!=null?c:d(o))},[o]),n.useEffect(()=>{j&&e&&o&&i(O(e.data))},[e]),!e||!a?s.jsx(D,{}):s.jsxs(s.Fragment,{children:[s.jsx(M,{...e,collapsed:l&&!f,setData:a,specialFieldsNameConfig:m}),s.jsx(T,{title:"Информация по заявке",type:"info",icon:s.jsx(k,{}),visible:l&&!!p,children:p}),(o==null?void 0:o.last_update)&&s.jsxs(B,{size:5,children:["Дата последней отправки: ",I(o.last_update)]}),s.jsx(L,{text:t?"Отправить":"Отправлено",action:()=>G(e,r.effects.postFormFx,h,r.events.changeCompleted,F),isLoading:x,completed:u,setCompleted:g=>r.events.changeCompleted({completed:g}),buttonSuccessText:"Отправлено",repeatable:f,isDone:l&&!f,isActive:N(e,m)&&((E=(C=e.optionalCheckbox)==null?void 0:C.value)!=null?E:!0),popUpFailureMessage:l?"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})},J=({model:r,getForm:d,successMessage:p,goBack:c,pageAvailability:t,isAvailableToSend:f=!0,repeatable:F=!0,formId:j,isSpecialField:o=!1,title:u})=>{var m,i;const{data:x,error:h}=r.selectors.useForm(),[e,a]=n.useState(null);return(m=!!t&&!(t!=null&&t.isAvailable))!=null&&m?s.jsx(W,{text:(i=t==null?void 0:t.text)!=null?i:"Вам не доступен этот раздел"}):(n.useEffect(()=>{x&&a(d(x))},[x]),s.jsx(_,{load:()=>r.effects.getFormFx(),error:h,data:e,children:s.jsx(z,{children:!!e&&!!a&&s.jsxs(P,{children:[s.jsx(U,{text:c,visible:!!c}),u&&s.jsx("h2",{children:u}),s.jsx(R,{model:r,successMessage:p,isAvailableToSend:f,repeatable:F,getForm:d,outerForm:e,formId:j,isSpecialField:o})]})})}))};export{J as T};
