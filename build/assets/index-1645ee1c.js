import{s as V,j as t,r as u}from"./vendor-1714f5a3.js";import{$,m as W,t as F,B as _,T as j,u as b,v as k,K as m,w as z,l as c,x as C,W as D,r as T,L as h,g as B,y as L}from"./index-a5eecfde.js";import{B as M}from"./index-06cfa6e7.js";import{g as N}from"./get-short-string-60b0c4d4.js";import{g as p}from"./get-correct-word-form-c0a854e8.js";const A=async()=>(await $.get(`?getVacations&token=${W()}`)).data,g=F({api:{get:A},errorMessage:()=>"Возникла ошибка с получением графика отпусков!"}),E=V(_)`
    border-radius: var(--brLight);
    background: var(--form);
    position: relative;

    .background {
        font-size: 6em;
        position: absolute;
        bottom: 0px;
        right: 10px;
        font-weight: bold;
        /* transform: rotate(-35deg); */
        opacity: 0.5;
    }
    .content {
        height: 100%;
        display: flex;
        align-items: flex-end;
    }
`,f=({children:n,title:r,text:i,width:s,height:a,background:e,padding:o})=>t.jsxs(E,{alignItems:"flex-start",gap:"10px",orientation:"vertical",width:s??"15vw",minHeight:a??"150px",maxHeight:a??"150px",padding:o,children:[t.jsx(j,{size:4,align:"left",children:r}),t.jsx(b,{visible:!!i,fontSize:"0.9em",children:N(i??"",60)}),e&&t.jsx("div",{className:"background",children:e}),n&&t.jsx("div",{className:"content",children:n})]}),x={fiveToNine:"дней",one:"день",twoToFour:"дня",zero:"дней"},I=[{title:"Плановые периоды отпуска",field:"plannedVacationPeriods",showFull:!0},{title:"Фактические периоды отпуска",field:"actualVacationPeriods",showFull:!0}],U=n=>{const{division:r,post:i,vacations:s,allActualVacationPeriods:a,allPlannedVacationPeriods:e}=H(n);return t.jsxs(t.Fragment,{children:[t.jsxs(k,{children:[t.jsx(m,{keyStr:"Подразделение",value:r}),t.jsx(m,{keyStr:"Должность",value:i})]}),t.jsx(z,{columns:I,data:s,footer:()=>({allPlannedVacationPeriods:v(e),allActualVacationPeriods:v(a)})})]})};function v(n){return`Всего: ${n} ${p(n??0,x)}`}function H(n){const{fact:r,plan:i,division:s,post:a}=n;return{division:s,post:a,vacations:K(r,i),allActualVacationPeriods:r.reduce((e,{numdays:o})=>(e+=+o,e),0),allPlannedVacationPeriods:i.reduce((e,{numdays:o})=>(e+=+o,e),0)}}function K(n,r){const i=Math.max(n.length,r.length),s=[];for(let a=0;a<i;a++){const e=n[a],o=r[a],l={actualVacationPeriods:"",plannedVacationPeriods:""},d=c(e==null?void 0:e.from,"numeric"),P=c(e==null?void 0:e.to,"numeric"),w=c(o==null?void 0:o.from,"numeric"),S=c(o==null?void 0:o.to,"numeric");e&&(l.actualVacationPeriods=`${d} - ${P} (${e.numdays} ${p(Number(e.numdays)||0,x)})`),o&&(l.plannedVacationPeriods=`${w} - ${S} (${o.numdays} ${p(Number(o.numdays)||0,x)})`),s.push(l)}return s}const y={fiveWorkDays:"https://e.mospolytech.ru/old/storage/files/Proizvodstvennyj_kalendar_2023_pyatidnevnya_rabochaya_nedelya.pdf",sixWorkDays:"https://e.mospolytech.ru/old/storage/files/Proizvodstvennyj_kalendar_2023_shestidnevnaya_rabochaya_nedelya.pdf"},R=()=>{const{data:{user:n}}=C.useUser(),{data:r,error:i}=g.selectors.useData(),s=u.useMemo(()=>(r==null?void 0:r.map((l,d)=>({id:d,title:l.division})))||[],[r]),[a,e]=u.useState(s[0]??{});u.useEffect(()=>{a!=null&&a.id||e(s[0])},[a==null?void 0:a.id,e,s]);const o=r==null?void 0:r[Number((a==null?void 0:a.id)||0)];return t.jsx(D,{load:g.effects.getFx,error:i,data:r,children:t.jsx(T,{alignItems:"flex-start",children:t.jsxs(M,{orientation:"vertical",height:"fit-content",gap:"1rem",maxWidth:"700px",noAppearanceInMobile:!0,children:[t.jsx(b,{width:"100%",maxWidth:"100%",children:"Производственный календарь на 2023 год"}),t.jsxs(k,{scroll:!1,direction:"horizontal",gap:12,wrapOnMobile:!0,children:[t.jsx(f,{title:"Для пятидневной рабочей недели",height:"120px",width:"50%",background:"5",padding:"20px 40px 20px 20px",children:t.jsx(h,{onClick:()=>null,href:y.fiveWorkDays,textColor:"var(--reallyBlue)",text:"Подробнее",background:"transparent",padding:"10px 0"})}),t.jsx(f,{title:"Для шестидневной рабочей недели",height:"120px",width:"50%",background:"6",padding:"20px 40px 20px 20px",children:t.jsx(h,{onClick:()=>null,href:y.sixWorkDays,textColor:"var(--reallyBlue)",text:"Подробнее",background:"transparent",padding:"10px 0"})})]}),t.jsx(B,{}),t.jsx(j,{size:3,align:"left",children:"Сведения о трудоустройстве"}),!!(n!=null&&n.id)&&t.jsx(L,{width:"fit-content",items:s,selected:a,setSelected:e}),o&&t.jsx(U,{...o})]})})})},X=()=>t.jsx(R,{});export{X as default};
