import{s as x,K as D,cO as I,j as e,q as v,r as m,cM as y}from"./vendor-9c916fad.js";import{j as _,P as j,k as U,l as g,A as W,m as B,n as F,s as H,e as K,o as J,p as Z,q as V}from"./ui-28b283f9.js";import{r as E,Z as S,q as C,x as w,p as P,a1 as Q,L as f,l as T,u as q,M as X,h as L,z as Y,a2 as tt,_ as et,P as it,a3 as st,a0 as nt,a4 as ot,b as lt}from"./index-1e5d3121.js";const dt=x(E).withConfig({componentId:"sc-1qi5h46-0"})(["flex:1;"]),at=x.div.withConfig({componentId:"sc-1qi5h46-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),rt=D({and:[S.peTeacher,_.pendingRemoveVisit,(t,l)=>{var n;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Преподаватель",field:"teacherFullName"},...(n=t==null?void 0:t.permissions)!=null&&n.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(o,d)=>{const s=d,i=I(new Date(s.date),new Date)<-7,a=[j.AdminAccess,j.SuperUser].some(p=>{var u;return(u=t==null?void 0:t.permissions)==null?void 0:u.includes(p)});return s.teacherGuid===(t==null?void 0:t.id)&&!i||a?e.jsx(C,{width:"100%",text:"Удалить",isActive:!l,onClick:()=>{U.removeVisit({id:s.id.toString()})}}):null}}]:[]]}],or:{name:"$peStudentVisitsColumns",sid:"bwdu0h"}}),ut=()=>{var o;const[t,l,n]=v([g.$selectedStudent,rt,S.peTeacher]);return t?e.jsxs(at,{children:[!!((o=n==null?void 0:n.permissions)!=null&&o.length)&&e.jsx(W,{studentGuid:t.studentGuid}),e.jsx(dt,{columns:l,data:t.visitsHistory})]}):null};var r=(t=>(t.Activist="Activist",t.Competition="Competition",t.ExternalFitness="ExternalFitness",t.GTO="GTO",t.InternalTeam="InternalTeam",t.OnlineWork="OnlineWork",t.Science="Science",t))(r||{});const $=[{id:r.Activist,title:"Активист"},{id:r.ExternalFitness,title:"Внешний фитнес"},{id:r.Competition,title:"Соревнование"},{id:r.GTO,title:"ГТО"},{id:r.InternalTeam,title:"Сборная"},{id:r.OnlineWork,title:"Работа в LMS"},{id:r.Science,title:"Научная работа"}],ct=D({and:[S.peTeacher,B.pendingRemoveAdditionPoints,(t,l)=>{var n;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Тип работ",field:"type",render:(o,d)=>{const s=$.find(({id:i})=>i===o);return(s==null?void 0:s.id)===r.Competition?d.comment:s==null?void 0:s.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five",render:(o,d)=>{const s=$.find(({id:i})=>i===d.workType);return(s==null?void 0:s.id)!==r.Competition?d.comment:null}},...(n=t==null?void 0:t.permissions)!=null&&n.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(o,d)=>{const s=d,i=I(new Date(s.date),new Date)<-7,a=[j.AdminAccess,j.SuperUser].some(p=>{var u;return(u=t==null?void 0:t.permissions)==null?void 0:u.includes(p)});return s.teacherGuid===(t==null?void 0:t.id)&&!i||a?e.jsx(C,{width:"100%",text:"Удалить",isActive:!l,onClick:()=>F.removeAdditionPoints({id:s.id.toString()})}):null}}]:[]]}],or:{name:"$additionalPointsColumns",sid:"cv7zhj"}}),mt=x.div.withConfig({componentId:"sc-xw90or-0"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),pt=()=>{const[t,l]=v([g.$selectedStudent,H.$competitions]),[n,o]=m.useState(null),[d,s]=m.useState(new Date().toISOString()),[i,a]=m.useState(null),[p,u]=m.useState("0"),[h,A]=m.useState(""),M=()=>{F.addAdditionPoints({comment:(i==null?void 0:i.id)===r.Competition?(n==null?void 0:n.title)??"":h,date:T(d,"numeric"),points:Number(p),studentGuid:t==null?void 0:t.studentGuid,type:i==null?void 0:i.id})};m.useEffect(()=>{K.load()},[]),m.useEffect(()=>{(i==null?void 0:i.id)===r.Competition&&p==="0"&&u("5"),(i==null?void 0:i.id)===r.InternalTeam&&p==="0"&&u("50")},[i==null?void 0:i.id]);const z=new Date(d),k=z.getDay()!==0&&z.getDay()!==1,R=l.map(O=>({id:O,title:O}));return e.jsxs(mt,{children:[e.jsx(w,{width:"100%",size:"big",title:"Тип работ",items:$,selected:i,setSelected:a}),(i==null?void 0:i.id)===r.Competition&&e.jsx(w,{width:"100%",size:"big",title:"Соревнование",items:R,selected:n,setSelected:o}),e.jsx(P,{alertMessage:k?"":"Не допустимая дата",size:"big",title:"Дата",setValue:s,value:d,type:"date"}),e.jsx(P,{width:"100%",size:"big",title:"Количество баллов",setValue:u,value:p,type:"number",stepSize:1,minValue:1}),(i==null?void 0:i.id)!==r.Competition&&e.jsx(Q,{width:"100%",setValue:A,value:h,title:"Комментарий"}),e.jsx(C,{isActive:k,text:"Добавить",onClick:M,background:f.blue.main,textColor:f.white.main,width:"100%"})]})},xt=x.div.withConfig({componentId:"sc-19i0iom-0"})(["display:flex;flex-direction:column;height:100%;gap:10px;"]),ft=x(E).withConfig({componentId:"sc-19i0iom-1"})(["flex:1;"]),gt=()=>{var s;const[t,l,n]=v([g.$selectedStudent,ct,S.peTeacher]),{open:o}=q(),d=()=>{o(e.jsx(pt,{}),"Дополнительные баллы")};return t?e.jsxs(xt,{children:[!!((s=n==null?void 0:n.permissions)!=null&&s.length)&&e.jsx(C,{text:"Добавить дополнительные баллы",onClick:d,background:f.blue.main,textColor:f.white.main}),e.jsx(ft,{columns:l,data:t.pointsHistory})]}):null};var c=(t=>(t.FlexionAndExtensionOfArms="FlexionAndExtensionOfArms",t.JumpingRopeJumps="JumpingRopeJumps",t.Jumps="Jumps",t.PullUps="PullUps",t.ShuttleRun="ShuttleRun",t.Squats="Squats",t.Tilts="Tilts",t.TorsoLifts="TorsoLifts",t.Other="Other",t))(c||{});const N=[{id:c.FlexionAndExtensionOfArms,title:"Сгибание и разгибание рук"},{id:c.JumpingRopeJumps,title:"Прыжки со скакалкой"},{id:c.Jumps,title:"Прыжок в длину"},{id:c.PullUps,title:"Подтягивания(Вис)"},{id:c.ShuttleRun,title:"Челночный бег"},{id:c.Squats,title:"Приседания"},{id:c.Tilts,title:"Наклон"},{id:c.TorsoLifts,title:"Подъемы туловища"},{id:c.Other,title:"Другое"}],St=x.div.withConfig({componentId:"sc-uipy8z-0"})(["display:flex;flex-direction:column;align-items:center;gap:10px;height:100%;"]),Ct=()=>{const t=v(g.$selectedStudent),[l,n]=m.useState(new Date().toISOString()),[o,d]=m.useState(null),[s,i]=m.useState("0"),[a,p]=m.useState(""),u=()=>{J.addRegulationPoints({date:T(l,"numeric"),points:Number(s),studentGuid:t==null?void 0:t.studentGuid,type:o==null?void 0:o.id,comment:(o==null?void 0:o.id)===c.Other?a??"":""})},h=new Date(l),A=h.getDay()!==0&&h.getDay()!==1;return e.jsxs(St,{children:[e.jsx(w,{width:"100%",size:"big",title:"Тип работ",items:N,selected:o,setSelected:d}),(o==null?void 0:o.id)===c.Other&&e.jsx(P,{width:"100%",size:"big",title:"Комментарий",setValue:p,value:a}),e.jsx(P,{alertMessage:A?"":"Не допустимая дата",size:"big",title:"Дата",setValue:n,value:l,type:"date",width:"100%"}),e.jsx(P,{width:"100%",size:"big",title:"Количество баллов",setValue:i,value:s,type:"number",stepSize:1,minValue:1}),e.jsx(C,{text:"Добавить",isActive:A,onClick:u,background:f.blue.main,textColor:f.white.main,width:"100%"})]})},jt=x(E).withConfig({componentId:"sc-4mpo2k-0"})(["flex:1;"]),vt=x.div.withConfig({componentId:"sc-4mpo2k-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),ht=D({and:[S.peTeacher,Z.pendingRemoveRegulationPoints,(t,l)=>{var n;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Норматив",field:"type",render:(o,d)=>{var s;return o===c.Other?d.comment:(s=N.find(({id:i})=>i===o))==null?void 0:s.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five"},...(n=t==null?void 0:t.permissions)!=null&&n.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(o,d)=>{const s=d,i=I(new Date(s.date),new Date)<-30,a=[j.AdminAccess,j.SuperUser].some(p=>{var u;return(u=t==null?void 0:t.permissions)==null?void 0:u.includes(p)});return s.teacherGuid===(t==null?void 0:t.id)&&!i||a?e.jsx(C,{width:"100%",text:"Удалить",isActive:!l,onClick:()=>J.removeRegulationPoints({id:s.id.toString()})}):null}}]:[]]}],or:{name:"$regularPointsColumns",sid:"levsbz"}}),Pt=()=>{var a;const[t,l,n]=v([g.$selectedStudent,ht,S.peTeacher]),{open:o}=q(),d=t==null?void 0:t.totalPoints,s=()=>{o(e.jsx(Ct,{}),"Добавить норматив")},i=Number(d)<20;return t?e.jsxs(vt,{children:[!t&&i&&e.jsx(X,{type:"alert",children:"Чтобы добавить норматив, у студента должно быть хотя бы 20 баллов"}),!!((a=n==null?void 0:n.permissions)!=null&&a.length)&&e.jsx(C,{text:"Добавить норматив",onClick:s,background:f.blue.main,textColor:f.white.main,isActive:!i}),e.jsx(jt,{data:t.standardsHistory,columns:l})]}):null},G=[{title:"Посещения",content:e.jsx(ut,{})},{title:"Нормативы ",content:e.jsx(Pt,{})},{title:"Дополнительные баллы ",content:e.jsx(gt,{})}],b=({label:t,value:l})=>e.jsxs(At,{children:[e.jsx(L,{size:3,children:t}),e.jsx(bt,{children:l})]}),At=x.div.withConfig({componentId:"sc-bzc523-0"})(["display:flex;flex-direction:column;align-items:center;row-gap:4px;border-radius:4px;padding:12px;background-color:var(--theme-2);flex:1;"]),bt=x.span.withConfig({componentId:"sc-bzc523-1"})([""]),It=()=>{const{studentId:t}=y(),[l,{currentUser:n},o,d]=v([g.$selectedStudent,lt.user,S.isLoading,g.$loading]),s=(n==null?void 0:n.user_status)==="staff"?t:(n==null?void 0:n.guid)??"",[i,a]=m.useState(0);return m.useEffect(()=>(V.setCurrentStudentId(s),Y.load(),()=>V.resetStudentId()),[s]),!l&&s&&!o&&!d?e.jsx(tt,{text:"Нет данных"}):l?e.jsx(et,{padding:"10px",children:e.jsxs(it,{children:[e.jsx(L,{size:3,align:"left",children:l.fullName}),e.jsxs(st,{children:[e.jsx(b,{label:"Группа",value:l.groupNumber}),e.jsx(b,{label:"Баллы",value:l.totalPoints.toString()}),e.jsx(b,{label:"Курс",value:l.course.toString()}),e.jsx(b,{label:"ЛМС",value:l.lmsPoints.toString()})]}),e.jsx(nt,{appearance:!1,pages:G,currentPage:i,setCurrentPage:a}),e.jsx(ot,{children:G[i].content})]})}):null};export{It as default};
