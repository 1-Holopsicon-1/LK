import{u as d,y as f,x as r,p as v,n as p,r as u,M as E,j as i}from"./vendor-52b5ac7c.js";import{an as g,ao as y,ap as h,aq as F,ah as T,ar as b,F as A,I as B,S,d as w,N as W,as as j}from"./index-d0879ffc.js";import{S as D}from"./send-hr-form-holiday-work-d0ec3eda.js";const $=d(),I=d(),k=f(async()=>{const{data:e}=await y.get(`InternalPartTime.GetAllHistory?PersonalGuid=${h(F()??"").IndividualGuid}`);return e.orders});r({clock:$,target:k});const n=f(async e=>(await y.post("Weekend.AddWeekend",e)).data);r({clock:I,target:n});const x=v([]),N=n.pending;r({clock:k.doneData,target:x});r({clock:n.doneData,fn:e=>{const t=e;return t.isError?{message:t.error,type:"hrFailure",time:3e5}:{message:"Форма отправлена успешно",type:"success",time:0}},target:g.evokePopUpMessage});r({clock:n.fail,fn:()=>({message:"Не удалось отправить форму.",type:"hrFailure",time:3e5}),target:g.evokePopUpMessage});const q={useBufferPartTimeEmployment:()=>({data:p(x),loading:p(N)})},H=(e,t)=>{const{surname:a,name:s,patronymic:o}=e;return{title:"Заявление на трудоустройство по совместительству",data:[{title:"ФИО",value:a+" "+s+" "+o,fieldName:"fio",type:"simple-text",visible:!0},{title:"Подразделениe, куда производится трудорустройство",type:"auto-complete-input",fieldName:"newPlaceOfWork",value:"",width:"100%",suggestions:t,required:!0,mask:!0,visible:!0,placeholder:"Начните вводить название подразделения"},{title:"Должность",value:null,fieldName:"post",mask:!0,editable:!0,required:!0},{title:"Ставка",type:"select",fieldName:"rate",value:null,editable:!0,required:!0,width:"100%",items:[{id:0,title:"1"},{id:1,title:"0.5"},{id:2,title:"0.25"}]}]}},L=()=>{var c;const[e,t]=u.useState(null),{data:{dataUserApplication:a}}=T.useApplications(),{loading:s}=q.useBufferPartTimeEmployment(),[o,m]=u.useState(!1),l=o??!1,P=E(j);return u.useEffect(()=>{a&&!s&&t(H(a,P))},[a,s]),i.jsx(b,{isDone:l,children:!!e&&!!t&&i.jsxs(A,{children:[i.jsx(B,{...e,collapsed:l,setData:t}),i.jsx(S,{text:"Отправить",action:()=>D(w.HOLIDAY_WORK,[e],m),isLoading:s,completed:o,setCompleted:m,repeatable:!1,buttonSuccessText:"Отправлено",isDone:l,isActive:W(e)&&(((c=e.optionalCheckbox)==null?void 0:c.value)??!0)})]})})};export{L as default};
