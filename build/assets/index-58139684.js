import{p as W,e as B,S as X,h as Y,f as q,j as a,s as Z,r as s,a0 as ee}from"./vendor-08ab745b.js";import{$ as G,g as J,b as te,f as A,d as ae,W as ie,F as re,h as le,M as se,l as oe,I as c,i as ne,S as de}from"./index-0892b83f.js";const ue=()=>G.get(`?getCheckData&token=${J()}`),ce=e=>{const t=new FormData;t.set("token",J()),t.set("saveCheckData","1");for(const[i,o]of Object.entries(e))t.set(i,o);return G.post("?saveCheckData=1",t,{headers:{"Content-Type":"multipart/form-data"}})},R={teacherDataVerification:null,error:null,completed:!1},fe=()=>({data:q(F).teacherDataVerification,loading:q(h.pending),error:q(F).error,completed:q(F).completed}),H=W({name:"postTeacherDataVerification",sid:"-jc1rtz"}),K=W({name:"changeCompleted",sid:"6vr460"}),me=B(async e=>{try{return(await ce(e)).data}catch{throw new Error("Не удалось загрузить раздел")}},{name:"postTeacherDataVerificationFx",sid:"b8s0pe"});X({from:H,to:me});const h=B(async()=>{try{return(await ue()).data}catch{throw new Error("Не удалось войти")}},{name:"getTeacherDataVerificationFx",sid:"6736yk"}),F=Y(R,{name:"$teacherDataVerificationStore",sid:"-t2u8dj"}).on(h,e=>({...e,error:null})).on(h.doneData,(e,t)=>({...e,teacherDataVerification:t})).on(h.failData,(e,t)=>({...e,error:t.message})).on(K,(e,t)=>({...e,completed:t.completed})).on(te.userGuid,()=>({...R})),pe={useTeacherDataVerification:fe},ve={getTeacherDataVerificationFx:h},C={postTeacherDataVerification:H,changeCompleted:K},he=e=>{let t,i,o,m,u;u=Math.floor(e/1e3),m=Math.floor(u/60),u=u%60,o=Math.floor(m/60),m=m%60,i=Math.floor(o/24),o=o%24,t=Math.floor(i/30),i=i%30;const r=Math.floor(t/12);return t=t%12,{year:r,month:t,day:i,hour:o,minute:m,second:u}},ge=(e,t)=>{const i=e.sex==="Мужской",o=he(new Date().getTime()-new Date(e.bdate).getTime()).year;return{title:"Воинская служба",hint:a.jsxs(a.Fragment,{children:["При наличии документа о воинской службе необходимо загрузить скан-копию всех заполненных страниц документа воинского учета (военного билета или удостоверения гражданина, подлежащего призыву).",a.jsx("br",{}),a.jsx("br",{}),"Для иностранных работников - скан-копию страницы паспорта иностранного гражданина с серией и номером."]}),data:[],documents:{files:[],required:!0,checkboxCondition:"reverse",fieldName:"armyFiles",maxFiles:10},optionalCheckbox:{fieldName:"army_doc_none",title:"Документ о воинской службе отсутствует",value:o>=66?!0:!i&&e?.army_doc_none,required:!0,visible:!i||o>=66},confirmed:t}},xe=(e,t)=>({title:"Контактные данные",hint:"Личный мобильный телефон предоставляется только сотрудникам отдела кадров. Обязателен для заполнения. Рабочий мобильный телефон может быть предоставлен сотрудникам вуза для решения рабочих вопросов. Если рабочий мобильный телефон совпадает с личным - продублировать информацию в соответствующем поле. Служебный телефон (прямой/дополнительный) может быть опубликован в телефонном справочнике вуза. Личный E-mail предоставляется только сотрудникам отдела кадров. Обязателен для заполнения. Рабочий E-mail - это E-mail в домене mospolytech.ru.",data:[{fieldName:"tel_mob_private",title:"Мобильный телефон (личный)",type:"tel",value:e?.tel_mob_private??"",required:!0,mask:!0,autocomplete:!1},{fieldName:"tel_mob_staff",title:"Мобильный телефон (рабочий)",type:"tel",value:e?.tel_mob_staff??"",mask:!0,autocomplete:!1},{fieldName:"tel_staff",title:"Служебный телефон (прямой/дополнительный)",type:"tel",value:e?.tel_staff??"",autocomplete:!1},{fieldName:"email_private",title:"Личный e-mail",type:"email",value:e?.email_private??"",required:!0,autocomplete:!1},{fieldName:"email_staff",title:"Рабочий e-mail",type:"email",value:e?.email_staff??"",autocomplete:!1}],confirmed:t}),_e=(e,t)=>({title:"Инвалидность",hint:"Необходимо приложить скан-копию справки об инвалидности",data:[],optionalCheckbox:{fieldName:"is_not_invalid",value:e?.is_not_invalid,title:"Нет документа об инвалидности",required:!0},documents:{files:[],required:!0,checkboxCondition:"reverse",fieldName:"invalidFiles",maxFiles:1},confirmed:t}),ye=(e,t)=>({title:"Водительское удостоверение",hint:"При наличии водительского удостоверения необходимо загрузить скан-копию документа с обеих сторон",data:[],optionalCheckbox:{fieldName:"dr_lic_none",title:"Водительское удостоверение отсутствует",value:e.dr_lic_none,required:!0},documents:{files:[],required:!0,fieldName:"driveLicenseFiles",maxFiles:2},confirmed:t}),Ne=(e,t)=>({title:"Образование",hint:"Необходимо приложить скан-копию документа об образовании (диплом, аттестат), подтверждающего изменения",data:[{fieldName:"edu_doc",title:"Вид документа",value:e?.edu_doc,width:"100%"},{fieldName:"edu_level",title:"Уровень образования",value:e.edu_level,width:"100%"},{fieldName:"edu_org",title:"Учебное заведение",value:e?.edu_org??"",required:!0},{fieldName:"edu_spec",title:"Квалификация",value:e?.edu_spec??"",required:!0},{fieldName:"edu_doc_num",title:"Серия и номер",value:e?.edu_doc_num??"",required:!0},{fieldName:"edu_year",title:"Дата выдачи",value:e?.edu_year??"",type:"date",required:!1}],documents:{files:[],required:!0,fieldName:"educationFiles",maxFiles:5},confirmed:t}),S=[{id:"mother",title:"Мать"},{id:"father",title:"Отец"},{id:"wife",title:"Жена"},{id:"husband",title:"Муж"},{id:"sister",title:"Сестра"},{id:"brother",title:"Брат"},{id:"son",title:"Сын"},{id:"daughter",title:"Дочь"}],be=(e,t)=>({title:"Состав семьи",hint:"Необходимо указать актуальную информацию о ближайших родственниках",data:[...e.family?.map(i=>[{fieldName:"relation",title:"Степень родства",value:A(S,i.relation),type:"select",items:S,width:"100%"},{fieldName:"fio",title:"ФИО",value:i.fio,required:!0,width:"40%"},{fieldName:"bdate",title:"Дата рождения",value:i.bdate,type:"date",required:!0,width:"30%"}])??[]],default:[[{fieldName:"relation",title:"Степень родства",value:null,type:"select",items:S,width:"100%"},{fieldName:"fio",title:"ФИО",value:"",required:!0,width:"40%"},{fieldName:"bdate",title:"Дата рождения",value:"",type:"date",required:!0,width:"30%"}]],addNew:!0,optionalCheckbox:{fieldName:"family_none",title:"Близкие родственники отсутствуют",value:e.family_none,required:!0},confirmed:t}),U=e=>{switch(e){case"Мужской":return[{id:"single",title:"Холост"},{id:"married",title:"Женат"},{id:"divorced",title:"Разведен"},{id:"widow",title:"Вдовец"}];case"Женский":return[{id:"single",title:"Не замужем"},{id:"married",title:"Замужем"},{id:"divorced",title:"Разведена"},{id:"widow",title:"Вдова"}];default:return[{id:"single",title:"Холост/Не замужем"},{id:"married",title:"Женат/Замужем"},{id:"divorced",title:"Разведен/Разведена"},{id:"widow",title:"Вдовец/Вдова"}]}},De=(e,t)=>({title:"Семейное положение",hint:"Необходимо указать актуальную информацию",data:[{fieldName:"familyStatus",title:"",value:A(U(e.sex),e.familyStatus),type:"select",items:U(e.sex),width:"100%"}],confirmed:t}),k=[{id:"a",title:"Читаю и перевожу со словарем"},{id:"b",title:"Читаю и могу объясняться"},{id:"с",title:"Владею свободно"}],we=(e,t)=>({title:"Знание иностранных языков",hint:"Необходимо указать иностранные языки и степень владения ими",data:[...e.languages?.map(i=>[{fieldName:"language",title:"Язык",required:!0,value:i.language},{fieldName:"level",title:"Уровень владения",value:A(k,i.level),type:"select",items:k,width:"100%"}])??[]],default:[[{fieldName:"language",title:"Язык",required:!0,value:"Английский"},{fieldName:"level",title:"Уровень владения",value:k[0],type:"select",items:k,width:"100%"}]],addNew:!0,confirmed:t}),je=(e,t)=>({title:"Проживание",hint:"Необходимо указать фактический адрес проживания",data:[{fieldName:"loc_addr",title:"Адрес проживания",value:e?.loc_addr??"",required:!0},{fieldName:"loc_date",title:"Дата начала проживания",value:e?.loc_date??"",type:"date",required:!0}],optionalCheckbox:{fieldName:"loc_match_reg",title:"Адрес проживания совпадает с адресом регистрации",value:e.loc_match_reg,required:!0},confirmed:t}),qe=(e,t)=>({title:"Паспортные данные",hint:"Необходимо приложить скан-копию 2 и 3 страницы паспорта РФ. Для иностранных работников - страницу паспорта иностранного гражданина с серией и номером и нотариальный перевод паспорта иностранного гражданина.",data:[{fieldName:"",title:"Вид документа",value:e?.pass_type,width:"100%"},{fieldName:"pass_ser",title:"Серия",value:e?.pass_ser??"",required:!0},{fieldName:"pass_num",title:"Номер",value:e?.pass_num??"",required:!0},{fieldName:"pass_div",title:"Кем выдан",value:e?.pass_div??"",required:!0},{fieldName:"pass_date",title:"Дата выдачи",value:e?.pass_date??"",required:!0,type:"date"},{fieldName:"pass_div_code",title:"Код подразделения",value:e?.pass_div_code??"",required:!0},{fieldName:"pass_citizenship",title:"Гражданство",value:e?.pass_citizenship??"",required:!1}],documents:{files:[],required:!0,fieldName:"passportFiles",maxFiles:1},confirmed:t}),ke=(e,t)=>({title:"Личные данные",hint:"Необходимо приложить скан-копию документа, подтверждающего изменения",data:[{fieldName:"fio",title:"ФИО",value:e?.fio??"",required:!0},{fieldName:"sex",title:"Пол",value:e?.sex??"",required:!0},{fieldName:"bdate",title:"Дата рождения",value:e?.bdate??"",required:!0,type:"date"},{fieldName:"bplace",title:"Место рождения",value:e?.bplace??"",required:!0}],documents:{files:[],required:!0,fieldName:"personalFiles",maxFiles:2},confirmed:t}),Fe=(e,t)=>({title:"Регистрация",hint:"Необходимо приложить скан-копию 5 страницы или последующих страниц с соответствующими штампами паспорта РФ. При отсутствии регистрации также прикладывается скан-копия. Для иностранных работников - необходимо приложить скан-копию документа о регистрации на территории РФ.",data:[{fieldName:"reg_addr",title:"Адрес регистрации",value:e?.reg_addr??"",required:!0},{fieldName:"reg_date",title:"Дата регистрации",value:e?.reg_date??"",type:"date",required:!0}],documents:{files:[],required:!0,fieldName:"registrationFiles",maxFiles:2},optionalCheckbox:{fieldName:"reg_none",title:"Регистрация отсутствует",value:!1},confirmed:t}),Se=(e,t)=>{t(!0);const i=e.map(r=>{if(Array.isArray(r.data[0])){const l=r.data.map(g=>Object.assign({},...g?.map(f=>{const v={};return f?.fieldName&&(v[f?.fieldName]=f?.value?.title?f?.value?.title:f?.value),v}))),n={},p=r.title=="Состав семьи"?"family":"langs";return n[p]=JSON.stringify(l),n}else return r.data.map(l=>{const n={};return l?.fieldName&&(n[l?.fieldName??""]=typeof l.value!="object"?l?.value:l.value?.title??null),n})}).flat(),o=e.map(r=>{const l={};if(r.documents?.fieldName)for(let n=0;n<r.documents.files.length;n++)l[r.documents?.fieldName+`[${n}]`]=r.documents.files[n];return l}),m=e.map(r=>{const l={};return r.optionalCheckbox?.fieldName&&(l[r.optionalCheckbox?.fieldName]=r.optionalCheckbox.value),l}),u=Object.assign({},...i,...o,...m);try{C.postTeacherDataVerification(u),t(!1),C.changeCompleted({completed:!0})}catch(r){t(!1),ae.evokePopUpMessage({message:`Не удалось отправить форму. Ошибка: ${r}`,type:"failure",time:3e4})}},Ce=Z.div.withConfig({componentId:"sc-1g5zkfe-0"})(["display:flex;align-items:flex-start;justify-content:center;width:100%;padding:10px;color:var(--text);.data-verification-block{width:100%;height:100%;max-width:600px;padding:20px;border-radius:var(--brLight);background:var(--block-content);box-shadow:var(--block-shadow);display:flex;flex-direction:column;row-gap:20px;}@media (max-width:1000px){padding:50px 0;.data-verification-block{box-shadow:none;}}"]),Oe=()=>{const{data:e,error:t,completed:i}=pe.useTeacherDataVerification(),[o,m]=s.useState(!1),[u,r]=s.useState(null),[l,n]=s.useState(null),[p,g]=s.useState(null),[f,v]=s.useState(null),[x,T]=s.useState(null),[_,O]=s.useState(null),[y,V]=s.useState(null),[N,E]=s.useState(null),[b,M]=s.useState(null),[D,L]=s.useState(null),[w,I]=s.useState(null),[j,$]=s.useState(null),d=!!e?.validated,[P,z]=s.useState(!1);return s.useEffect(()=>{z(!1)},[!!j?.confirmed,!!b?.confirmed,!!u?.confirmed,!!w?.confirmed,!!N?.confirmed,!!_?.confirmed,!!x?.confirmed,!!f?.confirmed,!!l?.confirmed,!!D?.confirmed,!!y?.confirmed,!!p?.confirmed]),s.useEffect(()=>{e&&(r(ke(e,d)),g(xe(e,d)),E(qe(e,d)),L(Fe(e,d)),I(je(e,d)),n(De(e,d)),v(be(e,d)),O(Ne(e,d)),V(we(e,d)),M(ye(e,d)),T(_e(e,d)),$(ge(e,d)))},[e]),a.jsx(ie,{load:()=>ve.getTeacherDataVerificationFx(),loading:!e,error:t,data:e,children:u&&p&&N&&D&&w&&l&&f&&_&&y&&b&&x&&j?a.jsx(Ce,{children:a.jsxs(re,{children:[a.jsx(le,{size:3,align:"left",bottomGap:!0,children:"Подтвердите актуальность данных, указанных в каждом разделе анкеты, либо внесите изменения"}),a.jsx(se,{type:"success",title:`Данные успешно отправлены ${oe(e?.valid_date??new Date)}`,icon:a.jsx(ee,{}),visible:d}),a.jsx(c,{...u,setData:r,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...p,setData:g,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...N,setData:E,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...D,setData:L,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...w,setData:I,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...l,setData:n,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...f,setData:v,divider:!0,defaultOpenArea:!1}),a.jsx(c,{..._,setData:O,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...y,setData:V,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...b,setData:M,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...x,setData:T,divider:!0,defaultOpenArea:!1}),a.jsx(c,{...j,setData:$,divider:!0,defaultOpenArea:!1}),a.jsxs(a.Fragment,{children:[a.jsx(ne,{checked:P,setChecked:z,text:"Я подтверждаю корректность указанных данных"}),a.jsx(de,{text:i?"Отправлено":"Отправить",action:()=>Se([j,b,u,w,N,_,x,f,l,D,y,p],m),isLoading:o,completed:i,setCompleted:Q=>C.changeCompleted({completed:Q}),isDone:i,buttonSuccessText:"Отправлено",repeatable:!0,isActive:!!P,popUpFailureMessage:"Для отправки формы необходимо, чтобы все поля были подтверждены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})]})}):null})};export{Oe as default};
