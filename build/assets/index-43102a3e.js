var o=(e,t,s)=>new Promise((f,d)=>{var n=c=>{try{x(s.next(c))}catch(g){d(g)}},i=c=>{try{x(s.throw(c))}catch(g){d(g)}},x=c=>c.done?f(c.value):Promise.resolve(c.value).then(n,i);x((s=s.apply(e,t)).next())});import{d as T,p as B,e as R,h as q,x as E,i as z,s as p,r as v,j as a,bb as M,c as G}from"./vendor-04d91f24.js";import{au as w,e8 as W,s as K,P as Y,g as b,T as j,f as H,d as J,B as Q}from"./index-60431b6d.js";const $=[{id:"vtb",name:"–ë–∞–Ω–∫ –í–¢–ë (–ü–ê–û)"},{id:"sber",name:"–ü–ê–û –°–±–µ—Ä–±–∞–Ω–∫"},{id:"alfa",name:"–ê–û –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫"}],h={isReady:e=>{if(!e)return!1;const t=e.file;if(!t||typeof t!="string")return!1;const s=t.trim();return s===""?!1:s.startsWith("http")||s.startsWith("/")||s.includes(".php")||s.includes(".")},isProcessing:e=>!!(e&&!h.isReady(e)),hasRequest:e=>!!e,getBankName:e=>{const t=$.find(s=>s.id===e);return(t==null?void 0:t.name)||e},getBankIcon:e=>({sber:"/bank-icons/sber.svg",alfa:"/bank-icons/alfa.svg",vtb:"/bank-icons/vtb.svg"})[e]||"üè¶"},A="/old/lk_api.php",P={getCardRequest:()=>o(void 0,null,function*(){try{const e=yield T.get(`${A}/?getUsedBank&token=${w()}`);let t=null;return e.data&&typeof e.data=="object"&&(Array.isArray(e.data)&&e.data.length>0?(t=e.data[0],t.additionalBank&&!t.selectedBank&&(t.selectedBank=t.additionalBank,delete t.additionalBank)):e.data.success&&e.data.data?(t=e.data.data,t.additionalBank&&!t.selectedBank&&(t.selectedBank=t.additionalBank,delete t.additionalBank)):e.data.file!==void 0||e.data.selectedBank!==void 0||e.data.additionalBank!==void 0||e.data.createdAt!==void 0?(t=e.data,t.additionalBank&&!t.selectedBank&&(t.selectedBank=t.additionalBank,delete t.additionalBank)):(e.data===null||Object.keys(e.data).length===0||Array.isArray(e.data)&&e.data.length===0)&&(t=null)),t}catch(e){return console.error("Error fetching card request:",e),null}}),submitCardRequest:e=>o(void 0,null,function*(){try{const t=new FormData;t.set("accept",e.accept.toString()),e.selectedBank&&t.set("additionalBank",e.selectedBank),t.set("token",w());const s=yield T.post(`${A}/?setUsedBank&token=${w()}`,t,{headers:{"Content-Type":"multipart/form-data"}});return s.data&&typeof s.data=="object"?s.data.success!==void 0?s.data:{success:!0,data:s.data,message:"–ó–∞—è–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∞–Ω–æ"}:{success:!0,data:s.data,message:"–ó–∞—è–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∞–Ω–æ"}}catch(t){throw console.error("Error submitting card request:",t),new Error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–ª–µ–Ω–∏—è")}}),downloadDocument:()=>o(void 0,null,function*(){try{const e=yield P.getCardRequest();if(!(e!=null&&e.file))throw new Error("–§–∞–π–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω");const t=document.createElement("a");t.href=e.file,t.download="used-bank-request.pdf",t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(e){throw console.error("Error downloading document:",e),new Error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞")}})};class V{static getCardRequest(){return o(this,null,function*(){return yield new Promise(t=>setTimeout(t,500)),this.storage})}static submitCardRequest(t){return o(this,null,function*(){if(yield new Promise(s=>setTimeout(s,1e3)),!t.accept)throw new Error("–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è");return this.storage={selectedBank:t.selectedBank,createdAt:new Date().toISOString()},setTimeout(()=>{this.storage&&(this.storage.file="https://example.com/documents/card-request-document.pdf")},5e3),{success:!0,data:this.storage,message:"–ó–∞—è–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∞–Ω–æ"}})}static downloadDocument(){return o(this,null,function*(){var t;if(yield new Promise(i=>setTimeout(i,500)),!((t=this.storage)!==null&&t!==void 0&&t.file))throw new Error("–î–æ–∫—É–º–µ–Ω—Ç –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è");const s=`%PDF-1.4
1 0 obj
<<
/Type /Catalog
/Pages 2 0 R
>>
endobj

2 0 obj
<<
/Type /Pages
/Kids [3 0 R]
/Count 1
>>
endobj

3 0 obj
<<
/Type /Page
/Parent 2 0 R
/MediaBox [0 0 612 792]
/Contents 4 0 R
>>
endobj

4 0 obj
<<
/Length 44
>>
stream
BT
/F1 12 Tf
100 700 Td
(Card Request Document) Tj
ET
endstream
endobj

xref
0 5
0000000000 65535 f
0000000015 00000 n
0000000068 00000 n
0000000125 00000 n
0000000214 00000 n
trailer
<<
/Size 5
/Root 1 0 R
>>
startxref
308
%%EOF`,f=new Blob([s],{type:"application/pdf"}),d=window.URL.createObjectURL(f),n=document.createElement("a");n.href=d,n.download="used-bank-request.pdf",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(d)})}static reset(){this.storage=null}static setDocumentReady(t="https://example.com/documents/card-request-document.pdf"){this.storage&&(this.storage.file=t)}}W(V,"storage",null);const C=P,F=B({name:"cardRequestSubmitted",sid:"-rbem0m"}),D=B({name:"documentDownloadRequested",sid:"f8fluo"}),L=B({name:"cardRequestReset",sid:"-10y3yg"}),l=R(()=>o(void 0,null,function*(){return yield C.getCardRequest()}),{name:"getCardRequestFx",sid:"ei32fg"}),u=R(e=>o(void 0,null,function*(){const t=yield C.submitCardRequest(e);if(!t.success)throw new Error(t.message||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–ª–µ–Ω–∏—è");return t.data}),{name:"submitCardRequestFx",sid:"-79p237"}),m=R(()=>o(void 0,null,function*(){yield C.downloadDocument()}),{name:"downloadDocumentFx",sid:"-896399"}),S=q(null,{name:"$cardRequest",sid:"-68ouxg"}).on(l.doneData,(e,t)=>t).on(u.doneData,(e,t)=>t).reset(L),I=q(!1,{name:"$isLoading",sid:"motyxs"}).on([l,u,m],()=>!0).on([l.done,l.fail,u.done,u.fail,m.done,m.fail],()=>!1),N=q(null,{name:"$error",sid:"-p7eezr"}).on([l.fail,u.fail,m.fail],(e,t)=>t.error.message||"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞").on([l,u,m],()=>null);E({and:[{clock:F,target:u}],or:{sid:"e6l21i"}});E({and:[{clock:D,target:m}],or:{sid:"e8s8ey"}});const X=()=>z({cardRequest:S,isLoading:I,error:N,submitRequest:F,downloadDocument:D,getRequest:l,resetRequest:L}),Z={events:{cardRequestSubmitted:F,documentDownloadRequested:D,cardRequestReset:L},effects:{getCardRequestFx:l,submitCardRequestFx:u,downloadDocumentFx:m},stores:{$cardRequest:S,$isLoading:I,$error:N},selectors:{useCardRequest:X}},k=h.getBankIcon,y=h.getBankName,ee=p.div.withConfig({componentId:"sc-xn7bjn-0"})(["display:flex;flex-direction:column;gap:24px;max-width:800px;margin:0 auto;padding:20px;@media (max-width:768px){padding:16px;gap:16px;}"]),te=p.div.withConfig({componentId:"sc-xn7bjn-1"})(["padding:24px;border-radius:var(--brLight);border:0% solid var(--theme-mild-opposite);box-shadow:0 0 2px rgba(0,0,0,0.3);@media (max-width:768px){padding:16px;}"]),ae=p.div.withConfig({componentId:"sc-xn7bjn-2"})(["border-radius:var(--brLight);padding:20px;margin:16px 0;color:var(--text);line-height:1.8;font-size:15px;.user-info{margin-bottom:20px;}.request-text{margin-bottom:16px;}.additional-request{margin:16px 0;padding:12px;background:var(--theme-2);border-radius:var(--brLight);border-left:1px solid var(--reallyBlue);}.consent-text{margin-top:20px;font-style:italic;}"]),ne=p.div.withConfig({componentId:"sc-xn7bjn-3"})(["display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:16px;margin:16px 0;@media (max-width:768px){grid-template-columns:repeat(2,1fr);gap:12px;}"]),se=p.div.withConfig({componentId:"sc-xn7bjn-4"})(["margin:24px 0;padding:20px;background:var(--block-content);border-radius:var(--brLight);background:rgba(186,192,255,0.09);"]),ie=p.div.withConfig({componentId:"sc-xn7bjn-5"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px 12px;border-radius:var(--brLight);border:0 solid ",";background:shadow;background:",";color:",";cursor:pointer;transition:all 0.2s ease;text-align:center;min-height:120px;&:hover{border-color:var(--reallyBlue);background:",";transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.1);}input[type='checkbox']{display:none;}.bank-icon{display:flex;align-items:center;justify-content:center;width:60px;height:60px;border-radius:12px;background:",";}.bank-name{font-weight:500;font-size:0.95rem;line-height:1.2;}@media (max-width:768px){padding:16px 8px;min-height:100px;.bank-icon{width:50px;height:50px;margin-bottom:8px;}.bank-name{font-size:0.85rem;}}"],({selected:e})=>e?"var(--reallyBlue)":"var(--theme-mild-opposite)",({selected:e})=>e?"var(--reallyBlue)":"var(--block-content)",({selected:e})=>e?"white":"var(--text)",({selected:e})=>e?"var(--reallyBlue)":"var(--block-content)",({selected:e})=>e?"rgba(255, 255, 255, 0.2)":"var(--theme-mild)"),re=p.div.withConfig({componentId:"sc-xn7bjn-6"})(["margin-top:24px;padding:24px;background:var(--block-content);border-radius:var(--brLight);border:0px solid var(--theme-mild-opposite);box-shadow:0 0 2px rgba(0,0,0,0.3);"]),oe=p.div.withConfig({componentId:"sc-xn7bjn-7"})(["display:flex;gap:12px;justify-content:flex-start;flex-wrap:wrap;width:100%;@media (max-width:768px){flex-direction:column;}"]),de=()=>{const{cardRequest:e,isLoading:t,error:s,submitRequest:f,getRequest:d}=Z.selectors.useCardRequest(),{data:{user:n}}=K.useUser(),[i,x]=v.useState((e==null?void 0:e.selectedBank)||""),g=(()=>{const r=new Date,U=new Date(r.getFullYear(),9,1);return r<U})();v.useEffect(()=>{d()},[]),v.useEffect(()=>{e!=null&&e.selectedBank&&x(e.selectedBank)},[e==null?void 0:e.selectedBank]);const _=r=>{x(r)},O=()=>{f({accept:!0,selectedBank:i}),setTimeout(()=>{d()},1e3)};return a.jsx(Y,{children:a.jsxs(ee,{children:[s&&a.jsx(b,{type:"failure",title:"–û—à–∏–±–∫–∞",children:s}),h.hasRequest(e)&&(e.file||e.createdAt)&&a.jsxs(re,{children:[a.jsx(j,{size:4,bottomGap:"16px",children:"–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–ª–µ–Ω–∏—è"}),a.jsx("div",{style:{marginBottom:"24px",color:"var(--text-secondary)"},children:a.jsxs("p",{style:{marginBottom:"8px"},children:["–í—ã–±—Ä–∞–Ω–Ω—ã–π –±–∞–Ω–∫:"," ",e.selectedBank?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:k(e.selectedBank),alt:e.selectedBank,style:{width:"24px",height:"24px",marginLeft:"8px"}})," ",a.jsx("strong",{children:y(e.selectedBank)})]}):a.jsx("strong",{children:"[–±–∞–Ω–∫ –Ω–µ –≤—ã–±—Ä–∞–Ω]"})]})}),a.jsxs(H,{gap:"8px",children:[h.isReady(e)&&a.jsx(J,{href:e.file||"#",onClick:()=>null,text:"–°–∫–∞—á–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ",width:"100%",minHeight:"38px",height:"38px",icon:a.jsx(M,{})}),a.jsx(b,{type:"success",icon:a.jsx(G,{}),title:"–£—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω–æ",visible:h.isReady(e),align:"center"})]})]}),g&&a.jsxs(te,{children:[a.jsx(j,{size:4,bottomGap:"16px",children:e?"–ü–æ–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ":"–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–ª–µ–Ω–∏—è"}),a.jsxs(ae,{children:[a.jsxs("div",{className:"user-info",children:["–Ø,"," ",n!=null&&n.surname&&n!==null&&n!==void 0&&n.name&&n!==null&&n!==void 0&&n.patronymic?`${n.surname} ${n.name} ${n.patronymic}`:"[–§–ò–û]",",",a.jsx("br",{}),"–ü–∞—Å–ø–æ—Ä—Ç: ",n!=null&&n.passSer&&n!==null&&n!==void 0&&n.passNum?`${n.passSer} ${n.passNum}`:"—Å–∫—Ä—ã—Ç–æ",a.jsx("br",{}),"–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:"," ","—Å–∫—Ä—ã—Ç–æ",a.jsx("br",{}),"–ù–æ–º–µ—Ä –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞: ",(n==null?void 0:n.phone)||"[—Ç–µ–ª–µ—Ñ–æ–Ω]",a.jsx("br",{}),"–ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã: ",(n==null?void 0:n.email)||"[email]"]}),a.jsxs("div",{className:"request-text",children:["–î–ª—è –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–∏—á–∏—Ç–∞—é—â–∏—Ö—Å—è –º–Ω–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (—Å—Ç–∏–ø–µ–Ω–¥–∏–π, –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –¥—Ä—É–≥–∏—Ö –≤—ã–ø–ª–∞—Ç) –ø—Ä–æ—à—É –í–∞—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç—ã –ù–°–ü–ö ¬´–ú–ò–†¬ª –≤ —Ä–∞–º–∫–∞—Ö –∑–∞—Ä–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —Å –±–∞–Ω–∫–æ–º"," ",i?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:k(i),alt:i,style:{width:"20px",height:"20px",marginLeft:"4px"}})," ",y(i)]}):"[–≤—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫]"]}),a.jsxs("div",{className:"consent-text",children:["–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –º–Ω–æ—é –ø—Ä–∏ –ø—Ä–∏–µ–º–µ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –≤ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –ü–æ–ª–∏—Ç–µ—Ö —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∏—Ö –ø–µ—Ä–µ–¥–∞—á—É –≤ –±–∞–Ω–∫"," ",i?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:k(i),alt:i,style:{width:"20px",height:"20px",marginLeft:"4px"}})," ",y(i)]}):"[–≤—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫]"," ","–≤ —Ü–µ–ª—è—Ö –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç—ã."]})]}),a.jsxs(se,{children:[a.jsx(j,{size:5,bottomGap:"12px",children:"–í—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫:"}),a.jsx(ne,{children:$.map(r=>a.jsxs(ie,{selected:i===r.id,onClick:()=>_(r.id),children:[a.jsx("div",{className:"bank-icon",children:a.jsx("img",{src:k(r.id),alt:r.id,style:{width:"40px",height:"40px"}})}),a.jsx("div",{className:"bank-name",children:r.name})]},r.id))})]}),a.jsx(oe,{children:a.jsx(Q,{onClick:O,text:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–ª–µ–Ω–∏–µ",background:"var(--reallyBlue)",textColor:"white",loading:t,isActive:!!i,notActiveClickMessage:"–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫",width:"100%"})}),a.jsx("br",{}),e&&a.jsx(b,{type:"info",title:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",children:"–ü–æ–¥–∞—á–∞ –Ω–æ–≤–æ–≥–æ –∑–∞—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ."})]}),!g&&!e&&a.jsx(b,{type:"failure",title:"–§–æ—Ä–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞",children:"–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–ª–µ–Ω–∏–π –Ω–∞ –≤—ã–ø—É—Å–∫ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –∫–∞—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–æ 1 –æ–∫—Ç—è–±—Ä—è)."})]})})},pe=()=>a.jsx(de,{});export{pe as default};
