import{s as w,j as e,r as m,M as W}from"./vendor-8312535b.js";import{$ as z,g as D,aE as M,aF as T,h as P,X as b,aG as B,aH as k,K as g,r as N,ap as p,l as u,ai as E,W as U,_ as L,P as H,q as A,an as h,H as I,x as R}from"./index-3ed27df5.js";const K=async()=>(await z.get(`?getVacations&token=${D()}`)).data,j=M({api:{get:K},errorMessage:()=>"Возникла ошибка с получением графика отпусков!"}),q=w(T).withConfig({componentId:"sc-13iobzb-0"})(["border-radius:var(--brLight);background:var(--block-content);position:relative;.background{font-size:6em;position:absolute;bottom:0px;right:10px;font-weight:bold;opacity:0.5;}.content{height:100%;display:flex;align-items:flex-end;}"]),v=({children:s,title:n,text:l,width:i,height:o,background:r,padding:t})=>e.jsxs(q,{alignItems:"flex-start",gap:"10px",orientation:"vertical",width:i!=null?i:"15vw",minHeight:o!=null?o:"150px",maxHeight:o!=null?o:"150px",padding:t,children:[e.jsx(P,{size:4,align:"left",children:n}),e.jsx(b,{visible:!!l,fontSize:"0.9em",children:B(l!=null?l:"",60)}),r&&e.jsx("div",{className:"background",children:r}),s&&e.jsx("div",{className:"content",children:s})]}),x={fiveToNine:"дней",one:"день",twoToFour:"дня",zero:"дней"},G=[{title:"Плановые периоды отпуска",field:"plannedVacationPeriods",showFull:!0},{title:"Фактические периоды отпуска",field:"actualVacationPeriods",showFull:!0},{title:"Остаток отпуска",field:"unusedVacationPeriods",showFull:!0}],O=s=>{const{division:n,post:l,vacations:i,allActualVacationPeriods:o,allPlannedVacationPeriods:r,allUnusedVacationPeriods:t}=X(s);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{children:[e.jsx(g,{keyStr:"Подразделение",value:n}),e.jsx(g,{keyStr:"Должность",value:l})]}),e.jsx(N,{columns:G,data:i,footer:()=>({allPlannedVacationPeriods:f(r),allActualVacationPeriods:f(o),allUnusedVacationPeriods:f(t)})})]})};function f(s){return`Всего: ${s} ${p(Math.trunc(s||0),x)}`}function X(s){const{fact:n,plan:l,unused:i,division:o,post:r}=s;return{division:o,post:r,vacations:J(n,l,i),allActualVacationPeriods:n.reduce((t,{numdays:a})=>(t+=+a,t),0),allPlannedVacationPeriods:l.reduce((t,{numdays:a})=>(t+=+a,t),0),allUnusedVacationPeriods:i.reduce((t,{numdays:a})=>(t+=+a,t),0)}}function J(s,n,l){const i=Math.max(s.length,n.length,l.length),o=[];for(let r=0;r<i;r++){const t=s[r],a=n[r],c=l[r],d={actualVacationPeriods:"",plannedVacationPeriods:"",unusedVacationPeriods:""},$=u(t==null?void 0:t.from,"numeric"),V=u(t==null?void 0:t.to,"numeric"),_=u(a==null?void 0:a.from,"numeric"),F=u(a==null?void 0:a.to,"numeric"),C=u(c==null?void 0:c.from,"numeric"),S=u(c==null?void 0:c.to,"numeric");t&&(d.actualVacationPeriods=`${$} - ${V} (${t.numdays} ${p(Number(t.numdays)||0,x)})`),a&&(d.plannedVacationPeriods=`${_} - ${F} (${a.numdays} ${p(Number(a.numdays)||0,x)})`),c&&(d.unusedVacationPeriods=`${C} - ${S} (${c.numdays} ${p(Math.trunc(Number(c.numdays))||0,x)})`),o.push(d)}return o}const y={fiveWorkDays:"https://e.mospolytech.ru/old/storage/files/Proizvodstvennyj_kalendar_na_2024_god_dlya_pyatidnevnoj_rabochej_nedeli.pdf",sixWorkDays:"https://e.mospolytech.ru/old/storage/files/Proizvodstvennyj_kalendar_na_2024_god_dlya_shestidnevnoj_rabochej.pdf"},Q=()=>{var a;const{data:{user:s}}=E.useUser(),{data:n,error:l}=j.selectors.useData(),i=m.useMemo(()=>(n==null?void 0:n.map((c,d)=>({id:d,title:c.division})))||[],[n]),[o,r]=m.useState((a=i[0])!=null?a:{});m.useEffect(()=>{o!=null&&o.id||r(i[0])},[o==null?void 0:o.id,r,i]);const t=n==null?void 0:n[Number((o==null?void 0:o.id)||0)];return e.jsx(U,{load:j.effects.getFx,error:l,data:n,children:e.jsx(L,{alignItems:"flex-start",children:e.jsxs(H,{topRightCornerElement:e.jsx(A,{onClick:()=>{window.location.replace("https://e.mospolytech.ru/old/index.php?p=vacation")},text:"Заполнить график",background:"var(--reallyBlue)",textColor:"#fff",icon:e.jsx(W,{}),minWidth:"35px",height:"36px"}),children:[e.jsx(b,{width:"100%",maxWidth:"100%",children:"Производственный календарь на 2024 год"}),e.jsxs(k,{scroll:!1,direction:"horizontal",gap:12,wrapOnMobile:!0,children:[e.jsx(v,{title:"Для пятидневной рабочей недели",height:"120px",width:"50%",background:"5",padding:"20px 40px 20px 20px",children:e.jsx(h,{onClick:()=>null,href:y.fiveWorkDays,textColor:"var(--reallyBlue)",text:"Подробнее",background:"transparent",padding:"10px 0"})}),e.jsx(v,{title:"Для шестидневной рабочей недели",height:"120px",width:"50%",background:"6",padding:"20px 40px 20px 20px",children:e.jsx(h,{onClick:()=>null,href:y.sixWorkDays,textColor:"var(--reallyBlue)",text:"Подробнее",background:"transparent",padding:"10px 0"})})]}),e.jsx(I,{}),e.jsx(P,{size:3,align:"left",children:"Сведения о трудоустройстве"}),!!(s!=null&&s.id)&&e.jsx(R,{width:"fit-content",items:i,selected:o,setSelected:r}),t&&e.jsx(O,{...t})]})})})},ee=()=>e.jsx(Q,{});export{ee as default};
