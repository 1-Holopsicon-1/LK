import{s as f,r as d,j as e,w as g}from"./vendor-249420f4.js";import{A as j,a as h}from"./alert-item-b17da0ad.js";import{bh as u,T as v,D as w,E as b,a9 as S,aW as A,r as C,b0 as E,W as I,N,R as y}from"./index-72b1dbf4.js";import"./is-valid-url-08a91344.js";const D=(t,n)=>Object.keys(n).reduce((s,r)=>{const o=n[r].filter(l=>u(l.title).includes(u(t)));return s[r],s[r]=o,s},{}),k=f.div.withConfig({componentId:"sc-n7iv4z-0"})(["width:100%;opacity:",";.top{cursor:pointer;display:flex;align-items:center;margin:10px 0;width:100%;justify-content:space-between;.title-wrapper{width:50px;}.left{display:flex;align-items:center;svg{transform:rotate(",");}}}.children{transition:0.2s;}.children.close{opacity:0;visibility:hidden;height:0;pointer-events:none;transform:translateY(-30px);}.children.open{opacity:1;visibility:visible;height:fit-content;pointer-events:all;transform:translateY(0px);}"],({noChildren:t})=>t?"0.5":"1",({collapsed:t})=>t?"0deg":"180deg"),F=({title:t,children:n,initiallyCollapsed:s,sideText:r,isCollapsed:o})=>{const[l,i]=d.useState(s!=null?s:!0),a=n==null,c=()=>i(p=>!p);return d.useEffect(()=>{o!==void 0&&i(a)},[o,n]),e.jsxs(k,{collapsed:l,noChildren:a,children:[e.jsxs("div",{className:"top",onClick:c,children:[e.jsxs("div",{className:"left",children:[e.jsx(v,{size:4,align:"left",children:t}),e.jsx(g,{})]}),e.jsx(w,{margin:"0 20px"}),e.jsx(b,{children:r})]}),e.jsx("div",{className:"children"+(l?" close":" open"),children:n})]})},T=f.div.withConfig({componentId:"sc-gyjwiw-0"})(["width:100%;display:flex;flex-direction:column;gap:12px;"]),z=({alerts:t,listView:n})=>{const{data:{user:s}}=S.useUser(),[r,o]=d.useState(null),l=r!=null?r:t;return e.jsxs(T,{children:[!n&&e.jsx(A,{placeholder:"Поиск новостей",whereToSearch:t,searchEngine:D,setResult:o,loadingOnType:!0,validationCheck:!0}),Object.keys(l).sort((i,a)=>Number.parseInt(a)-Number.parseInt(i)).map(i=>{const a=new Date().getFullYear().toString(),c=r===null?i!==a:!1,p=`Новостей: ${l[i].length}`;return e.jsx(F,{sideText:p,title:i,isCollapsed:c,initiallyCollapsed:c,children:e.jsx(C,{d:"column",gap:"8px",children:l[i].map((x,m)=>e.jsx(j,{isNew:i===a&&m===0&&(s==null?void 0:s.hasAlerts),news:x,orientation:"horizontal"},x.id))})},i)})]})},B=()=>{const{preparedData:t,error:n,loading:s}=h.selectors.useData();return d.useEffect(()=>{E.clearById({id:"alert",pageId:"alerts"})},[]),e.jsx(I,{load:h.effects.getFx,error:n,loading:s,data:t,children:e.jsx(N,{children:t?e.jsx(z,{alerts:t}):e.jsx(y,{text:"У вас нет оповещений"})})})};export{B as default};
