var _=Object.defineProperty,B=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var S=(e,s,t)=>s in e?_(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,k=(e,s)=>{for(var t in s||(s={}))M.call(s,t)&&S(e,t,s[t]);if(g)for(var t of g(s))N.call(s,t)&&S(e,t,s[t]);return e},E=(e,s)=>B(e,L(s));import{r as l,j as o,F as W}from"./vendor-8a1e4858.js";import{t as z,bC as I,g as P,T as U,Y as G,i as O,bD as R,a6 as Y,W as b,k as q,v as w,l as H}from"./index-4a477e8a.js";import{s as J}from"./send-form-7978fd30.js";import{g as K}from"./get-method-obstaing-bad4fac3.js";const Q=({model:e,getForm:s,successMessage:t,outerForm:i,isAvailableToSend:a=!0,repeatable:d=!0,formId:j,isSpecialField:h})=>{var f,u,c;const{data:r,completed:p}=e.selectors.useForm(),[m,x]=l.useState(!1),[n,v]=l.useState(null),[C,D]=l.useState({}),F=(f=p||!a)!==null&&f!==void 0?f:!1;return l.useEffect(()=>{r&&v(i!=null?i:s(r))},[r]),l.useEffect(()=>{h&&n&&r&&D(K(n.data))},[n]),!n||!v?o.jsx(z,{}):o.jsxs(o.Fragment,{children:[o.jsx(I,E(k({},n),{collapsed:F&&!d,setData:v,specialFieldsNameConfig:C})),o.jsx(P,{title:"Информация по заявке",type:"info",icon:o.jsx(W,{}),visible:F&&!!t,children:t}),(r==null?void 0:r.last_update)&&o.jsxs(U,{size:5,children:["Дата последней отправки: ",G(r.last_update)]}),o.jsx(O,{text:a?"Отправить":"Отправлено",action:()=>J(n,e.effects.postFormFx,x,e.events.changeCompleted,j),isLoading:m,completed:p,setCompleted:T=>e.events.changeCompleted({completed:T}),buttonSuccessText:"Отправлено",repeatable:d,isDone:F&&!d,isActive:R(n,C)&&((u=(c=n.optionalCheckbox)===null||c===void 0?void 0:c.value)!==null&&u!==void 0?u:!0),popUpFailureMessage:F?"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})},y=({model:e,getForm:s,successMessage:t,goBack:i,pageAvailability:a,isAvailableToSend:d=!0,repeatable:j=!0,formId:h,isSpecialField:f=!1,title:u})=>{var c;const{data:r,error:p}=e.selectors.useForm(),[m,x]=l.useState(null);if((c=!!a&&!(a!=null&&a.isAvailable))!==null&&c!==void 0&&c){var n;return o.jsx(Y,{text:(n=a==null?void 0:a.text)!==null&&n!==void 0?n:"Вам не доступен этот раздел"})}return l.useEffect(()=>{r&&x(s(r))},[r]),o.jsx(b,{load:()=>e.effects.getFormFx(),error:p,data:m,children:o.jsx(q,{children:!!m&&!!x&&o.jsxs(w,{children:[o.jsx(H,{text:i,visible:!!i}),u&&o.jsx("h2",{children:u}),o.jsx(Q,{model:e,successMessage:t,isAvailableToSend:d,repeatable:j,getForm:s,outerForm:m,formId:h,isSpecialField:f})]})})})};export{y as T};
