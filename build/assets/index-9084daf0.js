var B=Object.defineProperty,N=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var k=(s,t,e)=>t in s?B(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,h=(s,t)=>{for(var e in t||(t={}))U.call(t,e)&&k(s,e,t[e]);if(E)for(var e of E(t))W.call(t,e)&&k(s,e,t[e]);return s},g=(s,t)=>N(s,P(t));var D=(s,t,e)=>new Promise((i,a)=>{var l=n=>{try{f(e.next(n))}catch(o){a(o)}},u=n=>{try{f(e.throw(n))}catch(o){a(o)}},f=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,u);f((e=e.apply(s,t)).next())});import{r as p,j as r,F as _}from"./vendor-249420f4.js";import{ae as w,e as z,L as I,I as L,M as R,T as $,l as G,S as J,ac as O,R as q,W as H,J as K,F as Q,af as V}from"./index-72b1dbf4.js";import{g as X}from"./get-method-obstaing-bad4fac3.js";const Y=(s,t,e,i,a)=>D(void 0,null,function*(){e(!0);const l=w(s);try{a?yield t(g(h({},l),{formId:a})):yield t(h({},l)),e(!1),i({completed:!0})}catch(u){e(!1),z.evokePopUpMessage({message:`${u}`,type:"failure",time:3e4})}}),Z=({model:s,getForm:t,successMessage:e,outerForm:i,isAvailableToSend:a=!0,repeatable:l=!0,formId:u,isSpecialField:f})=>{var S,C;var n;const{data:o,completed:d}=s.selectors.useForm(),[v,x]=p.useState(!1),[c,m]=p.useState(null),[F,M]=p.useState({}),j=(S=d||!a)!=null?S:!1;return p.useEffect(()=>{o&&m(i!=null?i:t(o))},[o]),p.useEffect(()=>{f&&c&&o&&M(X(c.data))},[c]),!c||!m?r.jsx(I,{}):r.jsxs(r.Fragment,{children:[r.jsx(L,g(h({},c),{collapsed:j&&!l,setData:m,specialFieldsNameConfig:F})),r.jsx(R,{title:"Информация по заявке",type:"info",icon:r.jsx(_,{}),visible:j&&!!e,children:e}),(o==null?void 0:o.last_update)&&r.jsxs($,{size:5,children:["Дата последней отправки: ",G(o.last_update)]}),r.jsx(J,{text:a?"Отправить":"Отправлено",action:()=>Y(c,s.effects.postFormFx,x,s.events.changeCompleted,u),isLoading:v,completed:d,setCompleted:T=>s.events.changeCompleted({completed:T}),buttonSuccessText:"Отправлено",repeatable:l,isDone:j&&!l,isActive:O(c,F)&&((C=(n=c.optionalCheckbox)===null||n===void 0?void 0:n.value)!=null?C:!0),popUpFailureMessage:j?"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})},se=({model:s,getForm:t,successMessage:e,goBack:i,pageAvailability:a,isAvailableToSend:l=!0,repeatable:u=!0,formId:f,isSpecialField:n=!1,title:o})=>{var m,F;const{data:d,error:v}=s.selectors.useForm(),[x,c]=p.useState(null);return(m=!!a&&!(a!=null&&a.isAvailable))!=null&&m?r.jsx(q,{text:(F=a==null?void 0:a.text)!=null?F:"Вам не доступен этот раздел"}):(p.useEffect(()=>{d&&c(t(d))},[d]),r.jsx(H,{load:()=>s.effects.getFormFx(),error:v,data:x,children:r.jsx(K,{children:!!x&&!!c&&r.jsxs(Q,{children:[r.jsx(V,{text:i,visible:!!i}),o&&r.jsx("h2",{children:o}),r.jsx(Z,{model:s,successMessage:e,isAvailableToSend:l,repeatable:u,getForm:t,outerForm:x,formId:f,isSpecialField:n})]})})}))};export{se as T};
