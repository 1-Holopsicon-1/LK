var B=Object.defineProperty,D=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var S=(e,s,t)=>s in e?B(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,g=(e,s)=>{for(var t in s||(s={}))M.call(s,t)&&S(e,t,s[t]);if(E)for(var t of E(s))N.call(s,t)&&S(e,t,s[t]);return e},k=(e,s)=>D(e,L(s));import{r as l,j as o,F as W}from"./vendor-fdf02817.js";import{a_ as z,bB as I,f as P,T as U,E as b,h as G,bC as O,Z as R,W as Z,j as q,b2 as w,k as H}from"./index-2172af78.js";import{s as J}from"./send-form-44f8daf5.js";import{g as K}from"./get-method-obstaing-bad4fac3.js";const Q=({model:e,getForm:s,successMessage:t,outerForm:i,isAvailableToSend:a=!0,repeatable:d=!0,formId:j,isSpecialField:h})=>{var f,u,c;const{data:r,completed:p}=e.selectors.useForm(),[m,x]=l.useState(!1),[n,v]=l.useState(null),[C,T]=l.useState({}),F=(f=p||!a)!==null&&f!==void 0?f:!1;return l.useEffect(()=>{r&&v(i!=null?i:s(r))},[r]),l.useEffect(()=>{h&&n&&r&&T(K(n.data))},[n]),!n||!v?o.jsx(z,{}):o.jsxs(o.Fragment,{children:[o.jsx(I,k(g({},n),{collapsed:F&&!d,setData:v,specialFieldsNameConfig:C})),o.jsx(P,{title:"Информация по заявке",type:"info",icon:o.jsx(W,{}),visible:F&&!!t,children:t}),(r==null?void 0:r.last_update)&&o.jsxs(U,{size:5,children:["Дата последней отправки: ",b(r.last_update)]}),o.jsx(G,{text:a?"Отправить":"Отправлено",action:()=>J(n,e.effects.postFormFx,x,e.events.changeCompleted,j),isLoading:m,completed:p,setCompleted:_=>e.events.changeCompleted({completed:_}),buttonSuccessText:"Отправлено",repeatable:d,isDone:F&&!d,isActive:O(n,C)&&((u=(c=n.optionalCheckbox)===null||c===void 0?void 0:c.value)!==null&&u!==void 0?u:!0),popUpFailureMessage:F?"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})},y=({model:e,getForm:s,successMessage:t,goBack:i,pageAvailability:a,isAvailableToSend:d=!0,repeatable:j=!0,formId:h,isSpecialField:f=!1,title:u})=>{var c;const{data:r,error:p}=e.selectors.useForm(),[m,x]=l.useState(null);if((c=!!a&&!(a!=null&&a.isAvailable))!==null&&c!==void 0&&c){var n;return o.jsx(R,{text:(n=a==null?void 0:a.text)!==null&&n!==void 0?n:"Вам не доступен этот раздел"})}return l.useEffect(()=>{r&&x(s(r))},[r]),o.jsx(Z,{load:()=>e.effects.getFormFx(),error:p,data:m,children:o.jsx(q,{children:!!m&&!!x&&o.jsxs(w,{children:[o.jsx(H,{text:i,visible:!!i}),u&&o.jsx("h2",{children:u}),o.jsx(Q,{model:e,successMessage:t,isAvailableToSend:d,repeatable:j,getForm:s,outerForm:m,formId:h,isSpecialField:f})]})})})};export{y as T};
