import{s as f,r as d,j as e,w as g}from"./vendor-08ab745b.js";import{A as j,a as h}from"./alert-item-3eff017f.js";import{bB as u,h as v,H as w,X as b,ai as C,bp as y,G as A,ao as S,W as I,P as E,a2 as N}from"./index-0892b83f.js";import"./is-valid-url-08a91344.js";const k=(t,s)=>Object.keys(s).reduce((l,i)=>{const a=s[i].filter(r=>u(r.title).includes(u(t)));return l[i],l[i]=a,l},{}),D=f.div.withConfig({componentId:"sc-n7iv4z-0"})(["width:100%;opacity:",";.top{cursor:pointer;display:flex;align-items:center;margin:10px 0;width:100%;justify-content:space-between;.title-wrapper{width:50px;}.left{display:flex;align-items:center;svg{transform:rotate(",");}}}.children{transition:0.2s;}.children.close{opacity:0;visibility:hidden;height:0;pointer-events:none;transform:translateY(-30px);}.children.open{opacity:1;visibility:visible;height:fit-content;pointer-events:all;transform:translateY(0px);}"],({noChildren:t})=>t?"0.5":"1",({collapsed:t})=>t?"0deg":"180deg"),F=({title:t,children:s,initiallyCollapsed:l,sideText:i,isCollapsed:a})=>{const[r,n]=d.useState(l??!0),o=s==null,c=()=>n(p=>!p);return d.useEffect(()=>{a!==void 0&&n(o)},[a,s]),e.jsxs(D,{collapsed:r,noChildren:o,children:[e.jsxs("div",{className:"top",onClick:c,children:[e.jsxs("div",{className:"left",children:[e.jsx(v,{size:4,align:"left",children:t}),e.jsx(g,{})]}),e.jsx(w,{margin:"0 20px"}),e.jsx(b,{children:i})]}),e.jsx("div",{className:"children"+(r?" close":" open"),children:s})]})},z=f.div.withConfig({componentId:"sc-gyjwiw-0"})(["width:100%;display:flex;flex-direction:column;gap:12px;"]),T=({alerts:t,listView:s})=>{const{data:{user:l}}=C.useUser(),[i,a]=d.useState(null),r=i??t;return e.jsxs(z,{children:[!s&&e.jsx(y,{placeholder:"Поиск новостей",whereToSearch:t,searchEngine:k,setResult:a,loadingOnType:!0,validationCheck:!0}),Object.keys(r).sort((n,o)=>Number.parseInt(o)-Number.parseInt(n)).map(n=>{const o=new Date().getFullYear().toString(),c=i===null?n!==o:!1,p=`Новостей: ${r[n].length}`;return e.jsx(F,{sideText:p,title:n,isCollapsed:c,initiallyCollapsed:c,children:e.jsx(A,{d:"column",gap:"8px",children:r[n].map((x,m)=>e.jsx(j,{isNew:n===o&&m===0&&l?.hasAlerts,news:x,orientation:"horizontal"},x.id))})},n)})]})},R=()=>{const{preparedData:t,error:s,loading:l}=h.selectors.useData();return d.useEffect(()=>{S.clearById({id:"alert",pageId:"alerts"})},[]),e.jsx(I,{load:h.effects.getFx,error:s,loading:l,data:t,children:e.jsx(E,{children:t?e.jsx(T,{alerts:t}):e.jsx(N,{text:"У вас нет оповещений"})})})};export{R as default};
