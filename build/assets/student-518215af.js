import{p as a,e as i,x as t,h as d,v as ce,m as re,cP as le,K as w,r as C,n as ge,cQ as me,cR as ue,j as h}from"./vendor-08ab745b.js";import{a5 as pe,a6 as fe,o as b,n as r,d as n,U as ke,a7 as ve,a8 as $e,a9 as xe,aa as ye,ab as Pe,ac as De,ad as Se,ae as Ae,af as he,Z as Fe,G as we,p as be,q as Ve,l as G,L as q}from"./index-0892b83f.js";const H=a({name:"addVisit",sid:"3ybve7"}),T=a({name:"removeVisit",sid:"w1vlkj"}),l=i(async e=>(await pe(e),e),{name:"addVisitFx",sid:"-lbpib"}),m=i(async({id:e})=>(await fe(e),e),{name:"removeVisitFx",sid:"-wpy18p"}),Re=m.pending,Ue=l.pending;t({and:[{clock:H,target:l}],or:{sid:"-tzueuh"}});t({and:[{clock:l.doneData,target:b.close}],or:{sid:"-txn8h1"}});t({and:[{clock:l.failData,fn:e=>({message:r(e,"Не удалось добавить посещение"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-tvg23l"}});t({and:[{clock:l.doneData,fn:()=>({message:"Посещение добавлено",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-tey8ar"}});t({and:[{clock:T,target:m}],or:{sid:"-sygehx"}});t({and:[{clock:m.doneData,fn:()=>({message:"Посещение удалено",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-skpjnw"}});t({and:[{clock:m.failData,fn:e=>({message:r(e,"Не удалось удалить посещение"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-sfrebn"}});const Me={addVisit:H,removeVisit:T},y={addVisitFx:l,removeVisitFx:m},ze={pendingRemoveVisit:Re,pendingAddVisit:Ue},B=a({name:"update",sid:"-tu363b"}),je=d("",{name:"$search",sid:"gw0gkq"}).on(B,(e,s)=>s),Ce={update:B},Ge={$search:je},O=a({name:"addFilter",sid:"3pahp2"}),V=a({name:"resetFilters",sid:"sk6sju"}),_=d({},{name:"$filters",sid:"im200n"}).on(Ge.$search,(e,s)=>({...e,fullName:{value:s}})).on(O,(e,{name:s,value:o,strict:g})=>{const c={...e};return o?{...c,[s]:{value:o,strict:g}}:(delete c[s],c)});t({and:[{clock:V,target:_.reinit}],or:{sid:"-drxh28"}});t({and:[{clock:V,fn:()=>"",target:Ce.update}],or:{sid:"-dpqaos"}});const R={$filters:_},Qe={addFilter:O,resetFilters:V},L=a({name:"setIsExam",sid:"shha4n"}),qe=d(!1,{name:"$isExam",sid:"4al1my"}).on(L,(e,s)=>s),Ze={$isExam:qe},Xe={setIsExam:L},U=a({name:"load",sid:"-ip5e0a"}),N=a({name:"setPage",sid:"266xmv"}),M=d(0,{name:"$pEStudentsPage",sid:"x1jwze"}).on(N,(e,s)=>s).on(R.$filters,()=>0),P=ce({and:{source:{page:M,filters:R.$filters},effect:async({filters:e,page:s})=>{const{data:o}=await ke(s,e);return o.data}},or:{name:"loadPageFx",sid:"-u9ar2s"}});re({sid:"-mlc78y",fn:()=>le({source:w({and:[M,R.$filters],or:{name:"source",sid:"-ne89m1"}}),timeout:200,target:U}),name:"none",method:"debounce"});t({and:[{clock:U,target:P}],or:{sid:"-mil8a5"}});const F=d([],{name:"$pEStudents",sid:"-a7h5qn"}).on(P.doneData,(e,s)=>s.students),Ee=d(0,{name:"$pEStudentsTotalCount",sid:"-hptisk"}).on(P.doneData,(e,s)=>s.totalCount),Ie=w({and:[P.pending,Boolean],or:{name:"$loading",sid:"-way26q"}});t({and:[{clock:y.addVisitFx.doneData,source:F,filter:(e,{studentGuid:s})=>e.some(o=>o.studentGuid===s),fn:(e,s)=>{const o=JSON.parse(JSON.stringify(e)),g=o.find(c=>c.studentGuid===s.studentGuid);return++g.visits,o},target:F}],or:{sid:"-m36zo1"}});const Ye={load:U,setPage:N},et={$loading:Ie,$pEStudents:F,$pEStudentsPage:M,$pEStudentsTotalCount:Ee},W=a({name:"addAdditionPoints",sid:"-gfwajq"}),J=a({name:"removeAdditionPoints",sid:"s7fafn"}),u=i(async({id:e})=>{await ve(e)},{name:"removeAdditionPointsFx",sid:"-yz8fw7"});t({and:[{clock:J,target:u}],or:{sid:"-8u8zpu"}});const He=u.pending,p=i(async e=>(await $e(e),e),{name:"addAdditionPointsFx",sid:"htakn7"});t({and:[{clock:W,target:p}],or:{sid:"-8dr5x0"}});t({and:[{clock:p.doneData,target:b.close}],or:{sid:"-8bjzjk"}});t({and:[{clock:p.doneData,fn:()=>({message:"Баллы добавлены",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-7xt4pj"}});t({and:[{clock:p.failData,fn:e=>({message:r(e,"Не удалось добавить баллы"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-7suzda"}});t({and:[{clock:u.doneData,fn:()=>({message:"Баллы удалены",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-7cd5kg"}});t({and:[{clock:u.failData,fn:()=>({message:"Не удалось удалить баллы",type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-6vvbrm"}});const tt={addAdditionPoints:W,removeAdditionPoints:J},E={addAdditionPointsFx:p,removeAdditionPointsFx:u},st={pendingRemoveAdditionPoints:He},K=a({name:"addRegulationPoints",sid:"r944lm"}),Q=a({name:"removeRegulationPoints",sid:"2sncem"}),f=i(async({id:e})=>{await xe(e)},{name:"removeRegulationPointsFx",sid:"-krrp8n"});t({and:[{clock:Q,target:f}],or:{sid:"mz5r9q"}});const Te=f.pending,k=i(async e=>(await ye(e),e),{name:"addRegulationPointsFx",sid:"-dsdequ"});t({and:[{clock:K,target:k}],or:{sid:"nfnl2k"}});t({and:[{clock:k.doneData,target:b.close}],or:{sid:"nhurg0"}});t({and:[{clock:k.doneData,fn:()=>({message:"Норматив добавлен",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"nvlma1"}});t({and:[{clock:k.failData,fn:e=>({message:r(e,"Не удалось добавить норматив"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"o0jrma"}});t({and:[{clock:f.doneData,fn:()=>({message:"Норматив удален",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"oh1lf4"}});t({and:[{clock:f.failData,fn:()=>({message:"Не удалось удалить норматив",type:"failure"}),target:n.evokePopUpMessage}],or:{sid:"oxjf7y"}});const at={addRegulationPoints:K,removeRegulationPoints:Q},I={addRegulationPointsFx:k,removeRegulationPointsFx:f},nt={pendingRemoveRegulationPoints:Te},Z=a({name:"setSpecialization",sid:"hrz73m"}),v=i(async e=>(await Pe(e),e),{name:"setSpecializationFx",sid:"-aw52yn"}),Be=v.pending;t({and:[{clock:Z,target:v}],or:{sid:"-4x6l4a"}});t({and:[{clock:v.failData,fn:e=>({message:r(e,"Не удалось добавить специализацию"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-4uzequ"}});t({and:[{clock:v.doneData,fn:()=>({message:"Специализация добавлена",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-4ehky0"}});const ot={setSpecialization:Z},Oe={setSpecializationFx:v},it={pendingSetSpecialization:Be},X=a({name:"setHealthGroup",sid:"8b83ja"}),$=i(async e=>(await De(e),e),{name:"setHealthGroupFx",sid:"a5qgdx"}),_e=$.pending;t({and:[{clock:X,target:$}],or:{sid:"-fydy6l"}});t({and:[{clock:$.failData,fn:e=>({message:r(e,"Не удалось добавить группу здоровья"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-fw6rt5"}});t({and:[{clock:$.doneData,fn:()=>({message:"Группа здоровья добавлена",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"-ffoy0b"}});const dt={setHealthGroup:X},Le={setHealthGroupFx:$},ct={pendingSetHealthGroup:_e},Y=a({name:"setCurrentStudentId",sid:"-yi431d"}),ee=a({name:"resetStudentId",sid:"b5joy3"}),te=a({name:"reload",sid:"-4igy6g"}),D=i(async e=>{const{data:s}=await Se(e);return s.data},{name:"loadCurrentStudent",sid:"-htqwl5"});t({and:[{clock:Y,target:D}],or:{sid:"-e9batg"}});const z=d(null,{name:"$selectedStudent",sid:"ffg61i"}).reset(ee),Ne=w({and:[y.addVisitFx.pending,D.pending,Boolean],or:{name:"$loading",sid:"4dn8ye"}});t({and:[{clock:[y.addVisitFx.doneData,y.removeVisitFx.doneData,Le.setHealthGroupFx.doneData,Oe.setSpecializationFx.doneData,E.addAdditionPointsFx.doneData,E.removeAdditionPointsFx.doneData,I.addRegulationPointsFx.doneData,I.removeRegulationPointsFx.doneData],target:te}],or:{sid:"-dugusp"}});t({and:[{clock:te,source:z,filter:e=>!!e,fn:e=>e.studentGuid,target:D}],or:{sid:"-ds9of9"}});t({and:[{clock:D.doneData,target:z}],or:{sid:"-dcvft5"}});const rt={$selectedStudent:z,$loading:Ne},lt={setCurrentStudentId:Y,resetStudentId:ee},se=a({name:"load",sid:"-1nsq63"}),ae=a({name:"remove",sid:"wecpac"}),ne=i(async()=>{const{data:e}=await Ae();return e.competitions},{name:"loadFx",sid:"-d34r01"}),S=i(async e=>(await he(e),e),{name:"removeFx",sid:"y5v9by"});t({and:[{clock:ae,target:S}],or:{sid:"q9j9ts"}});t({and:[{clock:S.failData,fn:e=>({message:r(e,"Не удалось удалить соревнование"),type:"failure",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"qna4nt"}});t({and:[{clock:S.doneData,fn:()=>({message:"Соревнование удалено",type:"success",time:3e3}),target:n.evokePopUpMessage}],or:{sid:"r3rygn"}});t({and:[{clock:se,target:ne}],or:{sid:"r8q3sw"}});const We=d([],{name:"$competitions",sid:"dxwaax"}).on(ne.doneData,(e,s)=>s).on(S.doneData,(e,s)=>e.filter(o=>o!==s)),gt={load:se,remove:ae},mt={$competitions:We};var x=(e=>(e.AdminAccess="AdminAccess",e.DefaultAccess="DefaultAccess",e.OnlineCourseAccess="OnlineCourseAccess",e.SecretaryAccess="SecretaryAccess",e.SuperUser="SuperUser",e))(x||{});const ut=({studentGuid:e})=>{const[s,o]=C.useState(new Date().toISOString()),[g,c]=ge([ze.pendingAddVisit,Fe.peTeacher]),A=new Date(s),oe=[x.AdminAccess,x.SuperUser,x.SecretaryAccess].some(de=>c?.permissions?.includes(de)),j=(me(A,{start:ue(new Date,1),end:new Date})||oe)&&A.getDay()!==0&&A.getDay()!==1;C.useEffect(()=>{o(new Date().toISOString())},[e]);const ie=()=>{Me.addVisit({studentGuid:e,date:G(s,"numeric")})};return h.jsxs(we,{gap:"4px",ai:"flex-start",children:[h.jsx(be,{alertMessage:j?"":"Не допустимая дата",type:"date",setValue:o,value:s,hideCross:!0}),h.jsx(Ve,{isActive:j&&!g,text:`Добавить посещение ${G(s,"numeric")}`,onClick:ie,width:"100%",background:q.blue.main,textColor:q.white.main})]})},pt={None:"-",Basic:"Основная",SpecialA:"Специальная А",SpecialB:"Специальная Б",Preparatory:"Подготовительная",HealthLimitations:"ОВЗ",Disabled:"Инвалид"},ft={None:"-",Basketball:"Баскетбол",Volleyball:"Волейбол",Aerobics:"Аэробика",PowerLiftingAndCrossfit:"Пауэрлифтинг и кроссфит",StreetLiftingAndArmLifting:"Стритлифтинг и армлифтинг",GeneralPhysicalTraining:"ОФП",GeneralPhysicalTrainingGym:"ОФП (тренажерный зал)",FootRoom:"Футзал",SMG:"СМГ",TableTennis:"СМГ настольный теннис",NordicWalking:"СМГ скандинавская ходьба",InternalTeam:"Сборная"};export{ut as A,x as P,R as a,Ze as b,Qe as c,Xe as d,gt as e,Ye as f,ft as g,pt as h,et as i,Ge as j,Ce as k,ze as l,Me as m,rt as n,st as o,tt as p,at as q,nt as r,mt as s,ct as t,dt as u,it as v,ot as w,lt as x};
