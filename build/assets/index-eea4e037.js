import{s as f,K as I,cP as k,j as e,n as v,r as u,cN as U}from"./vendor-0433f525.js";import{l as _,P as w,m as K,n as A,A as Z,o as Q,p as F,s as X,e as Y,q as H,r as tt,t as et,u as it,v as st,w as nt,x as O,h as lt,g as ot}from"./student-9706f16e.js";import{r as T,Z as h,q as S,x as G,p as $,a2 as at,L as g,l as B,u as J,M as dt,h as R,G as M,z as rt,_ as y,a0 as ct,P as ut,a3 as mt,a1 as pt,a4 as xt,b as gt}from"./index-f22e44ea.js";const ft=f(T).withConfig({componentId:"sc-1qi5h46-0"})(["flex:1;"]),ht=f.div.withConfig({componentId:"sc-1qi5h46-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),St=I({and:[h.peTeacher,_.pendingRemoveVisit,(t,s)=>{var l;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Преподаватель",field:"teacherFullName"},...(l=t==null?void 0:t.permissions)!=null&&l.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(o,a)=>{const i=a,n=k(new Date(i.date),new Date)<-7,d=[w.AdminAccess,w.SuperUser].some(c=>{var r;return(r=t==null?void 0:t.permissions)==null?void 0:r.includes(c)});return i.teacherGuid===(t==null?void 0:t.id)&&!n||d?e.jsx(S,{width:"100%",text:"Удалить",isActive:!s,onClick:()=>{K.removeVisit({id:i.id.toString()})}}):null}}]:[]]}],or:{name:"$peStudentVisitsColumns",sid:"bwdu0h"}}),jt=()=>{var o;const[t,s,l]=v([A.$selectedStudent,St,h.peTeacher]);return t?e.jsxs(ht,{children:[!!((o=l==null?void 0:l.permissions)!=null&&o.length)&&e.jsx(Z,{studentGuid:t.studentGuid}),e.jsx(ft,{columns:s,data:t.visitsHistory})]}):null};var p=(t=>(t.Activist="Activist",t.Competition="Competition",t.ExternalFitness="ExternalFitness",t.GTO="GTO",t.InternalTeam="InternalTeam",t.OnlineWork="OnlineWork",t.Science="Science",t))(p||{});const D=[{id:p.Activist,title:"Активист"},{id:p.Competition,title:"Соревнование"},{id:p.GTO,title:"ГТО"},{id:p.InternalTeam,title:"Сборная"},{id:p.OnlineWork,title:"Работа в LMS"},{id:p.Science,title:"Научная работа"}],Ct=I({and:[h.peTeacher,Q.pendingRemoveAdditionPoints,(t,s)=>{var l;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Тип работ",field:"type",render:(o,a)=>{const i=D.find(({id:n})=>n===o);return(i==null?void 0:i.id)===p.Competition?a.comment:i==null?void 0:i.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five",render:(o,a)=>{const i=D.find(({id:n})=>n===a.workType);return(i==null?void 0:i.id)!==p.Competition?a.comment:null}},...(l=t==null?void 0:t.permissions)!=null&&l.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(o,a)=>{const i=a,n=k(new Date(i.date),new Date)<-7,d=[w.AdminAccess,w.SuperUser].some(c=>{var r;return(r=t==null?void 0:t.permissions)==null?void 0:r.includes(c)});return i.teacherGuid===(t==null?void 0:t.id)&&!n||d?e.jsx(S,{width:"100%",text:"Удалить",isActive:!s,onClick:()=>F.removeAdditionPoints({id:i.id.toString()})}):null}}]:[]]}],or:{name:"$additionalPointsColumns",sid:"cv7zhj"}}),bt=f.div.withConfig({componentId:"sc-xw90or-0"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),vt=()=>{const[t,s]=v([A.$selectedStudent,X.$competitions]),[l,o]=u.useState(null),[a,i]=u.useState(new Date().toISOString()),[n,d]=u.useState(null),[c,r]=u.useState("0"),[j,P]=u.useState(""),z=()=>{F.addAdditionPoints({comment:(n==null?void 0:n.id)===p.Competition?(l==null?void 0:l.title)??"":j,date:B(a,"numeric"),points:Number(c),studentGuid:t==null?void 0:t.studentGuid,type:n==null?void 0:n.id})};u.useEffect(()=>{Y.load()},[]),u.useEffect(()=>{(n==null?void 0:n.id)===p.Competition&&c==="0"&&r("5"),(n==null?void 0:n.id)===p.InternalTeam&&c==="0"&&r("50")},[n==null?void 0:n.id]);const E=new Date(a),V=E.getDay()!==0&&E.getDay()!==1,q=s.map(N=>({id:N,title:N}));return e.jsxs(bt,{children:[e.jsx(G,{width:"100%",size:"big",title:"Тип работ",items:D,selected:n,setSelected:d}),(n==null?void 0:n.id)===p.Competition&&e.jsx(G,{width:"100%",size:"big",title:"Соревнование",items:q,selected:l,setSelected:o}),e.jsx($,{alertMessage:V?"":"Не допустимая дата",size:"big",title:"Дата",setValue:i,value:a,type:"date"}),e.jsx($,{width:"100%",size:"big",title:"Количество баллов",setValue:r,value:c,type:"number",stepSize:1,minValue:1}),(n==null?void 0:n.id)!==p.Competition&&e.jsx(at,{width:"100%",setValue:P,value:j,title:"Комментарий"}),e.jsx(S,{isActive:V,text:"Добавить",onClick:z,background:g.blue.main,textColor:g.white.main,width:"100%"})]})},Pt=f.div.withConfig({componentId:"sc-19i0iom-0"})(["display:flex;flex-direction:column;height:100%;gap:10px;"]),At=f(T).withConfig({componentId:"sc-19i0iom-1"})(["flex:1;"]),wt=()=>{var i;const[t,s,l]=v([A.$selectedStudent,Ct,h.peTeacher]),{open:o}=J(),a=()=>{o(e.jsx(vt,{}),"Дополнительные баллы")};return t?e.jsxs(Pt,{children:[!!((i=l==null?void 0:l.permissions)!=null&&i.length)&&e.jsx(S,{text:"Добавить дополнительные баллы",onClick:a,background:g.blue.main,textColor:g.white.main}),e.jsx(At,{columns:s,data:t.pointsHistory})]}):null};var x=(t=>(t.FlexionAndExtensionOfArms="FlexionAndExtensionOfArms",t.JumpingRopeJumps="JumpingRopeJumps",t.Jumps="Jumps",t.PullUps="PullUps",t.ShuttleRun="ShuttleRun",t.Squats="Squats",t.Tilts="Tilts",t.TorsoLifts="TorsoLifts",t.Other="Other",t))(x||{});const W=[{id:x.FlexionAndExtensionOfArms,title:"Сгибание и разгибание рук"},{id:x.JumpingRopeJumps,title:"Прыжки со скакалкой"},{id:x.Jumps,title:"Прыжок в длину"},{id:x.PullUps,title:"Подтягивания(Вис)"},{id:x.ShuttleRun,title:"Челночный бег"},{id:x.Squats,title:"Приседания"},{id:x.Tilts,title:"Наклон"},{id:x.TorsoLifts,title:"Подъемы туловища"},{id:x.Other,title:"Другое"}],$t=f.div.withConfig({componentId:"sc-uipy8z-0"})(["display:flex;flex-direction:column;align-items:center;gap:10px;height:100%;"]),Gt=()=>{const t=v(A.$selectedStudent),[s,l]=u.useState(new Date().toISOString()),[o,a]=u.useState(null),[i,n]=u.useState("0"),[d,c]=u.useState(""),r=()=>{H.addRegulationPoints({date:B(s,"numeric"),points:Number(i),studentGuid:t==null?void 0:t.studentGuid,type:o==null?void 0:o.id,comment:(o==null?void 0:o.id)===x.Other?d??"":""})},j=new Date(s),P=j.getDay()!==0&&j.getDay()!==1;return e.jsxs($t,{children:[e.jsx(G,{width:"100%",size:"big",title:"Тип работ",items:W,selected:o,setSelected:a}),(o==null?void 0:o.id)===x.Other&&e.jsx($,{width:"100%",size:"big",title:"Комментарий",setValue:c,value:d}),e.jsx($,{alertMessage:P?"":"Не допустимая дата",size:"big",title:"Дата",setValue:l,value:s,type:"date",width:"100%"}),e.jsx($,{width:"100%",size:"big",title:"Количество баллов",setValue:n,value:i,type:"number",stepSize:1,minValue:1}),e.jsx(S,{text:"Добавить",isActive:P,onClick:r,background:g.blue.main,textColor:g.white.main,width:"100%"})]})},zt=f(T).withConfig({componentId:"sc-4mpo2k-0"})(["flex:1;"]),Dt=f.div.withConfig({componentId:"sc-4mpo2k-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),It=I({and:[h.peTeacher,tt.pendingRemoveRegulationPoints,(t,s)=>{var l;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Норматив",field:"type",render:(o,a)=>{var i;return o===x.Other?a.comment:(i=W.find(({id:n})=>n===o))==null?void 0:i.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five"},...(l=t==null?void 0:t.permissions)!=null&&l.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(o,a)=>{const i=a,n=k(new Date(i.date),new Date)<-30,d=[w.AdminAccess,w.SuperUser].some(c=>{var r;return(r=t==null?void 0:t.permissions)==null?void 0:r.includes(c)});return i.teacherGuid===(t==null?void 0:t.id)&&!n||d?e.jsx(S,{width:"100%",text:"Удалить",isActive:!s,onClick:()=>H.removeRegulationPoints({id:i.id.toString()})}):null}}]:[]]}],or:{name:"$regularPointsColumns",sid:"levsbz"}}),kt=()=>{var d;const[t,s,l]=v([A.$selectedStudent,It,h.peTeacher]),{open:o}=J(),a=t==null?void 0:t.totalPoints,i=()=>{o(e.jsx(Gt,{}),"Добавить норматив")},n=Number(a)<20;return t?e.jsxs(Dt,{children:[!t&&n&&e.jsx(dt,{type:"alert",children:"Чтобы добавить норматив, у студента должно быть хотя бы 20 баллов"}),!!((d=l==null?void 0:l.permissions)!=null&&d.length)&&e.jsx(S,{text:"Добавить норматив",onClick:i,background:g.blue.main,textColor:g.white.main,isActive:!n}),e.jsx(zt,{data:t.standardsHistory,columns:s})]}):null},L=[{title:"Посещения",content:e.jsx(jt,{})},{title:"Нормативы ",content:e.jsx(kt,{})},{title:"Дополнительные баллы ",content:e.jsx(wt,{})}],C=({label:t,value:s})=>e.jsxs(Tt,{children:[e.jsx(R,{size:3,children:t}),e.jsx(Et,{children:s})]}),Tt=f.div.withConfig({componentId:"sc-bzc523-0"})(["display:flex;flex-direction:column;align-items:center;row-gap:4px;border-radius:4px;padding:12px;background-color:var(--theme-2);flex:1;"]),Et=f.span.withConfig({componentId:"sc-bzc523-1"})([""]),Vt=f.div.withConfig({componentId:"sc-1i85cbe-0"})(["margin-top:auto;width:100%;"]),b=[{id:"None",title:"-"},{id:"Basic",title:"Основная"},{id:"Preparatory",title:"Подготовительная"},{id:"SpecialA",title:"Специальная А"},{id:"SpecialB",title:"Специальная Б"},{id:"HealthLimitations",title:"ОВЗ"},{id:"Disabled",title:"Инвалид"}],Nt={None:b[0],Basic:b[1],Preparatory:b[2],SpecialA:b[3],SpecialB:b[4],HealthLimitations:b[5],Disabled:b[6]},Ot=({studentGuid:t,healthGroup:s})=>{const[l,o]=u.useState(Nt[s]),a=v(et.pendingSetHealthGroup),i=()=>{it.setHealthGroup({studentGuid:t,healthGroup:l.id})};return e.jsxs(M,{gap:"4px",ai:"flex-start",children:[e.jsx(G,{isActive:!a,size:"big",width:"100%",title:"Группа здоровья",items:b,selected:l,setSelected:o}),e.jsx(Vt,{children:e.jsx(S,{isActive:!a,text:"Сменить группу здоровья",width:"100%",onClick:i,background:g.blue.main,textColor:g.white.main})})]})},yt=f.div.withConfig({componentId:"sc-jh5rb1-0"})(["margin-top:auto;width:100%;"]),m=[{id:"None",title:"-"},{id:"Basketball",title:"Баскетбол"},{id:"Volleyball",title:"Волейбол"},{id:"Aerobics",title:"Аэробика"},{id:"PowerLiftingAndCrossfit",title:"Пауэрлифтинг и кроссфит"},{id:"StreetLiftingAndArmLifting",title:"Стритлифтинг и армлифтинг"},{id:"GeneralPhysicalTraining",title:"ОФП"},{id:"GeneralPhysicalTrainingGym",title:"ОФП (тренажерный зал)"},{id:"FootRoom",title:"Футзал"},{id:"SMG",title:"СМГ"},{id:"TableTennis",title:"СМГ настольный теннис"},{id:"NordicWalking",title:"СМГ скандинавская ходьба"},{id:"InternalTeam",title:"Сборная"}],Lt={None:m[0],Basketball:m[1],Volleyball:m[2],Aerobics:m[3],PowerLiftingAndCrossfit:m[4],StreetLiftingAndArmLifting:m[5],GeneralPhysicalTraining:m[6],GeneralPhysicalTrainingGym:m[7],FootRoom:m[8],SMG:m[9],TableTennis:m[10],NordicWalking:m[11],InternalTeam:m[12]},Ft=({studentGuid:t,specialization:s})=>{const[l,o]=u.useState(Lt[s]),[a]=v([st.pendingSetSpecialization]),i=()=>{nt.setSpecialization({studentGuid:t,specialization:l.id})};return e.jsxs(M,{gap:"4px",ai:"flex-start",children:[e.jsx(G,{isActive:!a,size:"big",width:"100%",title:"Специализация",items:m,selected:l,setSelected:o}),e.jsx(yt,{children:e.jsx(S,{isActive:!a,text:"Сменить специализацию",width:"100%",onClick:i,background:g.blue.main,textColor:g.white.main})})]})},Rt=()=>{var j,P,z;const{studentId:t}=U(),[s,{currentUser:l},o,a,i,n]=v([A.$selectedStudent,gt.user,h.isLoading,A.$loading,h.peTeacher,h.unavailable]),d=(l==null?void 0:l.user_status)==="staff"?t:(l==null?void 0:l.guid)??"",[c,r]=u.useState(0);return u.useEffect(()=>(O.setCurrentStudentId(d),rt.load(),()=>O.resetStudentId()),[d]),n?e.jsx(y,{text:"Сервис временно недоступен. Попробуйте позже"}):!s&&d&&!o&&!a?e.jsx(y,{text:"Нет данных"}):s?e.jsx(ct,{padding:"10px",children:e.jsxs(ut,{children:[e.jsx(R,{size:3,align:"left",children:s.fullName}),e.jsxs(mt,{children:[e.jsx(C,{label:"Группа",value:s.groupNumber}),e.jsx(C,{label:"Баллы",value:s.totalPoints.toString()}),e.jsx(C,{label:"Курс",value:s.course.toString()}),e.jsx(C,{label:"ЛМС",value:s.lmsPoints.toString()}),e.jsx(C,{label:"Куратор",value:((j=s.curator)==null?void 0:j.fullName)??"-"}),e.jsx(C,{label:"Группа здоровья",value:s.healthGroup==="None"?"-":`${lt[s.healthGroup]} (${((P=s.healthGroupTeacher)==null?void 0:P.fullName)??""})`}),e.jsx(C,{label:"Специализация",value:ot[s.specialization]}),e.jsx(C,{label:"Долг",value:s.hasDebt?"Есть":"Нет"})]}),!!((z=i==null?void 0:i.permissions)!=null&&z.length)&&e.jsxs(e.Fragment,{children:[e.jsx(Ft,{studentGuid:s.studentGuid,specialization:s.specialization}),e.jsx(Ot,{studentGuid:s.studentGuid,healthGroup:s.healthGroup})]}),e.jsx(pt,{appearance:!1,pages:L,currentPage:c,setCurrentPage:r}),e.jsx(xt,{children:L[c].content})]})}):null};export{Rt as default};
