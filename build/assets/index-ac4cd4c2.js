import{s as x,K as I,cM as E,j as t,n as b,r as c,cN as W}from"./vendor-249420f4.js";import{l as q,P as A,m as K,n as w,A as Q,o as X,p as O,s as Y,e as Z,q as L,r as ee,t as te,u as ie,v as ne,w as se,x as N,h as le,g as oe}from"./student-a9c846d8.js";import{h as V,H as C,B as g,m as D,d as G,Q as de,t as h,l as F,u as H,M as B,T as J,r as R,o as ae,R as re,J as ue,N as ce,U as pe,O as me,V as ve,s as he}from"./index-72b1dbf4.js";const xe=x(V).withConfig({componentId:"sc-1qi5h46-0"})(["flex:1;"]),ge=x.div.withConfig({componentId:"sc-1qi5h46-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),fe=I({and:[C.peTeacher,q.pendingRemoveVisit,(e,o)=>{var d;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Преподаватель",field:"teacherFullName"},...e!=null&&(d=e.permissions)!==null&&d!==void 0&&d.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(l,n)=>{const i=n,s=E(new Date(i.date),new Date)<-7,r=[A.AdminAccess,A.SuperUser].some(u=>{var a;return e==null||(a=e.permissions)===null||a===void 0?void 0:a.includes(u)});return i.teacherGuid===(e==null?void 0:e.id)&&!s||r?t.jsx(g,{width:"100%",text:"Удалить",isActive:!o,onClick:()=>{K.removeVisit({id:i.id.toString()})}}):null}}]:[]]}],or:{name:"$peStudentVisitsColumns",sid:"bwdu0h"}}),Se=()=>{var e;const[o,d,l]=b([w.$selectedStudent,fe,C.peTeacher]);return o?t.jsxs(ge,{children:[!!(l!=null&&(e=l.permissions)!==null&&e!==void 0&&e.length)&&t.jsx(Q,{studentGuid:o.studentGuid}),t.jsx(xe,{columns:d,data:o.visitsHistory})]}):null};var m=(e=>(e.Activist="Activist",e.Competition="Competition",e.ExternalFitness="ExternalFitness",e.GTO="GTO",e.InternalTeam="InternalTeam",e.OnlineWork="OnlineWork",e.Science="Science",e))(m||{});const z=[{id:m.Activist,title:"Активист"},{id:m.Competition,title:"Соревнование"},{id:m.GTO,title:"ГТО"},{id:m.InternalTeam,title:"Сборная"},{id:m.OnlineWork,title:"Работа в LMS"},{id:m.Science,title:"Научная работа"}],je=I({and:[C.peTeacher,X.pendingRemoveAdditionPoints,(e,o)=>{var d;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Тип работ",field:"type",render:(l,n)=>{const i=z.find(({id:s})=>s===l);return(i==null?void 0:i.id)===m.Competition?n.comment:i==null?void 0:i.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five",render:(l,n)=>{const i=z.find(({id:s})=>s===n.workType);return(i==null?void 0:i.id)!==m.Competition?n.comment:null}},...e!=null&&(d=e.permissions)!==null&&d!==void 0&&d.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(l,n)=>{const i=n,s=E(new Date(i.date),new Date)<-7,r=[A.AdminAccess,A.SuperUser].some(u=>{var a;return e==null||(a=e.permissions)===null||a===void 0?void 0:a.includes(u)});return i.teacherGuid===(e==null?void 0:e.id)&&!s||r?t.jsx(g,{width:"100%",text:"Удалить",isActive:!o,onClick:()=>O.removeAdditionPoints({id:i.id.toString()})}):null}}]:[]]}],or:{name:"$additionalPointsColumns",sid:"cv7zhj"}}),Ce=x.div.withConfig({componentId:"sc-xw90or-0"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),be=()=>{const[e,o]=b([w.$selectedStudent,Y.$competitions]),[d,l]=c.useState(null),[n,i]=c.useState(new Date().toISOString()),[s,r]=c.useState(null),[u,a]=c.useState("0"),[f,$]=c.useState(""),k=()=>{var y;O.addAdditionPoints({comment:(s==null?void 0:s.id)===m.Competition?(y=d==null?void 0:d.title)!=null?y:"":f,date:F(n,"numeric"),points:Number(u),studentGuid:e==null?void 0:e.studentGuid,type:s==null?void 0:s.id})};c.useEffect(()=>{Z.load()},[]),c.useEffect(()=>{(s==null?void 0:s.id)===m.Competition&&u==="0"&&a("5"),(s==null?void 0:s.id)===m.InternalTeam&&u==="0"&&a("50")},[s==null?void 0:s.id]);const P=new Date(n),T=P.getDay()!==0&&P.getDay()!==1,M=o.map(y=>({id:y,title:y}));return t.jsxs(Ce,{children:[t.jsx(D,{width:"100%",size:"big",title:"Тип работ",items:z,selected:s,setSelected:r}),(s==null?void 0:s.id)===m.Competition&&t.jsx(D,{width:"100%",size:"big",title:"Соревнование",items:M,selected:d,setSelected:l}),t.jsx(G,{alertMessage:T?"":"Не допустимая дата",size:"big",title:"Дата",setValue:i,value:n,type:"date"}),t.jsx(G,{width:"100%",size:"big",title:"Количество баллов",setValue:a,value:u,type:"number",stepSize:1,minValue:1}),(s==null?void 0:s.id)!==m.Competition&&t.jsx(de,{width:"100%",setValue:$,value:f,title:"Комментарий"}),t.jsx(g,{isActive:T,text:"Добавить",onClick:k,background:h.blue.main,textColor:h.white.main,width:"100%"})]})},we=x.div.withConfig({componentId:"sc-19i0iom-0"})(["display:flex;flex-direction:column;height:100%;gap:10px;"]),$e=x(V).withConfig({componentId:"sc-19i0iom-1"})(["flex:1;"]),Ae=()=>{var e;const[o,d,l]=b([w.$selectedStudent,je,C.peTeacher]),{open:n}=H(),i=()=>{n(t.jsx(be,{}),"Дополнительные баллы")};return o?t.jsxs(we,{children:[!!(l!=null&&(e=l.permissions)!==null&&e!==void 0&&e.length)&&t.jsx(g,{text:"Добавить дополнительные баллы",onClick:i,background:h.blue.main,textColor:h.white.main}),t.jsx($e,{columns:d,data:o.pointsHistory})]}):null};var v=(e=>(e.FlexionAndExtensionOfArms="FlexionAndExtensionOfArms",e.JumpingRopeJumps="JumpingRopeJumps",e.Jumps="Jumps",e.PullUps="PullUps",e.ShuttleRun="ShuttleRun",e.Squats="Squats",e.Tilts="Tilts",e.TorsoLifts="TorsoLifts",e.Other="Other",e))(v||{});const U=[{id:v.FlexionAndExtensionOfArms,title:"Сгибание и разгибание рук"},{id:v.JumpingRopeJumps,title:"Прыжки со скакалкой"},{id:v.Jumps,title:"Прыжок в длину"},{id:v.PullUps,title:"Подтягивания(Вис)"},{id:v.ShuttleRun,title:"Челночный бег"},{id:v.Squats,title:"Приседания"},{id:v.Tilts,title:"Наклон"},{id:v.TorsoLifts,title:"Подъемы туловища"},{id:v.Other,title:"Другое"}],Pe=x.div.withConfig({componentId:"sc-uipy8z-0"})(["display:flex;flex-direction:column;align-items:center;gap:10px;height:100%;"]),Te=()=>{const e=b(w.$selectedStudent),[o,d]=c.useState(new Date().toISOString()),[l,n]=c.useState(null),[i,s]=c.useState("0"),[r,u]=c.useState(""),a=()=>{L.addRegulationPoints({date:F(o,"numeric"),points:Number(i),studentGuid:e==null?void 0:e.studentGuid,type:l==null?void 0:l.id,comment:(l==null?void 0:l.id)===v.Other&&r!=null?r:""})},f=new Date(o),$=f.getDay()!==0&&f.getDay()!==1;return t.jsxs(Pe,{children:[t.jsx(D,{width:"100%",size:"big",title:"Тип работ",items:U,selected:l,setSelected:n}),(l==null?void 0:l.id)===v.Other&&t.jsx(G,{width:"100%",size:"big",title:"Комментарий",setValue:u,value:r}),t.jsx(G,{alertMessage:$?"":"Не допустимая дата",size:"big",title:"Дата",setValue:d,value:o,type:"date",width:"100%"}),t.jsx(G,{width:"100%",size:"big",title:"Количество баллов",setValue:s,value:i,type:"number",stepSize:1,minValue:1}),t.jsx(g,{text:"Добавить",isActive:$,onClick:a,background:h.blue.main,textColor:h.white.main,width:"100%"})]})},ye=x(V).withConfig({componentId:"sc-4mpo2k-0"})(["flex:1;"]),Ge=x.div.withConfig({componentId:"sc-4mpo2k-1"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),De=I({and:[C.peTeacher,ee.pendingRemoveRegulationPoints,(e,o)=>{var d;return[{title:"Дата",field:"date",type:"date",sort:!0},{title:"Норматив",field:"type",render:(l,n)=>{var i;return l===v.Other?n.comment:(i=U.find(({id:s})=>s===l))===null||i===void 0?void 0:i.title}},{title:"Количество баллов",field:"points"},{title:"Преподаватель",field:"teacherFullName"},{title:"Комментарий",field:"comment",priority:"five"},...e!=null&&(d=e.permissions)!==null&&d!==void 0&&d.length?[{title:"Действия",field:"actions",onClick:()=>null,render:(l,n)=>{const i=n,s=E(new Date(i.date),new Date)<-30,r=[A.AdminAccess,A.SuperUser].some(u=>{var a;return e==null||(a=e.permissions)===null||a===void 0?void 0:a.includes(u)});return i.teacherGuid===(e==null?void 0:e.id)&&!s||r?t.jsx(g,{width:"100%",text:"Удалить",isActive:!o,onClick:()=>L.removeRegulationPoints({id:i.id.toString()})}):null}}]:[]]}],or:{name:"$regularPointsColumns",sid:"levsbz"}}),ke=()=>{var e;const[o,d,l]=b([w.$selectedStudent,De,C.peTeacher]),{open:n}=H(),i=o==null?void 0:o.totalPoints,s=()=>{n(t.jsx(Te,{}),"Добавить норматив")},r=Number(i)<20;return o?t.jsxs(Ge,{children:[!o&&r&&t.jsx(B,{type:"alert",children:"Чтобы добавить норматив, у студента должно быть хотя бы 20 баллов"}),!!(l!=null&&(e=l.permissions)!==null&&e!==void 0&&e.length)&&t.jsx(g,{text:"Добавить норматив",onClick:s,background:h.blue.main,textColor:h.white.main,isActive:!r}),t.jsx(ye,{data:o.standardsHistory,columns:d})]}):null},_=[{title:"Посещения",content:t.jsx(Se,{})},{title:"Нормативы ",content:t.jsx(ke,{})},{title:"Дополнительные баллы ",content:t.jsx(Ae,{})}],S=({label:e,value:o})=>t.jsxs(ze,{children:[t.jsx(J,{size:3,children:e}),t.jsx(Ie,{children:o})]}),ze=x.div.withConfig({componentId:"sc-bzc523-0"})(["display:flex;flex-direction:column;align-items:center;row-gap:4px;border-radius:4px;padding:12px;background-color:var(--theme-2);flex:1;"]),Ie=x.span.withConfig({componentId:"sc-bzc523-1"})([""]),Ee=x.div.withConfig({componentId:"sc-1i85cbe-0"})(["margin-top:auto;width:100%;"]),j=[{id:"None",title:"-"},{id:"Basic",title:"Основная"},{id:"Preparatory",title:"Подготовительная"},{id:"SpecialA",title:"Специальная А"},{id:"SpecialB",title:"Специальная Б"},{id:"HealthLimitations",title:"ОВЗ"},{id:"Disabled",title:"Инвалид"}],Ve={None:j[0],Basic:j[1],Preparatory:j[2],SpecialA:j[3],SpecialB:j[4],HealthLimitations:j[5],Disabled:j[6]},Ne=({studentGuid:e,healthGroup:o})=>{const[d,l]=c.useState(Ve[o]),n=b(te.pendingSetHealthGroup),i=()=>{ie.setHealthGroup({studentGuid:e,healthGroup:d.id})};return t.jsxs(R,{gap:"4px",ai:"flex-start",children:[t.jsx(D,{isActive:!n,size:"big",width:"100%",title:"Группа здоровья",items:j,selected:d,setSelected:l}),t.jsx(Ee,{children:t.jsx(g,{isActive:!n,text:"Сменить группу здоровья",width:"100%",onClick:i,background:h.blue.main,textColor:h.white.main})})]})},_e=x.div.withConfig({componentId:"sc-jh5rb1-0"})(["margin-top:auto;width:100%;"]),p=[{id:"None",title:"-"},{id:"Basketball",title:"Баскетбол"},{id:"Volleyball",title:"Волейбол"},{id:"Aerobics",title:"Аэробика"},{id:"PowerLiftingAndCrossfit",title:"Пауэрлифтинг и кроссфит"},{id:"StreetLiftingAndArmLifting",title:"Стритлифтинг и армлифтинг"},{id:"GeneralPhysicalTraining",title:"ОФП"},{id:"GeneralPhysicalTrainingGym",title:"ОФП (тренажерный зал)"},{id:"FootRoom",title:"Футзал"},{id:"SMG",title:"СМГ"},{id:"TableTennis",title:"СМГ настольный теннис"},{id:"NordicWalking",title:"СМГ скандинавская ходьба"},{id:"InternalTeam",title:"Сборная"}],Oe={None:p[0],Basketball:p[1],Volleyball:p[2],Aerobics:p[3],PowerLiftingAndCrossfit:p[4],StreetLiftingAndArmLifting:p[5],GeneralPhysicalTraining:p[6],GeneralPhysicalTrainingGym:p[7],FootRoom:p[8],SMG:p[9],TableTennis:p[10],NordicWalking:p[11],InternalTeam:p[12]},Le=({studentGuid:e,specialization:o})=>{const[d,l]=c.useState(Oe[o]),[n]=b([ne.pendingSetSpecialization]),i=()=>{se.setSpecialization({studentGuid:e,specialization:d.id})};return t.jsxs(R,{gap:"4px",ai:"flex-start",children:[t.jsx(D,{isActive:!n,size:"big",width:"100%",title:"Специализация",items:p,selected:d,setSelected:l}),t.jsx(_e,{children:t.jsx(g,{isActive:!n,text:"Сменить специализацию",width:"100%",onClick:i,background:h.blue.main,textColor:h.white.main})})]})},Je=()=>{var k,P,T;var e,o,d;const{studentId:l}=W(),[n,{currentUser:i},s,r,u]=b([w.$selectedStudent,he.user,C.isLoading,w.$loading,C.peTeacher]),a=(i==null?void 0:i.user_status)==="staff"?l:(k=i==null?void 0:i.guid)!=null?k:"",[f,$]=c.useState(0);return c.useEffect(()=>(N.setCurrentStudentId(a),ae.load(),()=>N.resetStudentId()),[a]),!n&&a&&!s&&!r?t.jsx(re,{text:"Нет данных"}):n?t.jsx(ue,{padding:"10px",children:t.jsxs(ce,{children:[(i==null?void 0:i.user_status)==="stud"&&t.jsxs(B,{type:"info",children:[t.jsx("p",{children:"Баллы, выставленные за посещаемость занятий по физической культуре в течение семестра, находятся у преподавателей кафедры «Физическое воспитание»."}),t.jsx("p",{children:"В случае возникновения вопросов можно обратиться к ведущему преподавателю."})]}),t.jsx(J,{size:3,align:"left",children:n.fullName}),t.jsxs(pe,{children:[t.jsx(S,{label:"Группа",value:n.groupNumber}),t.jsx(S,{label:"Баллы",value:n.totalPoints.toString()}),t.jsx(S,{label:"Курс",value:n.course.toString()}),t.jsx(S,{label:"ЛМС",value:n.lmsPoints.toString()}),t.jsx(S,{label:"Куратор",value:(P=(e=n.curator)===null||e===void 0?void 0:e.fullName)!=null?P:"-"}),t.jsx(S,{label:"Группа здоровья",value:n.healthGroup==="None"?"-":`${le[n.healthGroup]} (${(T=(o=n.healthGroupTeacher)===null||o===void 0?void 0:o.fullName)!=null?T:""})`}),t.jsx(S,{label:"Специализация",value:oe[n.specialization]}),t.jsx(S,{label:"Долг",value:n.hasDebt?"Есть":"Нет"})]}),!!(u!=null&&(d=u.permissions)!==null&&d!==void 0&&d.length)&&t.jsxs(t.Fragment,{children:[t.jsx(Le,{studentGuid:n.studentGuid,specialization:n.specialization}),t.jsx(Ne,{studentGuid:n.studentGuid,healthGroup:n.healthGroup})]}),t.jsx(me,{appearance:!1,pages:_,currentPage:f,setCurrentPage:$}),t.jsx(ve,{children:_[f].content})]})}):null};export{Je as default};
