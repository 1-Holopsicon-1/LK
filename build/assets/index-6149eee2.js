var ie=Object.defineProperty,le=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var G=(e,t,i)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,c=(e,t)=>{for(var i in t||(t={}))se.call(t,i)&&G(e,i,t[i]);if(B)for(var i of B(t))oe.call(t,i)&&G(e,i,t[i]);return e},f=(e,t)=>le(e,re(t));import{p as K,e as Q,S as ne,h as ae,f as C,j as a,s as ue,r as m,a0 as ce}from"./vendor-31894644.js";import{$ as X,g as Y,b as de,f as V,d as fe,W as me,F as pe,h as he,M as ve,l as ge,I as g,i as xe,S as _e}from"./index-0f8b6250.js";const Ne=()=>X.get("?getCheckData&token=".concat(Y())),be=e=>{const t=new FormData;t.set("token",Y()),t.set("saveCheckData","1");for(const[i,l]of Object.entries(e))t.set(i,l);return X.post("?saveCheckData=1",t,{headers:{"Content-Type":"multipart/form-data"}})},J={teacherDataVerification:null,error:null,completed:!1},ye=()=>({data:C(A).teacherDataVerification,loading:C(F.pending),error:C(A).error,completed:C(A).completed}),Z=K({name:"postTeacherDataVerification",sid:"-jc1rtz"}),ee=K({name:"changeCompleted",sid:"6vr460"}),De=Q(async e=>{try{return(await be(e)).data}catch(t){throw new Error("Не удалось загрузить раздел")}},{name:"postTeacherDataVerificationFx",sid:"b8s0pe"});ne({from:Z,to:De});const F=Q(async()=>{try{return(await Ne()).data}catch(e){throw new Error("Не удалось войти")}},{name:"getTeacherDataVerificationFx",sid:"6736yk"}),A=ae(J,{name:"$teacherDataVerificationStore",sid:"-t2u8dj"}).on(F,e=>f(c({},e),{error:null})).on(F.doneData,(e,t)=>f(c({},e),{teacherDataVerification:t})).on(F.failData,(e,t)=>f(c({},e),{error:t.message})).on(ee,(e,t)=>f(c({},e),{completed:t.completed})).on(de.userGuid,()=>c({},J)),we={useTeacherDataVerification:ye},je={getTeacherDataVerificationFx:F},O={postTeacherDataVerification:Z,changeCompleted:ee},qe=e=>{let t,i,l,s,o;o=Math.floor(e/1e3),s=Math.floor(o/60),o=o%60,l=Math.floor(s/60),s=s%60,i=Math.floor(l/24),l=l%24,t=Math.floor(i/30),i=i%30;const n=Math.floor(t/12);return t=t%12,{year:n,month:t,day:i,hour:l,minute:s,second:o}},ke=(e,t)=>{const i=e.sex==="Мужской",l=qe(new Date().getTime()-new Date(e.bdate).getTime()).year;return{title:"Воинская служба",hint:a.jsxs(a.Fragment,{children:["При наличии документа о воинской службе необходимо загрузить скан-копию всех заполненных страниц документа воинского учета (военного билета или удостоверения гражданина, подлежащего призыву).",a.jsx("br",{}),a.jsx("br",{}),"Для иностранных работников - скан-копию страницы паспорта иностранного гражданина с серией и номером."]}),data:[],documents:{files:[],required:!0,checkboxCondition:"reverse",fieldName:"armyFiles",maxFiles:10},optionalCheckbox:{fieldName:"army_doc_none",title:"Документ о воинской службе отсутствует",value:l>=66?!0:!i&&(e==null?void 0:e.army_doc_none),required:!0,visible:!i||l>=66},confirmed:t}},Fe=(e,t)=>{var i,l,s,o,n;return{title:"Контактные данные",hint:"Личный мобильный телефон предоставляется только сотрудникам отдела кадров. Обязателен для заполнения. Рабочий мобильный телефон может быть предоставлен сотрудникам вуза для решения рабочих вопросов. Если рабочий мобильный телефон совпадает с личным - продублировать информацию в соответствующем поле. Служебный телефон (прямой/дополнительный) может быть опубликован в телефонном справочнике вуза. Личный E-mail предоставляется только сотрудникам отдела кадров. Обязателен для заполнения. Рабочий E-mail - это E-mail в домене mospolytech.ru.",data:[{fieldName:"tel_mob_private",title:"Мобильный телефон (личный)",type:"tel",value:(i=e==null?void 0:e.tel_mob_private)!=null?i:"",required:!0,mask:!0,autocomplete:!1},{fieldName:"tel_mob_staff",title:"Мобильный телефон (рабочий)",type:"tel",value:(l=e==null?void 0:e.tel_mob_staff)!=null?l:"",mask:!0,autocomplete:!1},{fieldName:"tel_staff",title:"Служебный телефон (прямой/дополнительный)",type:"tel",value:(s=e==null?void 0:e.tel_staff)!=null?s:"",autocomplete:!1},{fieldName:"email_private",title:"Личный e-mail",type:"email",value:(o=e==null?void 0:e.email_private)!=null?o:"",required:!0,autocomplete:!1},{fieldName:"email_staff",title:"Рабочий e-mail",type:"email",value:(n=e==null?void 0:e.email_staff)!=null?n:"",autocomplete:!1}],confirmed:t}},Ce=(e,t)=>({title:"Инвалидность",hint:"Необходимо приложить скан-копию справки об инвалидности",data:[],optionalCheckbox:{fieldName:"is_not_invalid",value:e==null?void 0:e.is_not_invalid,title:"Нет документа об инвалидности",required:!0},documents:{files:[],required:!0,checkboxCondition:"reverse",fieldName:"invalidFiles",maxFiles:1},confirmed:t}),Se=(e,t)=>({title:"Водительское удостоверение",hint:"При наличии водительского удостоверения необходимо загрузить скан-копию документа с обеих сторон",data:[],optionalCheckbox:{fieldName:"dr_lic_none",title:"Водительское удостоверение отсутствует",value:e.dr_lic_none,required:!0},documents:{files:[],required:!0,fieldName:"driveLicenseFiles",maxFiles:2},confirmed:t}),Ae=(e,t)=>{var i,l,s,o;return{title:"Образование",hint:"Необходимо приложить скан-копию документа об образовании (диплом, аттестат), подтверждающего изменения",data:[{fieldName:"edu_doc",title:"Вид документа",value:e==null?void 0:e.edu_doc,width:"100%"},{fieldName:"edu_level",title:"Уровень образования",value:e.edu_level,width:"100%"},{fieldName:"edu_org",title:"Учебное заведение",value:(i=e==null?void 0:e.edu_org)!=null?i:"",required:!0},{fieldName:"edu_spec",title:"Квалификация",value:(l=e==null?void 0:e.edu_spec)!=null?l:"",required:!0},{fieldName:"edu_doc_num",title:"Серия и номер",value:(s=e==null?void 0:e.edu_doc_num)!=null?s:"",required:!0},{fieldName:"edu_year",title:"Дата выдачи",value:(o=e==null?void 0:e.edu_year)!=null?o:"",type:"date",required:!1}],documents:{files:[],required:!0,fieldName:"educationFiles",maxFiles:5},confirmed:t}},T=[{id:"mother",title:"Мать"},{id:"father",title:"Отец"},{id:"wife",title:"Жена"},{id:"husband",title:"Муж"},{id:"sister",title:"Сестра"},{id:"brother",title:"Брат"},{id:"son",title:"Сын"},{id:"daughter",title:"Дочь"}],Te=(e,t)=>{var i,l;return{title:"Состав семьи",hint:"Необходимо указать актуальную информацию о ближайших родственниках",data:[...(l=(i=e.family)==null?void 0:i.map(s=>[{fieldName:"relation",title:"Степень родства",value:V(T,s.relation),type:"select",items:T,width:"100%"},{fieldName:"fio",title:"ФИО",value:s.fio,required:!0,width:"40%"},{fieldName:"bdate",title:"Дата рождения",value:s.bdate,type:"date",required:!0,width:"30%"}]))!=null?l:[]],default:[[{fieldName:"relation",title:"Степень родства",value:null,type:"select",items:T,width:"100%"},{fieldName:"fio",title:"ФИО",value:"",required:!0,width:"40%"},{fieldName:"bdate",title:"Дата рождения",value:"",type:"date",required:!0,width:"30%"}]],addNew:!0,optionalCheckbox:{fieldName:"family_none",title:"Близкие родственники отсутствуют",value:e.family_none,required:!0},confirmed:t}},H=e=>{switch(e){case"Мужской":return[{id:"single",title:"Холост"},{id:"married",title:"Женат"},{id:"divorced",title:"Разведен"},{id:"widow",title:"Вдовец"}];case"Женский":return[{id:"single",title:"Не замужем"},{id:"married",title:"Замужем"},{id:"divorced",title:"Разведена"},{id:"widow",title:"Вдова"}];default:return[{id:"single",title:"Холост/Не замужем"},{id:"married",title:"Женат/Замужем"},{id:"divorced",title:"Разведен/Разведена"},{id:"widow",title:"Вдовец/Вдова"}]}},Oe=(e,t)=>({title:"Семейное положение",hint:"Необходимо указать актуальную информацию",data:[{fieldName:"familyStatus",title:"",value:V(H(e.sex),e.familyStatus),type:"select",items:H(e.sex),width:"100%"}],confirmed:t}),S=[{id:"a",title:"Читаю и перевожу со словарем"},{id:"b",title:"Читаю и могу объясняться"},{id:"с",title:"Владею свободно"}],Ve=(e,t)=>{var i,l;return{title:"Знание иностранных языков",hint:"Необходимо указать иностранные языки и степень владения ими",data:[...(l=(i=e.languages)==null?void 0:i.map(s=>[{fieldName:"language",title:"Язык",required:!0,value:s.language},{fieldName:"level",title:"Уровень владения",value:V(S,s.level),type:"select",items:S,width:"100%"}]))!=null?l:[]],default:[[{fieldName:"language",title:"Язык",required:!0,value:"Английский"},{fieldName:"level",title:"Уровень владения",value:S[0],type:"select",items:S,width:"100%"}]],addNew:!0,confirmed:t}},Ee=(e,t)=>{var i,l;return{title:"Проживание",hint:"Необходимо указать фактический адрес проживания",data:[{fieldName:"loc_addr",title:"Адрес проживания",value:(i=e==null?void 0:e.loc_addr)!=null?i:"",required:!0},{fieldName:"loc_date",title:"Дата начала проживания",value:(l=e==null?void 0:e.loc_date)!=null?l:"",type:"date",required:!0}],optionalCheckbox:{fieldName:"loc_match_reg",title:"Адрес проживания совпадает с адресом регистрации",value:e.loc_match_reg,required:!0},confirmed:t}},Me=(e,t)=>{var i,l,s,o,n,r;return{title:"Паспортные данные",hint:"Необходимо приложить скан-копию 2 и 3 страницы паспорта РФ. Для иностранных работников - страницу паспорта иностранного гражданина с серией и номером и нотариальный перевод паспорта иностранного гражданина.",data:[{fieldName:"",title:"Вид документа",value:e==null?void 0:e.pass_type,width:"100%"},{fieldName:"pass_ser",title:"Серия",value:(i=e==null?void 0:e.pass_ser)!=null?i:"",required:!0},{fieldName:"pass_num",title:"Номер",value:(l=e==null?void 0:e.pass_num)!=null?l:"",required:!0},{fieldName:"pass_div",title:"Кем выдан",value:(s=e==null?void 0:e.pass_div)!=null?s:"",required:!0},{fieldName:"pass_date",title:"Дата выдачи",value:(o=e==null?void 0:e.pass_date)!=null?o:"",required:!0,type:"date"},{fieldName:"pass_div_code",title:"Код подразделения",value:(n=e==null?void 0:e.pass_div_code)!=null?n:"",required:!0},{fieldName:"pass_citizenship",title:"Гражданство",value:(r=e==null?void 0:e.pass_citizenship)!=null?r:"",required:!1}],documents:{files:[],required:!0,fieldName:"passportFiles",maxFiles:1},confirmed:t}},Le=(e,t)=>{var i,l,s,o;return{title:"Личные данные",hint:"Необходимо приложить скан-копию документа, подтверждающего изменения",data:[{fieldName:"fio",title:"ФИО",value:(i=e==null?void 0:e.fio)!=null?i:"",required:!0},{fieldName:"sex",title:"Пол",value:(l=e==null?void 0:e.sex)!=null?l:"",required:!0},{fieldName:"bdate",title:"Дата рождения",value:(s=e==null?void 0:e.bdate)!=null?s:"",required:!0,type:"date"},{fieldName:"bplace",title:"Место рождения",value:(o=e==null?void 0:e.bplace)!=null?o:"",required:!0}],documents:{files:[],required:!0,fieldName:"personalFiles",maxFiles:2},confirmed:t}},$e=(e,t)=>{var i,l;return{title:"Регистрация",hint:"Необходимо приложить скан-копию 5 страницы или последующих страниц с соответствующими штампами паспорта РФ. При отсутствии регистрации также прикладывается скан-копия. Для иностранных работников - необходимо приложить скан-копию документа о регистрации на территории РФ.",data:[{fieldName:"reg_addr",title:"Адрес регистрации",value:(i=e==null?void 0:e.reg_addr)!=null?i:"",required:!0},{fieldName:"reg_date",title:"Дата регистрации",value:(l=e==null?void 0:e.reg_date)!=null?l:"",type:"date",required:!0}],documents:{files:[],required:!0,fieldName:"registrationFiles",maxFiles:2},optionalCheckbox:{fieldName:"reg_none",title:"Регистрация отсутствует",value:!1},confirmed:t}},Ie=(e,t)=>{t(!0);const i=e.map(n=>{if(Array.isArray(n.data[0])){const r=n.data.map(h=>Object.assign({},...h==null?void 0:h.map(u=>{var x,k;const q={};return u!=null&&u.fieldName&&(q[u==null?void 0:u.fieldName]=(x=u==null?void 0:u.value)!=null&&x.title?(k=u==null?void 0:u.value)==null?void 0:k.title:u==null?void 0:u.value),q}))),p={},d=n.title=="Состав семьи"?"family":"langs";return p[d]=JSON.stringify(r),p}else return n.data.map(r=>{var d,h,u;const p={};return r!=null&&r.fieldName&&(p[(d=r==null?void 0:r.fieldName)!=null?d:""]=typeof r.value!="object"?r==null?void 0:r.value:(u=(h=r.value)==null?void 0:h.title)!=null?u:null),p})}).flat(),l=e.map(n=>{var p,d;const r={};if((p=n.documents)!=null&&p.fieldName)for(let h=0;h<n.documents.files.length;h++)r[((d=n.documents)==null?void 0:d.fieldName)+"[".concat(h,"]")]=n.documents.files[h];return r}),s=e.map(n=>{var p,d;const r={};return(p=n.optionalCheckbox)!=null&&p.fieldName&&(r[(d=n.optionalCheckbox)==null?void 0:d.fieldName]=n.optionalCheckbox.value),r}),o=Object.assign({},...i,...l,...s);try{O.postTeacherDataVerification(o),t(!1),O.changeCompleted({completed:!0})}catch(n){t(!1),fe.evokePopUpMessage({message:"Не удалось отправить форму. Ошибка: ".concat(n),type:"failure",time:3e4})}},Pe=ue.div.withConfig({componentId:"sc-1g5zkfe-0"})(["display:flex;align-items:flex-start;justify-content:center;width:100%;padding:10px;color:var(--text);.data-verification-block{width:100%;height:100%;max-width:600px;padding:20px;border-radius:var(--brLight);background:var(--block-content);box-shadow:var(--block-shadow);display:flex;flex-direction:column;row-gap:20px;}@media (max-width:1000px){padding:50px 0;.data-verification-block{box-shadow:none;}}"]),We=()=>{var W;const{data:e,error:t,completed:i}=we.useTeacherDataVerification(),[l,s]=m.useState(!1),[o,n]=m.useState(null),[r,p]=m.useState(null),[d,h]=m.useState(null),[u,q]=m.useState(null),[x,k]=m.useState(null),[_,E]=m.useState(null),[N,M]=m.useState(null),[b,L]=m.useState(null),[y,$]=m.useState(null),[D,I]=m.useState(null),[w,P]=m.useState(null),[j,z]=m.useState(null),v=!!(e!=null&&e.validated),[R,U]=m.useState(!1);return m.useEffect(()=>{U(!1)},[!!(j!=null&&j.confirmed),!!(y!=null&&y.confirmed),!!(o!=null&&o.confirmed),!!(w!=null&&w.confirmed),!!(b!=null&&b.confirmed),!!(_!=null&&_.confirmed),!!(x!=null&&x.confirmed),!!(u!=null&&u.confirmed),!!(r!=null&&r.confirmed),!!(D!=null&&D.confirmed),!!(N!=null&&N.confirmed),!!(d!=null&&d.confirmed)]),m.useEffect(()=>{e&&(n(Le(e,v)),h(Fe(e,v)),L(Me(e,v)),I($e(e,v)),P(Ee(e,v)),p(Oe(e,v)),q(Te(e,v)),E(Ae(e,v)),M(Ve(e,v)),$(Se(e,v)),k(Ce(e,v)),z(ke(e,v)))},[e]),a.jsx(me,{load:()=>je.getTeacherDataVerificationFx(),loading:!e,error:t,data:e,children:o&&d&&b&&D&&w&&r&&u&&_&&N&&y&&x&&j?a.jsx(Pe,{children:a.jsxs(pe,{children:[a.jsx(he,{size:3,align:"left",bottomGap:!0,children:"Подтвердите актуальность данных, указанных в каждом разделе анкеты, либо внесите изменения"}),a.jsx(ve,{type:"success",title:"Данные успешно отправлены ".concat(ge((W=e==null?void 0:e.valid_date)!=null?W:new Date)),icon:a.jsx(ce,{}),visible:v}),a.jsx(g,f(c({},o),{setData:n,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},d),{setData:h,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},b),{setData:L,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},D),{setData:I,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},w),{setData:P,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},r),{setData:p,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},u),{setData:q,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},_),{setData:E,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},N),{setData:M,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},y),{setData:$,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},x),{setData:k,divider:!0,defaultOpenArea:!1})),a.jsx(g,f(c({},j),{setData:z,divider:!0,defaultOpenArea:!1})),a.jsxs(a.Fragment,{children:[a.jsx(xe,{checked:R,setChecked:U,text:"Я подтверждаю корректность указанных данных"}),a.jsx(_e,{text:i?"Отправлено":"Отправить",action:()=>Ie([j,y,o,w,b,_,x,u,r,D,N,d],s),isLoading:l,completed:i,setCompleted:te=>O.changeCompleted({completed:te}),isDone:i,buttonSuccessText:"Отправлено",repeatable:!0,isActive:!!R,popUpFailureMessage:"Для отправки формы необходимо, чтобы все поля были подтверждены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})]})}):null})};export{We as default};
