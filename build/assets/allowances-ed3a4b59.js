import{j as t,a5 as x,q as f,r as d,cM as b,M as v}from"./vendor-48260ac4.js";import{aN as M,M as P,aw as o,G as u,x as w,r as A,aO as y,ap as F,b as S,P as g,V as E,q as O,ax as R,aP as L,aQ as k}from"./index-8b5dbbb6.js";import{F as $,D as N}from"./dev-mode-message-98d0ee52.js";const I=()=>[{title:"Дата",field:"createdAt",priority:"two",sort:!0,type:"date",align:"center",width:"120px"},{title:"Тип",field:"paymentIdentifier",priority:"three",width:"150px",showFull:!0,render:s=>s||"-"},{title:"Источник финансирования",field:"sourceOfFunding",showFull:!0,priority:"four",width:"150px",render:s=>s||"-"},{title:"Статус",field:"allowanceStatus",priority:"one",width:"165px",showFull:!0,catalogs:[...Object.values(M).map((s,n)=>({id:n.toString(),title:s}))??[]],render:s=>t.jsx(P,{type:s==="Completed"?"success":s==="Cancelled"?"failure":"alert",title:s||"—",align:"center",icon:null})},{title:"Комментарий",field:"commentary",render:s=>s||"-"},{title:"Файлы",field:"files",width:"100px",align:"center",showFull:!0,render:s=>s.application.length+s.other.length||"-"}],m=()=>{const s=x(),[n,i]=f([o.allowances,o.jobRoles]),[r,a]=d.useState(()=>{const e=i&&i.find(c=>c.roles.includes("Initiator"));return e?{id:e.employeeId,title:e.division}:null}),l=d.useMemo(()=>i?i.filter(e=>e.roles.includes("Approver")).map(e=>({id:e.employeeId,title:e.division})):[],[i]);return i?t.jsxs(u,{gap:"16px",d:"column",children:[l.length>1&&t.jsx(u,{d:"column",jc:"flex-start",ai:"flex-start",children:t.jsx(w,{items:i.filter(e=>e.roles.includes("Initiator")).map(e=>({id:e.employeeId,title:e.division})),selected:r,setSelected:a})}),t.jsx(A,{loading:!n,columns:I(),data:r&&n?n[r.id].initiatorAllowances:null,maxOnPage:7,onRowClick:e=>{s.push(y+`/${r==null?void 0:r.id}/initiator/${e.id}`)}})]}):null},j=()=>{const s=x(),[n,i]=f([o.allowances,o.jobRoles]),[r,a]=d.useState(()=>{const e=i&&i.find(c=>c.roles.includes("Approver"));return e?{id:e.employeeId,title:e.division}:null}),l=d.useMemo(()=>i?i.filter(e=>e.roles.includes("Approver")).map(e=>({id:e.employeeId,title:e.division})):[],[i]);return i?t.jsxs(u,{gap:"16px",d:"column",children:[l.length>1&&t.jsx(u,{d:"column",jc:"flex-start",ai:"flex-start",children:t.jsx(w,{items:l,selected:r,setSelected:a})}),t.jsx(A,{loading:!n,columns:I(),data:r&&n?n[r.id].approverAllowances:null,maxOnPage:7,onRowClick:e=>{s.push(y+`/${r==null?void 0:r.id}/approver/${e.id}`)}})]}):null},_=()=>{var h;const s=x(),{role:n}=b(),i=C=>{s.push(L+`/${C}`)},[r,a,l,e]=f([F.pageMounted,o.rolesPending,o.roles,S.user]),c=()=>{s.push(k)},p=(l.includes("Initiator")||l.includes("Approver"))&&((h=e==null?void 0:e.currentUser)==null?void 0:h.guid);return d.useEffect(()=>{p&&r()},[p]),a?t.jsx(g,{children:t.jsx(u,{w:"100%",jc:"center",ai:"center",children:t.jsx(E,{})})}):p?t.jsxs(g,{topRightCornerElement:l.includes("Initiator")&&t.jsx(O,{onClick:c,text:"Подать заявку",background:"var(--reallyBlue)",textColor:"#fff",icon:t.jsx(v,{}),minWidth:"35px",height:"36px",shrinkTextInMobile:!0}),children:[t.jsx(N,{}),l.length>1?t.jsx(R,{pages:[{id:"approver",title:"Согласование надбавок",content:t.jsx(j,{})},{id:"initiator",title:"Установление надбавок",content:t.jsx(m,{})}],currentPage:n==="initiator"?1:0,onChangePage:i,appearance:!1}):l[0]==="Initiator"?t.jsx(m,{}):t.jsx(j,{})]}):t.jsx($,{text:"У вас нет доступа к этому разделу"})};export{_ as default};
