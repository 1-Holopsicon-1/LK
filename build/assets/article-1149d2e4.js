var D=(e,t,s)=>new Promise((o,i)=>{var n=c=>{try{r(s.next(c))}catch(w){i(w)}},f=c=>{try{r(s.throw(c))}catch(w){i(w)}},r=c=>c.done?o(c.value):Promise.resolve(c.value).then(n,f);r((s=s.apply(e,t)).next())});import{j as I,b9 as M,p as l,h as u,e as Z,k as E,N as G,x as d,f as Q}from"./vendor-04d91f24.js";import{dm as H,dn as g,dp as J,p as j,dq as K,dr as X}from"./index-60431b6d.js";import{c as P}from"./create-checkbox-field-a524a89c.js";const ee=()=>[{title:"Название публикации",field:"articleTitle",width:"150px",showFull:!0,align:"center"},{title:"Авторы",field:"authors",width:"130px",showFull:!0,align:"center"},{title:"Год",field:"publicationYear",width:"100px",align:"center",sort:!0,search:!0},{title:"Издательство",field:"publisher",showFull:!0,align:"center",sort:!0,search:!0},{title:"Номер страницы",field:"pageNumber",width:"120px",render:e=>e||"-",showFull:!0,align:"center"},{title:"Scopus",field:"isScopus",width:"115px",align:"center",render:e=>e&&I.jsx(M,{}),sort:!0,search:!0},{title:"WoS",field:"isWoS",width:"110px",align:"center",render:e=>e&&I.jsx(M,{}),sort:!0,search:!0},{title:"Тип",showFull:!0,field:"publicationType",align:"center"},{title:"Количество цитирований",field:"quotesCount",showFull:!0,width:"165px",align:"center",sort:!0,search:!0},{title:"DOI",field:"doi",showFull:!0,align:"center"},{title:"Источник финансирования",field:"fundingSource",showFull:!0,width:"170px",align:"center"}],te={publicationYear:"PublicationYear",publisher:"SourceTitle",isScopus:"IsScopus",isWoS:"IsWoS",quotesCount:"QuotesCount"},se=30,a=l({name:"pageMounted",sid:"-nyvv9i"}),L=l({name:"tableOpened",sid:"-9d12pl"}),v=l({name:"modalOpened",sid:"-1o83cr"}),N=l({name:"setScopusFile",sid:"-bh0ron"}),Y=l({name:"setWosFile",sid:"-c50cvc"}),V=l({name:"uploadFiles",sid:"bzqn36"}),_=l({name:"selectArticle",sid:"92mkkj"}),z=l({name:"setColumns",sid:"eksrx7"}),le=l({name:"getArticles",sid:"z9fdq4"}),O=l({name:"fetchArticles",sid:"-jq4br7"}),U=l({name:"sortPressed",sid:"qkj2ye"}),k=l({name:"filtersApplied",sid:"-gztca8"}),A=l({name:"filtersReset",sid:"-78ambh"}),T=u(!1,{name:"$filtersApplied",sid:"-cy6sv"}).on(k,()=>!0).on(A,()=>!1).reset([a]),p=Z(o=>D(void 0,[o],function*({offset:e,sorts:t,filters:s}){return yield H({limit:se,offset:e,sorts:t?t.map(({field:i,order:n})=>({field:te[i],order:n})):null,filters:s})}),{name:"fetchArticlesFx",sid:"fo0r6b"}),S=g({reset:a}),b=g({reset:a}),C=g({reset:a}),F=g({reset:a}),x=P({reset:a}),$=P({reset:a}),h=E({sid:"pssul1",fn:()=>G({handler:J}),name:"uploadArticleMutation",method:"createMutation"}),m=u(null,{name:"$sorts",sid:"-npterm"}).on(U,(e,t)=>{if(!e)return[{field:t,order:"ASC"}];const s=e.find(i=>i.field===t),o=e.filter(i=>i.field!==t);return s?s.order==="ASC"?[...o,{field:t,order:"DESC"}]:o.length?o:null:[...e,{field:t,order:"ASC"}]}).reset(a),ie=u([],{name:"$articles",sid:"-p3q035"}).on(p.doneData,(e,{data:t})=>[...e,...t]).reset([m,k,A]),y=u(0,{name:"$totalCount",sid:"-yplae5"}).on(p.doneData,(e,{totalCount:t})=>t);d({and:[{clock:p.doneData,source:y,filter:(e,{totalCount:t})=>e!==t,fn:(e,{totalCount:t})=>t,target:y}],or:{sid:"-byl6hx"}});const oe=u(new Set,{name:"$selectedArticles",sid:"-ymt6xl"}).on(_,(e,t)=>{const s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s}).reset(a),ae=u([],{name:"$scopusFile",sid:"-dcqa4h"}).on(N,(e,t)=>t).reset([h.finished.success,v]),ne=u([],{name:"$wosFile",sid:"-3rupqm"}).on(Y,(e,t)=>t).reset(h.finished.success,v),re=u(!1,{name:"$filesUploaded",sid:"is0o9i"}).on(h.finished.success,()=>!0).reset(v),ce=u(ee(),{name:"$columns",sid:"9yu9hx"}).on(z,(e,t)=>t).reset(a);d({and:[{clock:L,fn:()=>({offset:0,sorts:null,filters:null}),target:p}],or:{sid:"kxgcev"}});d({and:[{clock:O,source:{pending:p.inFlight,filtersApplied:T,sorts:m,isWoSCheck:$.value,isScopusCheck:x.value,articleTitle:S.value,publicationYear:b.value,publisher:C.value,quotesCount:F.value},filter:({pending:e})=>!e,fn:({sorts:e,filtersApplied:t,isWoSCheck:s,isScopusCheck:o,articleTitle:i,publicationYear:n,publisher:f,quotesCount:r},{startIndex:c})=>({offset:c,sorts:e,filters:t?[...i?[{field:"ArticleTitle",operation:"Like",value:i}]:[],...s?[{field:"IsWoS",operation:"Eq",value:s}]:[],...o?[{field:"IsScopus",operation:"Eq",value:o}]:[],...n?[{field:"PublicationYear",operation:"Eq",value:Number(n)}]:[],...f?[{field:"SourceTitle",operation:"Like",value:f}]:[],...r?[{field:"QuotesCount",operation:"Eq",value:Number(r)}]:[]]:null}),target:p}],or:{sid:"ldy67p"}});d({and:[{clock:[m,k,A],source:{sorts:m,filtersApplied:T,isWoSCheck:$.value,isScopusCheck:x.value,articleTitle:S.value,publicationYear:b.value,publisher:C.value,quotesCount:F.value},fn:({sorts:e,filtersApplied:t,isWoSCheck:s,isScopusCheck:o,publicationYear:i,publisher:n,quotesCount:f,articleTitle:r})=>({offset:0,sorts:e,filters:t?[...r?[{field:"ArticleTitle",operation:"Like",value:r}]:[],...s?[{field:"IsWoS",operation:"Eq",value:s}]:[],...o?[{field:"IsScopus",operation:"Eq",value:o}]:[],...i?[{field:"PublicationYear",operation:"Eq",value:Number(i)}]:[],...n?[{field:"SourceTitle",operation:"Like",value:n}]:[],...f?[{field:"QuotesCount",operation:"Eq",value:Number(f)}]:[]]:null}),target:p}],or:{sid:"o87wkv"}});d({and:[{clock:V,target:h.start}],or:{sid:"-ygmdyh"}});d({and:[{clock:h.finished.success,fn:()=>({message:"Статья успешно загружена",type:"success"}),target:j.evokePopUpMessage}],or:{sid:"-yef7l1"}});d({and:[{clock:h.finished.failure,fn:()=>({message:"Произошла ошибка",type:"failure"}),target:j.evokePopUpMessage}],or:{sid:"-xyh6dk"}});const he={articles:ie,articlesLoading:p.inFlight,totalCount:y,selectedArticles:oe,filesUploaded:re,scopusFile:ae,wosFile:ne,uploadLoading:h.$pending,columns:ce,sorts:m,filtersApplied:T,articleTitle:S.value,publicationYear:b.value,publisher:C.value,quotesCount:F.value,isScopusCheck:x.value,isWoSCheck:$.value},me={tableOpened:L,pageMounted:a,selectArticle:_,uploadFiles:V,modalOpened:v,setScopusFile:N,setWosFile:Y,setColumns:z,getArticles:le,fetchArticles:O,sortPressed:U,setArticleTitle:S.setValue,setPublicationYear:b.setValue,setPublisher:C.setValue,setQuotesCount:F.setValue,setIsScopusCheck:x.setValue,setIsWoSCheck:$.setValue,filtersApplied:k,filtersReset:A},R=l({name:"getDetailsClicked",sid:"xxk06l"}),B=l({name:"pageMounted",sid:"-5pxjrw"}),q=E({sid:"k0ppeo",fn:()=>Q({handler:K}),name:"getArticleQuery",method:"createQuery"}),W=E({sid:"-vdnnzx",fn:()=>Q({handler:X}),name:"getArticleDetailsQuery",method:"createQuery"});d({and:[{clock:B,target:q.start}],or:{sid:"hiv5ll"}});d({and:[{clock:R,target:W.start}],or:{sid:"hl2bz1"}});const ge={pageMounted:B,getDetailsClicked:R},ve={article:q.$data,details:W.$data,loading:q.$pending,detailsLoading:W.$pending};export{se as T,ve as a,ge as b,me as e,ee as g,he as s};
