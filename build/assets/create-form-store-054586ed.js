import{d as m,e as F}from"./index-07cca455.js";import{p as g,e as f,x as p,h as k,u as a}from"./vendor-ab783af7.js";const D=({defaultStore:i,api:s})=>{const n=i,u=()=>({data:a(c).data,loading:a(o.pending),error:a(c).error,completed:a(c).completed}),d=g(),r=f(async e=>{const t=await s.post(e);if(t.data.result!=="ok")throw new Error(t.data.error_text);return t.data});p({clock:r.doneData,fn:()=>({message:"Данные формы успешно отправлены",type:"success"}),target:m.evokePopUpMessage}),p({clock:r.failData,fn:e=>({message:`${e.message}`,type:"failure"}),target:m.evokePopUpMessage}),p({clock:r.doneData,target:F.getApplicationsFx});const o=f(async e=>{if(s.get)try{return{...(await s.get(e)).data}}catch(t){throw new Error(t)}return n.data}),l=g(),c=k(n).on(o,e=>({...e,error:null})).on(o.doneData,(e,t)=>({...e,data:t})).on(o.failData,(e,t)=>({...e,error:t.message})).on(d,(e,t)=>({...e,completed:t.completed})).on(l,()=>({...n}));return{selectors:{useForm:u},effects:{getFormFx:o,postFormFx:r},events:{changeCompleted:d,clearStore:l}}};export{D as c};
