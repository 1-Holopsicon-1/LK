import{r as i,n as v,cM as x,j as r}from"./vendor-08ab745b.js";import{s as g,bg as F,B as b,F as S,I as j,S as N,j as h,c as y,bh as R}from"./index-0892b83f.js";import{s as T}from"./send-hr-form-work-transfer-17620d40.js";const A=(e,s,t)=>{const{surname:o,name:a,patronymic:l}=e;return{title:"Заявление на изменение ставки",data:[{title:"ФИО",value:o+" "+a+" "+l,fieldName:"fio",type:"simple-text"},{title:"",type:"simple-text",value:s[t].jobGuid.toString(),fieldName:"jobGuid"},{title:"Должность",type:"simple-text",fieldName:"post",value:s[t].jobTitle.toString()},{title:"Подразделение",type:"simple-text",value:s[t].subDivision.toString(),fieldName:"subDivision"},{title:"Текущая ставка",type:"simple-text",value:s[t].rate.toString(),fieldName:"currentRate"},{title:"Желаемая ставка",type:"select",fieldName:"newRate",value:"",editable:!0,required:!0,width:"100%",items:[{id:0,title:"0.25"},{id:1,title:"0.5"},{id:2,title:"1"}]}]}},D=e=>{const s=e.find(t=>t.fieldName==="employment");return s?.value&&(s?.value).title==="По совместительству"?{reason:"PartTime"}:{reason:null}},E=()=>{const[e,s]=i.useState(null),{data:{dataUserApplication:t,dataWorkerApplication:o}}=g.useApplications(),{loading:a}=F.useBufferWorkTransfer(),[l,c]=i.useState(!1),[u,m]=i.useState({}),d=v(R),n=l??!1,{id:f}=x(),p=+f;return i.useEffect(()=>{e&&t&&m(D(e.data))},[e]),i.useEffect(()=>{t&&o&&!a&&s(A(t,o,p))},[t,p,a]),r.jsx(b,{isDone:n,children:!!e&&!!s&&r.jsxs(S,{children:[r.jsx(j,{...e,collapsed:n,setData:s,specialFieldsNameConfig:u}),r.jsx(N,{text:"Отправить",action:()=>T(h.HOLIDAY_WORK,[e],c,d),isLoading:a,completed:l,setCompleted:c,repeatable:!1,buttonSuccessText:"Отправлено",isDone:n,isActive:y(e)&&(e.optionalCheckbox?.value??!0),popUpFailureMessage:"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})})};export{E as default};
