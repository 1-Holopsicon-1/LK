import{r as o,j as e,F as S}from"./vendor-08ab745b.js";import{V as C,I as E,M as k,h as v,l as D,S as M,c as T,a2 as B,W as I,_ as L,F as N,ak as W}from"./index-0892b83f.js";import{s as _}from"./send-form-b99a96a1.js";import{g as b}from"./get-method-obstaing-57eba76b.js";const z=({model:t,getForm:u,successMessage:p,outerForm:m,isAvailableToSend:r=!0,repeatable:i=!0,formId:x,isSpecialField:d})=>{const{data:a,completed:c}=t.selectors.useForm(),[l,F]=o.useState(!1),[s,n]=o.useState(null),[j,h]=o.useState({}),f=(c||!r)??!1;return o.useEffect(()=>{a&&n(m??u(a))},[a]),o.useEffect(()=>{d&&s&&a&&h(b(s.data))},[s]),!s||!n?e.jsx(C,{}):e.jsxs(e.Fragment,{children:[e.jsx(E,{...s,collapsed:f&&!i,setData:n,specialFieldsNameConfig:j}),e.jsx(k,{title:"Информация по заявке",type:"info",icon:e.jsx(S,{}),visible:f&&!!p,children:p}),a?.last_update&&e.jsxs(v,{size:5,children:["Дата последней отправки: ",D(a.last_update)]}),e.jsx(M,{text:r?"Отправить":"Отправлено",action:()=>_(s,t.effects.postFormFx,F,t.events.changeCompleted,x),isLoading:l,completed:c,setCompleted:g=>t.events.changeCompleted({completed:g}),buttonSuccessText:"Отправлено",repeatable:i,isDone:f&&!i,isActive:T(s,j)&&(s.optionalCheckbox?.value??!0),popUpFailureMessage:f?"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})},R=({model:t,getForm:u,successMessage:p,goBack:m,pageAvailability:r,isAvailableToSend:i=!0,repeatable:x=!0,formId:d,isSpecialField:a=!1,title:c})=>{const{data:l,error:F}=t.selectors.useForm(),[s,n]=o.useState(null);return(!!r&&!r?.isAvailable)??!1?e.jsx(B,{text:r?.text??"Вам не доступен этот раздел"}):(o.useEffect(()=>{l&&n(u(l))},[l]),e.jsx(I,{load:()=>t.effects.getFormFx(),error:F,data:s,children:e.jsx(L,{children:!!s&&!!n&&e.jsxs(N,{children:[e.jsx(W,{text:m,visible:!!m}),c&&e.jsx("h2",{children:c}),e.jsx(z,{model:t,successMessage:p,isAvailableToSend:i,repeatable:x,getForm:u,outerForm:s,formId:d,isSpecialField:a})]})})}))};export{R as T};
