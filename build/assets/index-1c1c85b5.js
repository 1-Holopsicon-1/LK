var te=Object.defineProperty,ne=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var A=(e,t,n)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t)=>{for(var n in t||(t={}))ae.call(t,n)&&A(e,n,t[n]);if(N)for(var n of N(t))re.call(t,n)&&A(e,n,t[n]);return e},F=(e,t)=>ne(e,oe(t));import{s as d,j as o,r as w,cV as se,q as ie,R as G}from"./vendor-00bea631.js";import{G as y,E as g,cv as U,cw as ce,cx as E,L as le,cy as de,cz as he,bx as V,bM as q,cA as pe,cB as ge,a2 as Y,cC as ue,bL as xe,cD as me,cE as fe,cF as ve,ar as De,av as B,cG as we,X as K,cH as ye,u as be,cI as Ce,l as ke,cJ as je,cK as Ie,cn as Me,cm as Ee}from"./index-d824e111.js";const W=({isCurrent:e,isCurrentChosenDay:t})=>{if(t&&!e)return"var(--text)";if(e&&t)return"var(--reallyBlue)"},O=({isCurrent:e,isCurrentChosenDay:t})=>e&&t?"#fff":t?"var(--invert-text)":e?"var(--blue)":"var(--text)",Se=d(y).withConfig({componentId:"sc-178gzfm-0"})(["padding-left:var(--time-width);"]),Te=d.div.withConfig({componentId:"sc-178gzfm-1"})(["width:100%;font-weight:500;height:44px;border-radius:4px;font-size:0.86rem;cursor:pointer;&:hover{background:var(--theme-3);}&::before,&::after{content:'';display:",";height:calc(100% - 64px);top:54px;width:1.5px;position:absolute;background:var(--theme-4);}&::after{right:0;}","{font-size:0.8rem;height:",";&::after,&::before{top:90px;height:calc(100% - 100px);}}"],({showColumns:e})=>e?"block":"none",g.isMobile,({showDates:e})=>e?"80px":"50px"),We=d(y).withConfig({componentId:"sc-178gzfm-2"})(["margin:2px 0;","{flex-direction:column;margin:6px 0;}"],g.isMobile),Oe=d.span.withConfig({componentId:"sc-178gzfm-3"})(["margin-left:auto;margin-right:",";background:",";color:",";padding:5px;border-radius:25px;","{margin-right:auto;padding:4px;}"],({showDates:e})=>e?"0":"auto",({showDates:e})=>!e&&W,({showDates:e})=>e?"var(--grey)":O,g.isMobile),Le=d.span.withConfig({componentId:"sc-178gzfm-4"})(["height:26px;min-width:26px;display:flex;justify-content:center;align-items:center;border-radius:100px;margin-right:auto;margin-left:2px;background:",";color:",";font-weight:",";","{margin-left:auto;margin-top:4px;font-size:",";}"],W,O,({isCurrent:e,isCurrentChosenDay:t})=>e&&t&&"600",g.isMobile,({isCurrent:e})=>e&&"0.8rem"),ze=d.div.withConfig({componentId:"sc-9mih1d-0"})(["display:flex;align-items:center;gap:4px;margin:0 auto;width:fit-content;"]),$=d.div.withConfig({componentId:"sc-9mih1d-1"})(["width:6px;height:6px;border-radius:10px;background:",";@media (max-width:768px){width:5px;height:5px;}"],({background:e})=>e),P=({subjects:e})=>e?o.jsx(ze,{children:e.map(t=>o.jsx($,{background:t.color.main},t.startTime))}):null,Re=()=>{const e=new Date;let t=U(e);e.getDay()===0&&(t=ce(e,1));const n=Object.keys(E).reduce((r,i)=>(r[E[i].short]="",r),{});for(let r=0;r<6;r++){const i=t.toLocaleDateString("ru-RU",{day:"2-digit"});t.setDate(t.getDate()+1),n[Object.keys(n)[r]]=i}return n},L=({showDates:e,showColumns:t,currentChosenDay:n,onDayClick:r,events:i})=>{const c=Re();return o.jsx(Se,{jc:"space-between",children:Object.keys(c).map((a,s)=>{const h=c[a],p=s===n;return o.jsxs(Te,{showDates:e,showColumns:t,onClick:r&&(()=>r==null?void 0:r(s)),children:[o.jsxs(We,{children:[o.jsx(Oe,{isCurrent:+h===new Date().getDate(),isCurrentChosenDay:!e&&p,showDates:e,children:a}),e&&o.jsx(Le,{isCurrentChosenDay:p,isCurrent:+h===new Date().getDate(),children:h})]}),i&&e&&o.jsx(P,{subjects:i[Object.keys(i)[s]]}),i&&!e&&i[Object.keys(i)[s]].length>0&&o.jsx(y,{jc:"center",children:o.jsx($,{background:le.grey.main})})]},a)})})},X=({interval:e,showDates:t,events:n,onDayClick:r})=>{const i=e[0]*60,c=de();return{handleOpenModal:he(),onDayClick:r,shift:i,showDates:t,interval:e,events:n,scale:c}},H=e=>e!==void 0?e:new Date().getDay()===0?0:new Date().getDay()-1,Ne=({events:e,currentChosenDay:t,showDates:n=!0,interval:r=[0,23]})=>{const{isSmallDesktop:i}=V(),{scale:c,shift:a,events:s,handleOpenModal:h}=X({interval:r,events:e}),[p,m]=w.useState(null),[x,v]=w.useState(H(t)),l=w.useRef(null);w.useEffect(()=>{var u;if(e){const f=Object.keys(e!=null?e:{})[x],Z=(u=e[f].find(ee=>q(ee,!0)))!=null?u:null;m(Z)}else m(null)},[e]);const D=p?`${p.startTime} - ${pe(p.startTime,p.duration)}`:"9:00",b=w.useCallback(u=>{i?h(u):m(u)},[i]),C=u=>{const f=Math.floor(u.currentTarget.scrollLeft/u.currentTarget.clientWidth);v(f)},k=u=>{l.current&&(l.current.scrollLeft=l.current.clientWidth*u)};return w.useLayoutEffect(()=>{k(H(t))},[l,t]),{currentDay:x,events:s,carouselRef:l,interval:r,scale:c,shift:a,showDates:n,chosenEvent:p,timeInterval:D,currentChosenDay:t,handleDayClick:k,handleCarouselScroll:C,onEventClick:b}},z="calc(100vh - var(--header-height) - 110px)",R="calc(100vh - var(--header-height) - 185px)",J="calc(100vh - var(--header-height) - 170px);",Q=d(y).withConfig({componentId:"sc-13irvko-0"})(["--time-width:55px;","{--time-width:35px;}"],g.isMobile),Ae=d(Q).withConfig({componentId:"sc-b5gqbc-0"})(["height:",";","{height:",";}","{height:",";}"],z,g.isTablet,J,g.isMobile,R),_e=d.div.withConfig({componentId:"sc-b5gqbc-1"})(["min-width:340px;max-width:340px;height:calc(100vh - 220px);z-index:10;background:var(--block-content);border-radius:10px;top:0;overflow:hidden;box-shadow:var(--block-shadow);","{display:none;}"],g.isSmallTesktop),Fe=d.div.withConfig({componentId:"sc-b5gqbc-2"})(["overflow-y:hidden;overflow-x:auto;height:100%;width:100%;gap:32px;display:flex;scroll-snap-type:x mandatory;&{.calendar-wrapper{scroll-snap-align:center;min-width:100%;}}"]),Be=e=>{var l;const{currentDay:t,events:n,carouselRef:r,interval:i,scale:c,shift:a,chosenEvent:s,showDates:h,timeInterval:p,handleDayClick:m,handleCarouselScroll:x,onEventClick:v}=Ne(e);return o.jsxs(Ae,{d:"column",gap:"12px",children:[o.jsx(L,{onDayClick:m,currentChosenDay:t,showDates:h,showColumns:!1,events:n}),o.jsxs(y,{h:"100%",gap:"18px",children:[o.jsx(Fe,{onScroll:x,ref:r,children:Object.keys(n!=null?n:{}).map((D,b)=>{const C=n==null?void 0:n[D];return o.jsx(ge,{events:C,interval:i,scale:c,weekday:b+1,currentDay:t,shift:a,onEventClick:v},D)})}),o.jsx(_e,{children:s?o.jsx(ue,{isNextEvent:xe(n==null?void 0:n.saturday,s,!0),timeInterval:p,color:s.color,name:s.title,place:s.place,link:s.link,groups:s.groups,weekday:s.weekday,teachers:s.people,dateInterval:s.dateInterval,rooms:(l=s.rooms)!=null?l:[],isCurrentEvent:q(s,!0)}):o.jsx(Y,{text:"Ничего не выбрано",image:o.jsx(se,{})})})]})]})},He=d(Q).withConfig({componentId:"sc-13hlrk1-0"})(["height:",";position:relative;","{height:",";}","{height:",";}"],z,g.isTablet,J,g.isMobile,R),Ge=e=>{const{handleOpenModal:t,onDayClick:n,shift:r,scale:i,showDates:c,interval:a,events:s}=X(e);return o.jsxs(He,{d:"column",children:[o.jsx(L,{onDayClick:n,showDates:c,showColumns:!0,events:s}),o.jsxs(me,{children:[o.jsx(fe,{interval:a,scale:i}),Object.keys(E).map((h,p)=>o.jsx(ve,{showTime:!1,weekDay:p+1,shortInfo:!0,events:s==null?void 0:s[h],scale:i,shift:r,currentEvent:null,interval:a,onClick:t},h))]})]})},S=e=>{const t=new Date(e),n=t.getDate()-(t.getDay()-1)+6;return new Date(t.setDate(n))},j=(e,t)=>{const r=(t.getTime()-e.getTime())/(1e3*3600*24);return r-Math.floor(r/6.55)+1},Ue=d.div.withConfig({componentId:"sc-1xp14d0-0"})(["width:100%;display:flex;flex-direction:column;height:",";position:relative;","{height:",";}"],z,g.isMobile,R),Ve=d.div.withConfig({componentId:"sc-1xp14d0-1"})(["display:flex;flex-direction:row;flex-wrap:wrap;border-left:1px solid var(--theme-3);border-top:1px solid var(--theme-3);border-bottom:1px solid var(--theme-3);overflow-y:auto;scroll-snap-type:y mandatory;scroll-padding-top:100px;","{&::-webkit-scrollbar{display:none;}}","{border:none;scroll-padding-top:50px;}"],g.isMiddleTesktop,g.isMobile),qe=d.div.withConfig({componentId:"sc-1xp14d0-2"})(["padding:6px;width:1000px;max-width:calc(100% / 6);height:calc((100vh / 6) - 6px);background:transparent;border-right:1px solid var(--almostTransparentOpposite);border-bottom:1px solid var(--almostTransparentOpposite);display:flex;flex-direction:column;align-items:center;opacity:",";background:",";scroll-snap-align:center;","{padding:12px;gap:4px;height:calc((100vw / 6) - 5.5px);border-right:none;}"],({disabled:e})=>e?"0.4":"1",({disabled:e})=>e?"var(--theme-1t)":"transparent",g.isMobile),Ye=d.div.withConfig({componentId:"sc-1xp14d0-3"})(["width:100%;font-size:0.9rem;font-weight:500;display:flex;align-items:center;","{justify-content:center;}"],g.isMobile),Ke=d.div.withConfig({componentId:"sc-1xp14d0-4"})(["height:26px;width:26px;display:flex;justify-content:center;align-items:center;border-radius:30px;background:",";color:",";"],W,O),$e=d.div.withConfig({componentId:"sc-1xp14d0-5"})(["position:sticky;width:100%;height:50px;font-size:1.2rem;font-weight:500;top:0px;padding:10px;z-index:100;margin:4px 0;background:var(--block);","{background:var(--theme);}"],g.isMobile),T=(e,t)=>e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear(),Pe=d(y).withConfig({componentId:"sc-1mwhn0h-0"})(["padding:4px;border-radius:4px;cursor:pointer;&:hover{filter:brightness(0.92);}"]),Xe=d.div.withConfig({componentId:"sc-1mwhn0h-1"})(["font-weight:500;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:0.8rem;opacity:0.8;color:",";"],({textColor:e})=>e),Je=e=>{const{title:t,color:n,onClick:r,startTime:i}=e,c=ie(De.userSettings),a=(c==null?void 0:c.appearance.theme)===B.Light?n.dark3:n.light3,s=(c==null?void 0:c.appearance.theme)===B.Light?n.transparent3:n.transparent2,h=()=>r==null?void 0:r(e);return o.jsxs(Pe,{textColor:a,background:s,gap:"6px",onClick:h,children:[o.jsx(we,{isCurrentEvent:!1,color:n}),o.jsx(Xe,{textColor:a,children:t}),o.jsx(K,{fontSize:"0.7rem",children:i})]})},I=4,Qe=(e,t)=>{const n=ye(t);return n==="sunday"?[]:e==null?void 0:e[n].filter(r=>r.endDate?t>=r.startDate&&t<=r.endDate:T(r.startDate,t))},Ze=({daysAmount:e,startDate:t,events:n,addOneOnWeekends:r,handleEventClick:i,disabled:c=!1})=>{if(e<0||isNaN(e))return o.jsx(Y,{text:"Неправильная длина календаря"});const a=new Date(t),{isMobile:s}=V(),{open:h}=be(),p=(m,x)=>()=>{h(o.jsx(Ie,{isCurrentDay:!1,dayEvents:m,day:x}),x)};return o.jsx(o.Fragment,{children:Array(e).fill(0).map((m,x)=>{var k,u;var v;if(x!==0)a.getDay()===6&&r?a.setDate(a.getDate()+2):a.setDate(a.getDate()+1);else if(a.getDay()===0)return null;const l=Qe(n,a),D=S(a),b=a.getDay()===1&&D.getMonth()!==a.getMonth(),C=D.getMonth()===a.getMonth()&&x===0&&a.getDay()===1||a.getDay()===1&&a.getDate()===1;return o.jsxs(G.Fragment,{children:[(C||b)&&o.jsx($e,{children:Ce(b?S(a).toLocaleDateString("ru-RU",{month:"long"}):a.toLocaleDateString("ru-RU",{month:"long"}))}),o.jsxs(qe,{disabled:c,onClick:p(l,ke(a)),children:[o.jsxs(Ye,{children:[o.jsxs(Ke,{isCurrentChosenDay:T(a,new Date),isCurrent:T(a,new Date),children:[je(a.getDate())," "]}),!s&&a.getDate()===1&&a.toLocaleDateString("ru-RU",{month:"short"})]}),!s&&o.jsxs(y,{d:"column",ai:"flex-start",gap:"0px",children:[l==null||(v=l.slice(0,I))===null||v===void 0?void 0:v.map(f=>o.jsx(Je,F(_({},f),{onClick:i}),f.title+f.startTime+f.dateInterval)),((k=l==null?void 0:l.length)!=null?k:0)>I&&o.jsxs(K,{children:["И еще ",((u=l==null?void 0:l.length)!=null?u:0)-I]})]}),s&&o.jsx(P,{subjects:l})]})]},a.toLocaleDateString("ru-RU"))})})},M=G.memo(Ze),et=({events:e,startDate:t,endDate:n,onDayClick:r})=>{const i=new Date(t),c=new Date(n),a=U(i),s=c.getDay()!==0?S(c):c,h=j(i,c);return o.jsxs(Ue,{children:[o.jsx(L,{showColumns:!1,events:null,onDayClick:r}),o.jsxs(Ve,{children:[o.jsx(M,{daysAmount:j(a,i)-1,startDate:a,events:e,disabled:!0,addOneOnWeekends:!1}),o.jsx(M,{daysAmount:h,startDate:i,events:e,addOneOnWeekends:!0}),o.jsx(M,{daysAmount:j(c,s)-1,startDate:new Date(c.getFullYear(),c.getMonth(),c.getDate()+1),events:e,disabled:!0,addOneOnWeekends:!1})]})]})},at=({events:e,view:t,showDates:n,startDate:r,endDate:i})=>{const[c,a]=w.useState(void 0),s=p=>{Me.changeView(Ee.day),a(p)},h=[o.jsx(Be,{currentChosenDay:c,events:e,interval:[9,22],showDates:n},"day"),o.jsx(Ge,{events:e,interval:[9,22],showDates:n,onDayClick:s},"week"),o.jsx(et,{events:e,startDate:r,endDate:i,onDayClick:s},"month")];return o.jsx(o.Fragment,{children:h[t]})};export{at as T};
